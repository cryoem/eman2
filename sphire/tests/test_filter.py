from __future__ import print_function
from __future__ import division


import unittest
from numpy import array_equal, linspace, allclose
from sphire.libpy.sp_utilities import model_gauss_noise
from EMAN2_cppwrap import EMData,EMAN2Ctf
from copy import deepcopy

from test_module import IMAGE_2D,IMAGE_BLANK_2D,IMAGE_3D,IMAGE_BLANK_3D,MASK

from mpi import *
mpi_init(0, [])
TOLERANCE = 0.0075

from sphire.libpy import sp_filter as oldfu
from sphire.utils.SPHIRE.libpy import sp_filter as fu

"""
WHAT IS MISSING:
0) in all the cases where the input file is an image. I did not test the case with a complex image. I was not able to generate it
1) filter local --> I'm not able to test it because it lead always to an indexError due to the may_node !=myid


RESULT AND KNOWN ISSUES
Some compatibility tests for the following functions fail!!!
1) 

In these tests there is a bug --> syntax error:
1) fit_tanh: with 'low' too high leads to a bug that leads to a TypeError situation. see "test_tooHighLow_leads_TypeError" 

In these tests there is a strange behavior:
1) filt_vols: same input different output in both of the version. At least the version are always returning the same value ... compatibility test OK, but NOT unittestable
"""




#   THESE FUNCTIONS ARE COMMENTED BECAUSE NOT INVOLVED IN THE PYTHON3 CONVERSION. THEY HAVE TO BE TESTED ANYWAY
""" start: new in sphire 1.3


class Test_filt_median(unittest.TestCase):
    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_median()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_median()
        self.assertEqual(str(cm_new.exception), "filt_median() takes at least 3 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError)as cm_new:
            fu.filt_median(f=EMData(), nx=10, ny=10, nz = 1, kernelshape = "BLOCK")
        with self.assertRaises(RuntimeError)as cm_old:
            oldfu.filt_median(f=EMData(), nx=10, ny=10, nz = 1, kernelshape = "BLOCK")
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_NoneType_Img(self):
        return_new = fu.filt_median(f=None, nx=10, ny=10, nz = 1, kernelshape = "BLOCK")
        return_old = oldfu.filt_median(f=None, nx=10, ny=10, nz = 1, kernelshape = "BLOCK")
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_invalid_shape(self):
        return_new = fu.filt_median(f=IMAGE_2D, nx=10, ny=10, nz = 1, kernelshape = "invalid")
        return_old = oldfu.filt_median(f=IMAGE_2D, nx=10, ny=10, nz = 1, kernelshape = "invalid")
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new, "Unknown kernel shape.")

    def test_Img2D_block(self):
        return_new = fu.filt_median(f=IMAGE_2D, nx=10, ny=10, nz = 1, kernelshape = "BLOCK")
        return_old = oldfu.filt_median(f=IMAGE_2D, nx=10, ny=10, nz = 1, kernelshape = "BLOCK")
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img2D_circular(self):
        return_new = fu.filt_median(f=IMAGE_2D, nx=10, ny=10, nz = 1, kernelshape = "CIRCULAR")
        return_old = oldfu.filt_median(f=IMAGE_2D, nx=10, ny=10, nz = 1, kernelshape = "CIRCULAR")
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img2D_cross(self):
        return_new = fu.filt_median(f=IMAGE_2D, nx=10, ny=10, nz = 1, kernelshape = "CROSS")
        return_old = oldfu.filt_median(f=IMAGE_2D, nx=10, ny=10, nz = 1, kernelshape = "CROSS")
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img2Dblank_block(self):
        return_new = fu.filt_median(f=IMAGE_BLANK_2D, nx=10, ny=10, nz = 1, kernelshape = "BLOCK")
        return_old = oldfu.filt_median(f=IMAGE_BLANK_2D, nx=10, ny=10, nz = 1, kernelshape = "BLOCK")
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img2Dblank_circular(self):
        return_new = fu.filt_median(f=IMAGE_BLANK_2D, nx=10, ny=10, nz = 1, kernelshape = "CIRCULAR")
        return_old = oldfu.filt_median(f=IMAGE_BLANK_2D, nx=10, ny=10, nz = 1, kernelshape = "CIRCULAR")
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img2Dblank_cross(self):
        return_new = fu.filt_median(f=IMAGE_BLANK_2D, nx=10, ny=10, nz = 1, kernelshape = "CROSS")
        return_old = oldfu.filt_median(f=IMAGE_BLANK_2D, nx=10, ny=10, nz = 1, kernelshape = "CROSS")
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img3D_block(self):
        return_new = fu.filt_median(f=IMAGE_3D, nx=10, ny=10, nz = 10, kernelshape = "BLOCK")
        return_old = oldfu.filt_median(f=IMAGE_3D, nx=10, ny=10, nz = 10, kernelshape = "BLOCK")
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img3D_circular(self):
        return_new = fu.filt_median(f=IMAGE_3D, nx=10, ny=10, nz = 10, kernelshape = "CIRCULAR")
        return_old = oldfu.filt_median(f=IMAGE_3D, nx=10, ny=10, nz = 10, kernelshape = "CIRCULAR")
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img3D_cross(self):
        return_new = fu.filt_median(f=IMAGE_3D, nx=10, ny=10, nz = 10, kernelshape = "CROSS")
        return_old = oldfu.filt_median(f=IMAGE_3D, nx=10, ny=10, nz = 10, kernelshape = "CROSS")
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img3Dblank_block(self):
        return_new = fu.filt_median(f=IMAGE_BLANK_3D, nx=10, ny=10, nz = 10, kernelshape = "BLOCK")
        return_old = oldfu.filt_median(f=IMAGE_BLANK_3D, nx=10, ny=10, nz = 10, kernelshape = "BLOCK")
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img3Dblank_circular(self):
        return_new = fu.filt_median(f=IMAGE_BLANK_3D, nx=10, ny=10, nz = 10, kernelshape = "CIRCULAR")
        return_old = oldfu.filt_median(f=IMAGE_BLANK_3D, nx=10, ny=10, nz = 10, kernelshape = "CIRCULAR")
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img3Dblank_cross(self):
        return_new = fu.filt_median(f=IMAGE_BLANK_3D, nx=10, ny=10, nz = 10, kernelshape = "CROSS")
        return_old = oldfu.filt_median(f=IMAGE_BLANK_3D, nx=10, ny=10, nz = 10, kernelshape = "CROSS")
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))



class Test_filt_tophath(unittest.TestCase):
    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_tophath()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_tophath()
        self.assertEqual(str(cm_new.exception), "filt_tophatl() takes at least 2 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError)as cm_new:
            fu.filt_tophath(e=EMData(), freq=0.25, pad=False)
        with self.assertRaises(RuntimeError)as cm_old:
            oldfu.filt_tophath(e=EMData(), freq=0.25, pad=False)
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_NoneType_Img(self):
        return_new = fu.filt_tophath(e=None, freq= 0.25, pad=False)
        return_old = oldfu.filt_tophath(e=None,freq= 0.25, pad=False)
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_Img2D_without_pad(self):
        return_new = fu.filt_tophath(e=IMAGE_2D, freq= 0.25, pad=False)
        return_old = oldfu.filt_tophath(e=IMAGE_2D,freq= 0.25, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img2D_with_pad(self):
        return_new = fu.filt_tophath(e=IMAGE_2D, freq= 0.25, pad=True)
        return_old = oldfu.filt_tophath(e=IMAGE_2D,freq= 0.25, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img2Dblank_without_pad(self):
        return_new = fu.filt_tophath(e=IMAGE_BLANK_2D, freq= 0.25, pad=False)
        return_old = oldfu.filt_tophath(e=IMAGE_BLANK_2D,freq= 0.25, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img2Dblank_with_pad(self):
        return_new = fu.filt_tophath(e=IMAGE_BLANK_2D, freq= 0.25, pad=True)
        return_old = oldfu.filt_tophath(e=IMAGE_BLANK_2D,freq= 0.25, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img3D_without_pad(self):
        return_new = fu.filt_tophath(e=IMAGE_3D, freq= 0.25, pad=False)
        return_old = oldfu.filt_tophath(e=IMAGE_3D,freq= 0.25, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img3D_with_pad(self):
        return_new = fu.filt_tophath(e=IMAGE_3D, freq= 0.25, pad=True)
        return_old = oldfu.filt_tophath(e=IMAGE_3D,freq= 0.25, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img3Dblank_without_pad(self):
        return_new = fu.filt_tophath(e=IMAGE_BLANK_3D, freq= 0.25, pad=False)
        return_old = oldfu.filt_tophath(e=IMAGE_BLANK_3D,freq= 0.25, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img3Dblank_with_pad(self):
        return_new = fu.filt_tophath(e=IMAGE_BLANK_3D, freq= 0.25, pad=True)
        return_old = oldfu.filt_tophath(e=IMAGE_BLANK_3D,freq= 0.25, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))


class Test_filt_tophato(unittest.TestCase):

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError) as cm_new:
            fu.filt_tophato(e=EMData(), freql=0.25, value =0.2, freqh=0.35)
        with self.assertRaises(RuntimeError) as cm_old:
            oldfu.filt_tophato(e=EMData(), freql=0.25, value =0.2, freqh=0.35)
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalueidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_tophato()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_tophato()
        self.assertEqual(str(cm_new.exception), "filt_tophato() takes at least 4 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_NoneType_Img(self):
        return_new = fu.filt_tophato(e=None, freql=0.25, value =0.2, freqh=0.35, pad=True)
        return_old = oldfu.filt_tophato(e=None, freql=0.25, value =0.2, freqh=0.35, pad=True)
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_value_higher_freql(self):
        return_new = fu.filt_tophato(e=IMAGE_2D, freql=0.25, value =0.3, freqh=0.35, pad=True)
        return_old = oldfu.filt_tophato(e=IMAGE_2D, freql=0.25, value =0.3, freqh=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImg_with_pad(self):
        return_new = fu.filt_tophato(e=IMAGE_2D, freql=0.25, value =0.2, freqh=0.35, pad=True)
        return_old = oldfu.filt_tophato(e=IMAGE_2D, freql=0.25, value =0.2, freqh=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImg_without_pad(self):
        return_new = fu.filt_tophato(e=IMAGE_2D, freql=0.25, value =0.2, freqh=0.35, pad=False)
        return_old = oldfu.filt_tophato(e=IMAGE_2D, freql=0.25, value =0.2, freqh=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_with_pad(self):
        return_new = fu.filt_tophato(e=IMAGE_BLANK_2D, freql=0.25, value =0.2, freqh=0.35, pad=True)
        return_old = oldfu.filt_tophato(e=IMAGE_BLANK_2D, freql=0.25, value =0.2, freqh=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_without_pad(self):
        return_new = fu.filt_tophato(e=IMAGE_BLANK_2D, freql=0.25, value =0.2, freqh=0.35, pad=False)
        return_old = oldfu.filt_tophato(e=IMAGE_BLANK_2D, freql=0.25, value =0.2, freqh=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_with_pad(self):
        return_new = fu.filt_tophato(e=IMAGE_3D, freql=0.25, value =0.2, freqh=0.35, pad=True)
        return_old = oldfu.filt_tophato(e=IMAGE_3D, freql=0.25, value =0.2, freqh=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_without_pad(self):
        return_new = fu.filt_tophato(e=IMAGE_3D, freql=0.25, value =0.2, freqh=0.35, pad=False)
        return_old = oldfu.filt_tophato(e=IMAGE_3D, freql=0.25, value =0.2, freqh=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_with_pad(self):
        return_new = fu.filt_tophato(e=IMAGE_BLANK_3D, freql=0.25, value =0.2, freqh=0.35, pad=True)
        return_old = oldfu.filt_tophato(e=IMAGE_BLANK_3D, freql=0.25, value =0.2, freqh=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_without_pad(self):
        return_new = fu.filt_tophato(e=IMAGE_BLANK_3D, freql=0.25, value =0.2, freqh=0.35, pad=False)
        return_old = oldfu.filt_tophato(e=IMAGE_BLANK_3D, freql=0.25, value =0.2, freqh=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))



class Test_filt_gaussb(unittest.TestCase):
    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_gaussb()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_gaussb()
        self.assertEqual(str(cm_new.exception), "filt_gaussb() takes at least 3 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError) as cm_new:
            fu.filt_gaussb(e=EMData(), sigma=0.23, center=0.1)
        with self.assertRaises(RuntimeError) as cm_old:
            oldfu.filt_gaussb(e=EMData(), sigma=0.23, center=0.1)
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_NoneType_Img(self):
        return_new =  fu.filt_gaussb(e=None,sigma= 0.23, center = 0.1, pad=False )
        return_old = oldfu.filt_gaussb(e=None,sigma= 0.23, center = 0.1, pad=False )
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_2DImg_without_pad(self):
        return_new = fu.filt_gaussb(e=IMAGE_2D,sigma= 0.23, center = 0.1, pad=False )
        return_old = oldfu.filt_gaussb(e=IMAGE_2D,sigma= 0.23, center = 0.1, pad=False )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImg_with_pad(self):
        return_new = fu.filt_gaussb(e=IMAGE_2D,sigma= 0.23, center = 0.1, pad=True )
        return_old = oldfu.filt_gaussb(e=IMAGE_2D,sigma= 0.23, center = 0.1, pad=True )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_without_pad(self):
        return_new = fu.filt_gaussb(e=IMAGE_BLANK_2D,sigma= 0.23, center = 0.1, pad=False )
        return_old = oldfu.filt_gaussb(e=IMAGE_BLANK_2D,sigma= 0.23, center = 0.1, pad=False )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_with_pad(self):
        return_new = fu.filt_gaussb(e=IMAGE_BLANK_2D,sigma= 0.23, center = 0.1, pad=True )
        return_old = oldfu.filt_gaussb(e=IMAGE_BLANK_2D,sigma= 0.23, center = 0.1, pad=True )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_without_pad(self):
        return_new = fu.filt_gaussb(e=IMAGE_3D,sigma= 0.23, center = 0.1, pad=False )
        return_old = oldfu.filt_gaussb(e=IMAGE_3D,sigma= 0.23, center = 0.1, pad=False )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_with_pad(self):
        return_new = fu.filt_gaussb(e=IMAGE_3D,sigma= 0.23, center = 0.1, pad=True )
        return_old = oldfu.filt_gaussb(e=IMAGE_3D,sigma= 0.23, center = 0.1, pad=True )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_without_pad(self):
        return_new = fu.filt_gaussb(e=IMAGE_BLANK_3D,sigma= 0.23, center = 0.1, pad=False )
        return_old = oldfu.filt_gaussb(e=IMAGE_BLANK_3D,sigma= 0.23, center = 0.1, pad=False )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_with_pad(self):
        return_new = fu.filt_gaussb(e=IMAGE_BLANK_3D,sigma= 0.23, center = 0.1, pad=True )
        return_old = oldfu.filt_gaussb(e=IMAGE_BLANK_3D,sigma= 0.23, center = 0.1, pad=True )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))



class Test_filt_gausso(unittest.TestCase):
    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_gausso()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_gausso()
        self.assertEqual(str(cm_new.exception), "filt_gausso() takes at least 3 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError) as cm_new:
            fu.filt_gausso(e=EMData(), sigma=0.23, value=0.1)
        with self.assertRaises(RuntimeError) as cm_old:
            oldfu.filt_gausso(e=EMData(), sigma=0.23, value=0.1)
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_NoneType_Img(self):
        return_new =  fu.filt_gausso(e=None,sigma= 0.23, value = 0.1, pad=False )
        return_old = oldfu.filt_gausso(e=None,sigma= 0.23, value = 0.1, pad=False )
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_2DImg_without_pad(self):
        return_new = fu.filt_gausso(e=IMAGE_2D,sigma= 0.23, value = 0.1, pad=False )
        return_old = oldfu.filt_gausso(e=IMAGE_2D,sigma= 0.23, value = 0.1, pad=False )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImg_with_pad(self):
        return_new = fu.filt_gausso(e=IMAGE_2D,sigma= 0.23, value = 0.1, pad=True )
        return_old = oldfu.filt_gausso(e=IMAGE_2D,sigma= 0.23, value = 0.1, pad=True )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_without_pad(self):
        return_new = fu.filt_gausso(e=IMAGE_BLANK_2D,sigma= 0.23, value = 0.1, pad=False )
        return_old = oldfu.filt_gausso(e=IMAGE_BLANK_2D,sigma= 0.23, value = 0.1, pad=False )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_with_pad(self):
        return_new = fu.filt_gausso(e=IMAGE_BLANK_2D,sigma= 0.23, value = 0.1, pad=True )
        return_old = oldfu.filt_gausso(e=IMAGE_BLANK_2D,sigma= 0.23, value = 0.1, pad=True )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_without_pad(self):
        return_new = fu.filt_gausso(e=IMAGE_3D,sigma= 0.23, value = 0.1, pad=False )
        return_old = oldfu.filt_gausso(e=IMAGE_3D,sigma= 0.23, value = 0.1, pad=False )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_with_pad(self):
        return_new = fu.filt_gausso(e=IMAGE_3D,sigma= 0.23, value = 0.1, pad=True )
        return_old = oldfu.filt_gausso(e=IMAGE_3D,sigma= 0.23, value = 0.1, pad=True )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_without_pad(self):
        return_new = fu.filt_gausso(e=IMAGE_BLANK_3D,sigma= 0.23, value = 0.1, pad=False )
        return_old = oldfu.filt_gausso(e=IMAGE_BLANK_3D,sigma= 0.23, value = 0.1, pad=False )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_with_pad(self):
        return_new = fu.filt_gausso(e=IMAGE_BLANK_3D,sigma= 0.23, value = 0.1, pad=True )
        return_old = oldfu.filt_gausso(e=IMAGE_BLANK_3D,sigma= 0.23, value = 0.1, pad=True )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))


class Test_filt_btwh(unittest.TestCase):

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_btwh()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_btwh()
        self.assertEqual(str(cm_new.exception), "filt_btwh() takes at least 3 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError) as cm_new:
            fu.filt_btwh(e=EMData(), freql=0.25, freqh=0.35)
        with self.assertRaises(RuntimeError) as cm_old:
            oldfu.filt_btwh(e=EMData(), freql=0.25, freqh=0.35)
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_NoneType_Img(self):
        return_new =  fu.filt_btwh(e=None,  freql=0.25, freqh=0.35, pad=False )
        return_old = oldfu.filt_btwh(e=None,  freql=0.25, freqh=0.35, pad=False )
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_2DImg_without_pad(self):
        return_new = fu.filt_btwh(e=IMAGE_2D, freql=0.25, freqh=0.35, pad=False)
        return_old = oldfu.filt_btwh(e=IMAGE_2D, freql=0.25, freqh=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImg_with_pad(self):
        return_new = fu.filt_btwh(e=IMAGE_2D, freql=0.25, freqh=0.35, pad=True)
        return_old = oldfu.filt_btwh(e=IMAGE_2D, freql=0.25, freqh=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_without_pad(self):
        return_new = fu.filt_btwh(e=IMAGE_BLANK_2D, freql=0.25, freqh=0.35, pad=False)
        return_old = oldfu.filt_btwh(e=IMAGE_BLANK_2D, freql=0.25, freqh=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_with_pad(self):
        return_new = fu.filt_btwh(e=IMAGE_BLANK_2D, freql=0.25, freqh=0.35, pad=True)
        return_old = oldfu.filt_btwh(e=IMAGE_BLANK_2D, freql=0.25, freqh=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_without_pad(self):
        return_new = fu.filt_btwh(e=IMAGE_3D, freql=0.25, freqh=0.35, pad=False)
        return_old = oldfu.filt_btwh(e=IMAGE_3D, freql=0.25, freqh=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_with_pad(self):
        return_new = fu.filt_btwh(e=IMAGE_3D, freql=0.25, freqh=0.35, pad=True)
        return_old = oldfu.filt_btwh(e=IMAGE_3D, freql=0.25, freqh=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_without_pad(self):
        return_new = fu.filt_btwh(e=IMAGE_BLANK_3D, freql=0.25, freqh=0.35, pad=False)
        return_old = oldfu.filt_btwh(e=IMAGE_BLANK_3D, freql=0.25, freqh=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_with_pad(self):
        return_new = fu.filt_btwh(e=IMAGE_BLANK_3D, freql=0.25, freqh=0.35, pad=True)
        return_old = oldfu.filt_btwh(e=IMAGE_BLANK_3D, freql=0.25, freqh=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))


class Test_filt_btwo(unittest.TestCase):

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_btwo()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_btwo()
        self.assertEqual(str(cm_new.exception), "filt_btwo() takes at least 4 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError) as cm_new:
            fu.filt_btwo(e=EMData(), freql=0.25, freqh=0.35, value= 0.1)
        with self.assertRaises(RuntimeError) as cm_old:
            oldfu.filt_btwo(e=EMData(), freql=0.25, freqh=0.35, value= 0.1)
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_NoneType_Img(self):
        return_new =  fu.filt_btwo(e=None,  freql=0.25, freqh=0.35, value= 0.1, pad=False )
        return_old = oldfu.filt_btwo(e=None,  freql=0.25, freqh=0.35, value= 0.1, pad=False )
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_2DImg_without_pad(self):
        return_new = fu.filt_btwo(e=IMAGE_2D, freql=0.25, freqh=0.35, value= 0.1, pad=False)
        return_old = oldfu.filt_btwo(e=IMAGE_2D, freql=0.25, freqh=0.35, value= 0.1, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImg_with_pad(self):
        return_new = fu.filt_btwo(e=IMAGE_2D, freql=0.25, freqh=0.35, value= 0.1, pad=True)
        return_old = oldfu.filt_btwo(e=IMAGE_2D, freql=0.25, freqh=0.35, value= 0.1, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_without_pad(self):
        return_new = fu.filt_btwo(e=IMAGE_BLANK_2D, freql=0.25, freqh=0.35, value= 0.1, pad=False)
        return_old = oldfu.filt_btwo(e=IMAGE_BLANK_2D, freql=0.25, freqh=0.35, value= 0.1, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_with_pad(self):
        return_new = fu.filt_btwo(e=IMAGE_BLANK_2D, freql=0.25, freqh=0.35, value= 0.1, pad=True)
        return_old = oldfu.filt_btwo(e=IMAGE_BLANK_2D, freql=0.25, freqh=0.35, value= 0.1, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_without_pad(self):
        return_new = fu.filt_btwo(e=IMAGE_3D, freql=0.25, freqh=0.35, value= 0.1, pad=False)
        return_old = oldfu.filt_btwo(e=IMAGE_3D, freql=0.25, freqh=0.35, value= 0.1, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_with_pad(self):
        return_new = fu.filt_btwo(e=IMAGE_3D, freql=0.25, freqh=0.35, value= 0.1, pad=True)
        return_old = oldfu.filt_btwo(e=IMAGE_3D, freql=0.25, freqh=0.35, value= 0.1, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_without_pad(self):
        return_new = fu.filt_btwo(e=IMAGE_BLANK_3D, freql=0.25, freqh=0.35, value= 0.1, pad=False)
        return_old = oldfu.filt_btwo(e=IMAGE_BLANK_3D, freql=0.25, freqh=0.35, value= 0.1, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_with_pad(self):
        return_new = fu.filt_btwo(e=IMAGE_BLANK_3D, freql=0.25, freqh=0.35, value= 0.1, pad=True)
        return_old = oldfu.filt_btwo(e=IMAGE_BLANK_3D, freql=0.25, freqh=0.35, value= 0.1, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))


class Test_filt_tanh(unittest.TestCase):

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_tanh()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_tanh()
        self.assertEqual(str(cm_new.exception), "filt_tanh() takes at least 3 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError) as cm_new:
            fu.filt_tanh(e=EMData(), freq=0.25, fall_off=0.35)
        with self.assertRaises(RuntimeError) as cm_old:
            oldfu.filt_tanh(e=EMData(), freq=0.25, fall_off=0.35)
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_NoneType_Img(self):
        return_new =  fu.filt_tanh(e=None,  freq=0.25, fall_off=0.35, pad=False )
        return_old = oldfu.filt_tanh(e=None,  freq=0.25, fall_off=0.35, pad=False )
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_2DImg_without_pad(self):
        return_new = fu.filt_tanh(e=IMAGE_2D, freq=0.25, fall_off=0.35, pad=False)
        return_old = oldfu.filt_tanh(e=IMAGE_2D, freq=0.25, fall_off=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImg_with_pad(self):
        return_new = fu.filt_tanh(e=IMAGE_2D, freq=0.25, fall_off=0.35, pad=True)
        return_old = oldfu.filt_tanh(e=IMAGE_2D, freq=0.25, fall_off=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_without_pad(self):
        return_new = fu.filt_tanh(e=IMAGE_BLANK_2D, freq=0.25, fall_off=0.35, pad=False)
        return_old = oldfu.filt_tanh(e=IMAGE_BLANK_2D, freq=0.25, fall_off=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_with_pad(self):
        return_new = fu.filt_tanh(e=IMAGE_BLANK_2D, freq=0.25, fall_off=0.35, pad=True)
        return_old = oldfu.filt_tanh(e=IMAGE_BLANK_2D, freq=0.25, fall_off=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_without_pad(self):
        return_new = fu.filt_tanh(e=IMAGE_3D, freq=0.25, fall_off=0.35, pad=False)
        return_old = oldfu.filt_tanh(e=IMAGE_3D, freq=0.25, fall_off=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_with_pad(self):
        return_new = fu.filt_tanh(e=IMAGE_3D, freq=0.25, fall_off=0.35, pad=True)
        return_old = oldfu.filt_tanh(e=IMAGE_3D, freq=0.25, fall_off=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_without_pad(self):
        return_new = fu.filt_tanh(e=IMAGE_BLANK_3D, freq=0.25, fall_off=0.35, pad=False)
        return_old = oldfu.filt_tanh(e=IMAGE_BLANK_3D, freq=0.25, fall_off=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_with_pad(self):
        return_new = fu.filt_tanh(e=IMAGE_BLANK_3D, freq=0.25, fall_off=0.35, pad=True)
        return_old = oldfu.filt_tanh(e=IMAGE_BLANK_3D, freq=0.25, fall_off=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))


class Test_filt_tanb(unittest.TestCase):

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_tanb()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_tanb()
        self.assertEqual(str(cm_new.exception), "filt_tanb() takes at least 5 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError) as cm_new:
            fu.filt_tanb(e=EMData(), freql=0.25, freqh=0.35, low_fall_off = 0.1, high_fall_off=0.3 )
        with self.assertRaises(RuntimeError) as cm_old:
            oldfu.filt_tanb(e=EMData(), freql=0.25, freqh=0.35, low_fall_off = 0.1, high_fall_off=0.3 )
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_NoneType_Img(self):
        return_new =  fu.filt_tanb(e=None,  freql=0.25, freqh=0.35, low_fall_off = 0.1, high_fall_off=0.3 , pad=False )
        return_old = oldfu.filt_tanb(e=None,  freql=0.25, freqh=0.35, low_fall_off = 0.1, high_fall_off=0.3 , pad=False )
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_2DImg_without_pad(self):
        return_new = fu.filt_tanb(e=IMAGE_2D, freql=0.25, freqh=0.35, low_fall_off = 0.1, high_fall_off=0.3 , pad=False)
        return_old = oldfu.filt_tanb(e=IMAGE_2D, freql=0.25, freqh=0.35, low_fall_off = 0.1, high_fall_off=0.3 , pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImg_with_pad(self):
        return_new = fu.filt_tanb(e=IMAGE_2D, freql=0.25, freqh=0.35, low_fall_off = 0.1, high_fall_off=0.3 , pad=True)
        return_old = oldfu.filt_tanb(e=IMAGE_2D, freql=0.25, freqh=0.35, low_fall_off = 0.1, high_fall_off=0.3 , pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_without_pad(self):
        return_new = fu.filt_tanb(e=IMAGE_BLANK_2D, freql=0.25, freqh=0.35, low_fall_off = 0.1, high_fall_off=0.3 , pad=False)
        return_old = oldfu.filt_tanb(e=IMAGE_BLANK_2D, freql=0.25, freqh=0.35, low_fall_off = 0.1, high_fall_off=0.3 , pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_with_pad(self):
        return_new = fu.filt_tanb(e=IMAGE_BLANK_2D, freql=0.25, freqh=0.35, low_fall_off = 0.1, high_fall_off=0.3 , pad=True)
        return_old = oldfu.filt_tanb(e=IMAGE_BLANK_2D, freql=0.25, freqh=0.35, low_fall_off = 0.1, high_fall_off=0.3 , pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_without_pad(self):
        return_new = fu.filt_tanb(e=IMAGE_3D, freql=0.25, freqh=0.35, low_fall_off = 0.1, high_fall_off=0.3 , pad=False)
        return_old = oldfu.filt_tanb(e=IMAGE_3D, freql=0.25, freqh=0.35, low_fall_off = 0.1, high_fall_off=0.3 , pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_with_pad(self):
        return_new = fu.filt_tanb(e=IMAGE_3D, freql=0.25, freqh=0.35, low_fall_off = 0.1, high_fall_off=0.3 , pad=True)
        return_old = oldfu.filt_tanb(e=IMAGE_3D, freql=0.25, freqh=0.35, low_fall_off = 0.1, high_fall_off=0.3 , pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_without_pad(self):
        return_new = fu.filt_tanb(e=IMAGE_BLANK_3D, freql=0.25, freqh=0.35, low_fall_off = 0.1, high_fall_off=0.3 , pad=False)
        return_old = oldfu.filt_tanb(e=IMAGE_BLANK_3D, freql=0.25, freqh=0.35, low_fall_off = 0.1, high_fall_off=0.3 , pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_with_pad(self):
        return_new = fu.filt_tanb(e=IMAGE_BLANK_3D, freql=0.25, freqh=0.35, low_fall_off = 0.1, high_fall_off=0.3 , pad=True)
        return_old = oldfu.filt_tanb(e=IMAGE_BLANK_3D, freql=0.25, freqh=0.35, low_fall_off = 0.1, high_fall_off=0.3 , pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))



class Test_filt_tano(unittest.TestCase):

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_tano()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_tano()
        self.assertEqual(str(cm_new.exception), "filt_tano() takes at least 4 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))


    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError) as cm_new:
            fu.filt_tano(e=EMData(), freq=0.25, fall_off=0.35, value = 0.1)
        with self.assertRaises(RuntimeError) as cm_old:
            oldfu.filt_tano(e=EMData(), freq=0.25, fall_off=0.35, value = 0.1)
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_NoneType_Img(self):
        return_new =  fu.filt_tano(e=None,  freq=0.25, fall_off=0.35, value = 0.1, pad=False )
        return_old = oldfu.filt_tano(e=None,  freq=0.25, fall_off=0.35, value = 0.1, pad=False )
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_2DImg_without_pad(self):
        return_new = fu.filt_tano(e=IMAGE_2D, freq=0.25, fall_off=0.35, value = 0.1, pad=False)
        return_old = oldfu.filt_tano(e=IMAGE_2D, freq=0.25, fall_off=0.35, value = 0.1, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImg_with_pad(self):
        return_new = fu.filt_tano(e=IMAGE_2D, freq=0.25, fall_off=0.35, value = 0.1, pad=True)
        return_old = oldfu.filt_tano(e=IMAGE_2D, freq=0.25, fall_off=0.35, value = 0.1, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_without_pad(self):
        return_new = fu.filt_tano(e=IMAGE_BLANK_2D, freq=0.25, fall_off=0.35, value = 0.1, pad=False)
        return_old = oldfu.filt_tano(e=IMAGE_BLANK_2D, freq=0.25, fall_off=0.35, value = 0.1, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_with_pad(self):
        return_new = fu.filt_tano(e=IMAGE_BLANK_2D, freq=0.25, fall_off=0.35, value = 0.1, pad=True)
        return_old = oldfu.filt_tano(e=IMAGE_BLANK_2D, freq=0.25, fall_off=0.35, value = 0.1, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_without_pad(self):
        return_new = fu.filt_tano(e=IMAGE_3D, freq=0.25, fall_off=0.35, value = 0.1, pad=False)
        return_old = oldfu.filt_tano(e=IMAGE_3D, freq=0.25, fall_off=0.35, value = 0.1, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_with_pad(self):
        return_new = fu.filt_tano(e=IMAGE_3D, freq=0.25, fall_off=0.35, value = 0.1, pad=True)
        return_old = oldfu.filt_tano(e=IMAGE_3D, freq=0.25, fall_off=0.35, value = 0.1, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_without_pad(self):
        return_new = fu.filt_tano(e=IMAGE_BLANK_3D, freq=0.25, fall_off=0.35, value = 0.1, pad=False)
        return_old = oldfu.filt_tano(e=IMAGE_BLANK_3D, freq=0.25, fall_off=0.35, value = 0.1, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_with_pad(self):
        return_new = fu.filt_tano(e=IMAGE_BLANK_3D, freq=0.25, fall_off=0.35, value = 0.1, pad=True)
        return_old = oldfu.filt_tano(e=IMAGE_BLANK_3D, freq=0.25, fall_off=0.35, value = 0.1, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))


class Test_filt_kaisersinh(unittest.TestCase):

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError) as cm_new:
            fu.filt_kaisersinh(e=EMData(), alpha=0.1)
        with self.assertRaises(RuntimeError) as cm_old:
            oldfu.filt_kaisersinh(e=EMData(), alpha=0.1)
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalueidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_kaisersinh()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_kaisersinh()
        self.assertEqual(str(cm_new.exception), "filt_kaisersinh() takes at least 4 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_NoneType_Img(self):
        return_new = fu.filt_kaisersinh(e=None, alpha=0.1)
        return_old = oldfu.filt_kaisersinh(e=None, alpha=0.1)
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_value_higher_freql(self):
        return_new = fu.filt_kaisersinh(e=IMAGE_2D,  alpha=0.1)
        return_old = oldfu.filt_kaisersinh(e=IMAGE_2D , alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImg_with_pad(self):
        return_new = fu.filt_kaisersinh(e=IMAGE_2D, alpha=0.1)
        return_old = oldfu.filt_kaisersinh(e=IMAGE_2D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImg_without_pad(self):
        return_new = fu.filt_kaisersinh(e=IMAGE_2D, alpha=0.1)
        return_old = oldfu.filt_kaisersinh(e=IMAGE_2D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_with_pad(self):
        return_new = fu.filt_kaisersinh(e=IMAGE_BLANK_2D, alpha=0.1)
        return_old = oldfu.filt_kaisersinh(e=IMAGE_BLANK_2D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_without_pad(self):
        return_new = fu.filt_kaisersinh(e=IMAGE_BLANK_2D, alpha=0.1)
        return_old = oldfu.filt_kaisersinh(e=IMAGE_BLANK_2D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_with_pad(self):
        return_new = fu.filt_kaisersinh(e=IMAGE_3D, alpha=0.1)
        return_old = oldfu.filt_kaisersinh(e=IMAGE_3D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_without_pad(self):
        return_new = fu.filt_kaisersinh(e=IMAGE_3D, alpha=0.1)
        return_old = oldfu.filt_kaisersinh(e=IMAGE_3D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_with_pad(self):
        return_new = fu.filt_kaisersinh(e=IMAGE_BLANK_3D, alpha=0.1)
        return_old = oldfu.filt_kaisersinh(e=IMAGE_BLANK_3D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_without_pad(self):
        return_new = fu.filt_kaisersinh(e=IMAGE_BLANK_3D, alpha=0.1)
        return_old = oldfu.filt_kaisersinh(e=IMAGE_BLANK_3D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))


class Test_filt_kaisersinhp(unittest.TestCase):

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError) as cm_new:
            fu.filt_kaisersinhp(e=EMData(), alpha=0.1)
        with self.assertRaises(RuntimeError) as cm_old:
            oldfu.filt_kaisersinhp(e=EMData(), alpha=0.1)
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalueidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_kaisersinhp()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_kaisersinhp()
        self.assertEqual(str(cm_new.exception), "filt_kaisersinhp() takes at least 4 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_NoneType_Img(self):
        return_new = fu.filt_kaisersinhp(e=None, alpha=0.1)
        return_old = oldfu.filt_kaisersinhp(e=None, alpha=0.1)
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_value_higher_freql(self):
        return_new = fu.filt_kaisersinhp(e=IMAGE_2D,  alpha=0.1)
        return_old = oldfu.filt_kaisersinhp(e=IMAGE_2D , alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImg_with_pad(self):
        return_new = fu.filt_kaisersinhp(e=IMAGE_2D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhp(e=IMAGE_2D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImg_without_pad(self):
        return_new = fu.filt_kaisersinhp(e=IMAGE_2D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhp(e=IMAGE_2D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_with_pad(self):
        return_new = fu.filt_kaisersinhp(e=IMAGE_BLANK_2D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhp(e=IMAGE_BLANK_2D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_without_pad(self):
        return_new = fu.filt_kaisersinhp(e=IMAGE_BLANK_2D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhp(e=IMAGE_BLANK_2D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_with_pad(self):
        return_new = fu.filt_kaisersinhp(e=IMAGE_3D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhp(e=IMAGE_3D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_without_pad(self):
        return_new = fu.filt_kaisersinhp(e=IMAGE_3D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhp(e=IMAGE_3D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_with_pad(self):
        return_new = fu.filt_kaisersinhp(e=IMAGE_BLANK_3D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhp(e=IMAGE_BLANK_3D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_without_pad(self):
        return_new = fu.filt_kaisersinhp(e=IMAGE_BLANK_3D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhp(e=IMAGE_BLANK_3D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

class Test_filt_kaisersinhinv(unittest.TestCase):

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError) as cm_new:
            fu.filt_kaisersinhinv(e=EMData(), alpha=0.1)
        with self.assertRaises(RuntimeError) as cm_old:
            oldfu.filt_kaisersinhinv(e=EMData(), alpha=0.1)
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalueidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_kaisersinhinv()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_kaisersinhinv()
        self.assertEqual(str(cm_new.exception), "filt_kaisersinhinv() takes at least 4 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_NoneType_Img(self):
        return_new = fu.filt_kaisersinhinv(e=None, alpha=0.1)
        return_old = oldfu.filt_kaisersinhinv(e=None, alpha=0.1)
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_value_higher_freql(self):
        return_new = fu.filt_kaisersinhinv(e=IMAGE_2D,  alpha=0.1)
        return_old = oldfu.filt_kaisersinhinv(e=IMAGE_2D , alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImg_with_pad(self):
        return_new = fu.filt_kaisersinhinv(e=IMAGE_2D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhinv(e=IMAGE_2D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImg_without_pad(self):
        return_new = fu.filt_kaisersinhinv(e=IMAGE_2D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhinv(e=IMAGE_2D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_with_pad(self):
        return_new = fu.filt_kaisersinhinv(e=IMAGE_BLANK_2D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhinv(e=IMAGE_BLANK_2D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_without_pad(self):
        return_new = fu.filt_kaisersinhinv(e=IMAGE_BLANK_2D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhinv(e=IMAGE_BLANK_2D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_with_pad(self):
        return_new = fu.filt_kaisersinhinv(e=IMAGE_3D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhinv(e=IMAGE_3D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_without_pad(self):
        return_new = fu.filt_kaisersinhinv(e=IMAGE_3D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhinv(e=IMAGE_3D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_with_pad(self):
        return_new = fu.filt_kaisersinhinv(e=IMAGE_BLANK_3D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhinv(e=IMAGE_BLANK_3D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_without_pad(self):
        return_new = fu.filt_kaisersinhinv(e=IMAGE_BLANK_3D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhinv(e=IMAGE_BLANK_3D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

class Test_filt_kaisersinhinvp(unittest.TestCase):

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError) as cm_new:
            fu.filt_kaisersinhinvp(e=EMData(), alpha=0.1)
        with self.assertRaises(RuntimeError) as cm_old:
            oldfu.filt_kaisersinhinvp(e=EMData(), alpha=0.1)
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalueidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_kaisersinhinvp()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_kaisersinhinvp()
        self.assertEqual(str(cm_new.exception), "filt_kaisersinhinvp() takes at least 4 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_NoneType_Img(self):
        return_new = fu.filt_kaisersinhinvp(e=None, alpha=0.1)
        return_old = oldfu.filt_kaisersinhinvp(e=None, alpha=0.1)
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_value_higher_freql(self):
        return_new = fu.filt_kaisersinhinvp(e=IMAGE_2D,  alpha=0.1)
        return_old = oldfu.filt_kaisersinhinvp(e=IMAGE_2D , alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImg_with_pad(self):
        return_new = fu.filt_kaisersinhinvp(e=IMAGE_2D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhinvp(e=IMAGE_2D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImg_without_pad(self):
        return_new = fu.filt_kaisersinhinvp(e=IMAGE_2D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhinvp(e=IMAGE_2D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_with_pad(self):
        return_new = fu.filt_kaisersinhinvp(e=IMAGE_BLANK_2D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhinvp(e=IMAGE_BLANK_2D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_2DImgBlank_without_pad(self):
        return_new = fu.filt_kaisersinhinvp(e=IMAGE_BLANK_2D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhinvp(e=IMAGE_BLANK_2D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_with_pad(self):
        return_new = fu.filt_kaisersinhinvp(e=IMAGE_3D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhinvp(e=IMAGE_3D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImg_without_pad(self):
        return_new = fu.filt_kaisersinhinvp(e=IMAGE_3D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhinvp(e=IMAGE_3D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_with_pad(self):
        return_new = fu.filt_kaisersinhinvp(e=IMAGE_BLANK_3D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhinvp(e=IMAGE_BLANK_3D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_3DImgBlank_without_pad(self):
        return_new = fu.filt_kaisersinhinvp(e=IMAGE_BLANK_3D, alpha=0.1)
        return_old = oldfu.filt_kaisersinhinvp(e=IMAGE_BLANK_3D, alpha=0.1)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

class Test_filt_unctf(unittest.TestCase):
    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_unctf()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_unctf()
        self.assertEqual(str(cm_new.exception), "filt_unctf() takes at least 5 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError) as cm_new:
            fu.filt_unctf(e=EMData(), dz=1, cs=2, voltage=300, pixel=1.5, wgh=0.1, b_factor=0.0, sign=-1.0, dza=0.0, azz=0.0)
        with self.assertRaises(RuntimeError) as cm_old:
            oldfu.filt_unctf(e=EMData(), dz=1, cs=2, voltage=300, pixel=1.5, wgh=0.1, b_factor=0.0, sign=-1.0, dza=0.0, azz=0.0)
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_NoneType_Img(self):
        return_new =  fu.filt_unctf(e=None, dz=1, cs=2, voltage=300, pixel=1.5, wgh=0.1, b_factor=0.0, sign=-1.0, dza=0.0, azz=0.0)
        return_old = oldfu.filt_unctf(e=None, dz=1, cs=2, voltage=300, pixel=1.5, wgh=0.1, b_factor=0.0, sign=-1.0, dza=0.0, azz=0.0)
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_2DImg(self):
        return_new =  fu.filt_unctf(e=IMAGE_2D, dz=1, cs=2, voltage=300, pixel=1.5, wgh=0.1, b_factor=0.0, sign=-1.0, dza=0.0, azz=0.0)
        return_old = oldfu.filt_unctf(e=IMAGE_2D, dz=1, cs=2, voltage=300, pixel=1.5, wgh=0.1, b_factor=0.0, sign=-1.0, dza=0.0, azz=0.0)
        self.assertEqual(return_new,return_old)

    def test_2DblankImg(self):
        return_new =  fu.filt_unctf(e=IMAGE_BLANK_2D, dz=1, cs=2, voltage=300, pixel=1.5, wgh=0.1, b_factor=0.0, sign=-1.0, dza=0.0, azz=0.0)
        return_old = oldfu.filt_unctf(e=IMAGE_BLANK_2D, dz=1, cs=2, voltage=300, pixel=1.5, wgh=0.1, b_factor=0.0, sign=-1.0, dza=0.0, azz=0.0)
        self.assertEqual(return_new,return_old)

    def test_3DImg(self):
        return_new =  fu.filt_unctf(e=IMAGE_3D, dz=1, cs=2, voltage=300, pixel=1.5, wgh=0.1, b_factor=0.0, sign=-1.0, dza=0.0, azz=0.0)
        return_old = oldfu.filt_unctf(e=IMAGE_3D, dz=1, cs=2, voltage=300, pixel=1.5, wgh=0.1, b_factor=0.0, sign=-1.0, dza=0.0, azz=0.0)
        self.assertEqual(return_new,return_old)

    def test_3DblankImg(self):
        return_new =  fu.filt_unctf(e=IMAGE_BLANK_3D, dz=1, cs=2, voltage=300, pixel=1.5, wgh=0.1, b_factor=0.0, sign=-1.0, dza=0.0, azz=0.0)
        return_old = oldfu.filt_unctf(e=IMAGE_BLANK_3D, dz=1, cs=2, voltage=300, pixel=1.5, wgh=0.1, b_factor=0.0, sign=-1.0, dza=0.0, azz=0.0)
        self.assertEqual(return_new,return_old)


class Test_filt_params(unittest.TestCase):
    dres = ((0.0, 0.05, 0, 10, 0.15, 0.20), (0, 0.2, 0.4, 0.6, 0.8, 1.0), (8, 9, 5, 77, 98, 200))

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_params()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_params()
        self.assertEqual(str(cm_new.exception), "filt_params() takes at least 1 argument (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_emptyList_returns_IndexError_list_index_out_of_range(self):
        with self.assertRaises(IndexError) as cm_new:
            fu.filt_params(dres=[], high = 0.95, low = 0.1)
        with self.assertRaises(IndexError) as cm_old:
            oldfu.filt_params(dres=[], high = 0.95, low = 0.1)
        self.assertEqual(str(cm_new.exception), "list index out of range")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_filt_params(self):
        return_old = oldfu.filt_params(dres=self.dres, high = 0.95, low = 0.1)
        return_new = oldfu.filt_params(dres=self.dres, high=0.95, low=0.1)

        self.assertEqual(return_new[0] , return_old[0])
        self.assertEqual(return_new[1], return_old[1])
        self.assertEqual(return_new[0] , 0)
        self.assertEqual(return_new[1], 0.1)


class Test_filt_from_fsc(unittest.TestCase):
    dres = ((0.0, 0.05, 0, 10, 0.15, 0.20), (0, 0.2, 0.4, 0.6, 0.8, 1.0), (8, 9, 5, 77, 98, 200))

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_from_fsc()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_from_fsc()
        self.assertEqual(str(cm_new.exception), "filt_from_fsc() takes at least 1 argument (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_emptyList_returns_IndexError_list_index_out_of_range(self):
        with self.assertRaises(IndexError) as cm_new:
            fu.filt_from_fsc(dres=[], low=0.1)
        with self.assertRaises(IndexError) as cm_old:
            oldfu.filt_from_fsc(dres=[], low=0.1)
        self.assertEqual(str(cm_new.exception), "list index out of range")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_filt_params(self):
        return_old = oldfu.filt_from_fsc(dres=self.dres,  low=0.1)
        return_new = oldfu.filt_from_fsc(dres=self.dres, low=0.1)
        self.assertEqual(return_new, return_old)
        self.assertEqual(return_new, 0)


class Test_filt_from_fsc2(unittest.TestCase):
    dres = ((0.0, 0.05, 0, 10, 0.15, 0.20), (0, 0.2, 0.4, 0.6, 0.8, 1.0), (8, 9, 5, 77, 98, 200))

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_from_fsc2()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_from_fsc2()
        self.assertEqual(str(cm_new.exception), "filt_from_fsc2() takes at least 1 argument (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_emptyList_returns_IndexError_list_index_out_of_range(self):
        with self.assertRaises(IndexError) as cm_new:
            fu.filt_from_fsc2(dres=[], low=0.1)
        with self.assertRaises(IndexError) as cm_old:
            oldfu.filt_from_fsc2(dres=[], low=0.1)
        self.assertEqual(str(cm_new.exception), "list index out of range")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_filt_params(self):
        return_old = oldfu.filt_from_fsc2(dres=self.dres,  low=0.1)
        return_new = oldfu.filt_from_fsc2(dres=self.dres, low=0.1)
        self.assertEqual(return_new, return_old)
        self.assertEqual(return_new, 0)


class Test_filt_from_fsc_bwt(unittest.TestCase):
    dres = ((0.0, 0.05, 0, 10, 0.15, 0.20), (0, 0.2, 0.4, 0.6, 0.8, 1.0), (8, 9, 5, 77, 98, 200))

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_from_fsc_bwt()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_from_fsc_bwt()
        self.assertEqual(str(cm_new.exception), "filt_from_fsc_bwt() takes at least 1 argument (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_emptyList_returns_IndexError_list_index_out_of_range(self):
        with self.assertRaises(IndexError) as cm_new:
            fu.filt_from_fsc_bwt(dres=[], low=0.1)
        with self.assertRaises(IndexError) as cm_old:
            oldfu.filt_from_fsc_bwt(dres=[], low=0.1)
        self.assertEqual(str(cm_new.exception), "list index out of range")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_filt_params(self):
        return_old = oldfu.filt_from_fsc_bwt(dres=self.dres,  low=0.1)
        return_new = oldfu.filt_from_fsc_bwt(dres=self.dres, low=0.1)
        self.assertEqual(return_new, return_old)
        self.assertEqual(return_new, 0)


class Test_tanhfilter(unittest.TestCase):
    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.tanhfilter()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.tanhfilter()
        self.assertEqual(str(cm_new.exception), "filt_from_fsc_bwt() takes exactly 3 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_tanhfilter(self):
        return_old = oldfu.tanhfilter(nx=100, fl=3, aa=4)
        return_new = fu.tanhfilter(nx=100, fl=3, aa=4)
        self.assertTrue(array_equal(return_new, return_old))
        self.assertTrue(array_equal(return_new, []))


class Test_filt_matched(unittest.TestCase):

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError) as cm_new:
            fu.filt_matched(ima=EMData(), SNR=[0.1,0.2], Pref=[0.1,0.2])
        with self.assertRaises(RuntimeError) as cm_old:
            oldfu.filt_matched(ima=EMData(), SNR=[0.1,0.2], Pref=[0.1,0.2])
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalueidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_matched()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_matched()
        self.assertEqual(str(cm_new.exception), "filt_matched() takes at exactly 3 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_emptyListSNR_returns_IndexError_list_index_out_of_range(self):
        with self.assertRaises(IndexError) as cm_new:
            fu.filt_matched(ima=None,SNR=[], Pref=[0.1,0.2])
        with self.assertRaises(IndexError) as cm_old:
            oldfu.filt_matched(ima=None,SNR=[], Pref=[0.1,0.2])
        self.assertEqual(str(cm_new.exception), "list index out of range")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_emptyListPREF_returns_IndexError_list_index_out_of_range(self):
        with self.assertRaises(IndexError) as cm_new:
            fu.filt_matched(ima=None,Pref=[], SNR=[0.1,0.2])
        with self.assertRaises(IndexError) as cm_old:
            oldfu.filt_matched(ima=None, Pref=[], SNR=[0.1,0.2])
        self.assertEqual(str(cm_new.exception), "list index out of range")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_NoneType_Img(self):
        return_new = fu.filt_matched(ima=None,SNR=[0.1,0.02], Pref=[0.1,0.2])
        return_old = oldfu.filt_matched(ima=None,SNR=[0.1,0.02], Pref=[0.1,0.2])
        self.assertTrue(array_equal(return_new, return_old))

    def test_2DiImg_Img(self):
        return_new = fu.filt_matched(ima=IMAGE_2D, SNR=[0.1, 0.02], Pref=[0.1, 0.2])
        return_old = oldfu.filt_matched(ima=IMAGE_2D, SNR=[0.1, 0.02], Pref=[0.1, 0.2])
        self.assertTrue(array_equal(return_new, return_old))

    def test_2DblankImg_Img(self):
        return_new = fu.filt_matched(ima=IMAGE_BLANK_2D, SNR=[0.1, 0.02], Pref=[0.1, 0.2])
        return_old = oldfu.filt_matched(ima=IMAGE_BLANK_2D, SNR=[0.1, 0.02], Pref=[0.1, 0.2])
        self.assertTrue(array_equal(return_new, return_old))

    def test_3DiImg_Img(self):
        return_new = fu.filt_matched(ima=IMAGE_3D, SNR=[0.1, 0.02], Pref=[0.1, 0.2])
        return_old = oldfu.filt_matched(ima=IMAGE_3D, SNR=[0.1, 0.02], Pref=[0.1, 0.2])
        self.assertTrue(array_equal(return_new, return_old))

    def test_3DblankImg_Img(self):
        return_new = fu.filt_matched(ima=IMAGE_BLANK_3D, SNR=[0.1, 0.02], Pref=[0.1, 0.2])
        return_old = oldfu.filt_matched(ima=IMAGE_BLANK_3D, SNR=[0.1, 0.02], Pref=[0.1, 0.2])
        self.assertTrue(array_equal(return_new, return_old))



 end: new in sphire 1.3"""




class Test_filt_ctf(unittest.TestCase):
    def test_wrong_number_params(self):
        with self.assertRaises(TypeError)  as cm_new:
            fu.filt_ctf()
        with self.assertRaises(TypeError)  as cm_old:
            oldfu.filt_ctf()
        self.assertEqual(str(cm_new.exception), "filt_ctf() takes at least 2 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_empty_input_image(self):
        ctf = EMAN2Ctf()
        ctf.from_dict({"defocus": 1, "cs": 2, "voltage": 300, "apix": 1.5, "bfactor": 0,"ampcont": 0.1})
        with self.assertRaises(AssertionError) as cm_new:
            fu.filt_ctf(EMData(),ctf, dopad=True, sign=1, binary=0)
        with self.assertRaises(AssertionError) as cm_old:
            oldfu.filt_ctf(EMData(),ctf, dopad=True, sign=1, binary=0)
        self.assertEqual(str(cm_new.exception), "")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_None_value_raiseError(self):
        # Since there is no try-except paradigma but only an assert I suppose that the most common error is given a None vuole instead an image
        with self.assertRaises(AttributeError)  as cm_new:
            fu.filt_ctf(None, None)
        with self.assertRaises(AttributeError)  as cm_old:
            oldfu.filt_ctf(None,None)
        self.assertEqual(str(cm_new.exception), "'NoneType' object has no attribute 'get_ysize'")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_Img2D_with_pad(self):
        ctf = EMAN2Ctf()
        ctf.from_dict({"defocus": 1, "cs": 2, "voltage": 300, "apix": 1.5, "bfactor": 0,"ampcont": 0.1})

        return_new = fu.filt_ctf(IMAGE_2D,ctf, dopad=True, sign=1, binary=0)
        return_old = oldfu.filt_ctf(IMAGE_2D,ctf, dopad=True, sign=1, binary=0)
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview().flatten(), [0.02537887543439865, 0.06666003167629242, 0.08860640972852707, 0.11423356086015701, 0.07664704322814941, 0.06476721912622452, 0.1016666367650032, 0.06420090794563293, 0.0590510368347168, 0.028546642512083054, 0.04544343054294586, 0.0936458483338356, 0.10660999268293381, 0.11318660527467728, 0.08404906839132309, 0.07853294163942337, 0.09875863790512085, 0.08115504682064056, 0.08610578626394272, 0.05425051599740982, 0.08081988990306854, 0.14179831743240356, 0.14374420046806335, 0.14206375181674957, 0.10578593611717224, 0.09300889819860458, 0.13239145278930664, 0.1334831565618515, 0.14952105283737183, 0.08936546742916107, 0.04892152175307274, 0.11512740701436996, 0.10680932551622391, 0.11771304160356522, 0.08947059512138367, 0.09299911558628082, 0.11043757945299149, 0.09911949187517166, 0.10510618984699249, 0.05020471289753914, 0.0678863599896431, 0.10043445974588394, 0.11514001339673996, 0.12562629580497742, 0.0797438696026802, 0.07046858221292496, 0.12335214018821716, 0.11483773589134216, 0.09702116996049881, 0.0586618036031723, 0.0024833858478814363, 0.00576772540807724, 0.0035931956954300404, 0.015070547349750996, 0.01968201994895935, 0.019070535898208618, 0.00534491240978241, -0.008382508531212807, -0.007178300525993109, -0.01083490252494812, -0.03444623947143555, -0.07592754065990448, -0.05943649634718895, -0.05123142898082733, -0.05207352340221405, -0.0565008707344532, -0.0569118969142437, -0.0498686209321022, -0.07462124526500702, -0.03382585570216179, -0.05433550104498863, -0.10064003616571426, -0.07941673696041107, -0.06061949580907822, -0.04912314936518669, -0.05023084580898285, -0.07099725306034088, -0.08687959611415863, -0.11505277454853058, -0.06734293699264526, -0.04637322947382927, -0.07584121823310852, -0.06798234581947327, -0.06083924323320389, -0.05446913093328476, -0.061701495200395584, -0.056151244789361954, -0.07259824872016907, -0.07701337337493896, -0.042031820863485336, -0.02166176028549671, -0.05347851663827896, -0.03989539295434952, -0.03379300981760025, -0.026107463985681534, -0.03577439859509468, -0.05785196274518967, -0.04811835289001465, -0.05682983249425888, -0.02800676040351391] ))

    def test_Img2D_without_pad(self):
        ctf = EMAN2Ctf()
        ctf.from_dict({"defocus": 1, "cs": 2, "voltage": 300, "apix": 1.5, "bfactor": 0,"ampcont": 0.1})

        return_new = fu.filt_ctf(IMAGE_2D,ctf, dopad=False, sign=1, binary=0)
        return_old = oldfu.filt_ctf(IMAGE_2D,ctf, dopad=False, sign=1, binary=0)
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview().flatten(), [-0.12716904282569885, -0.1060660257935524, -0.0715758204460144, -0.09006078541278839, -0.08701757341623306, -0.1405741423368454, -0.12187733501195908, -0.1395653337240219, -0.09859609603881836, -0.08270244300365448, -0.004032715689390898, 0.006739928387105465, 0.04371995851397514, 0.018022021278738976, 0.0029091322794556618, -0.02492731437087059, -0.04374724254012108, -0.050590381026268005, -0.0018045461038127542, 0.029906410723924637, 0.12091688066720963, 0.12383298575878143, 0.1656607985496521, 0.1396709382534027, 0.15559107065200806, 0.13362345099449158, 0.13103146851062775, 0.1280493289232254, 0.15812653303146362, 0.17255763709545135, 0.08715564757585526, 0.10141775012016296, 0.12056536227464676, 0.13103003799915314, 0.13054919242858887, 0.11630141735076904, 0.107169970870018, 0.08551905304193497, 0.09256388247013092, 0.10720916837453842, 0.1346627175807953, 0.1251613050699234, 0.12732911109924316, 0.12993097305297852, 0.12558528780937195, 0.1263207197189331, 0.12421006709337234, 0.1436873823404312, 0.12847203016281128, 0.14751476049423218, -0.0551341250538826, -0.06431866437196732, -0.08771167695522308, -0.07173190265893936, -0.06665833294391632, -0.060690294951200485, -0.0554988756775856, -0.05765663459897041, -0.05190102756023407, -0.04738488048315048, -0.08888810873031616, -0.10486940294504166, -0.1289883553981781, -0.11148587614297867, -0.11635029315948486, -0.09034660458564758, -0.07702426612377167, -0.05100177600979805, -0.07514144480228424, -0.08072526007890701, -0.13229824602603912, -0.1442790925502777, -0.1397782266139984, -0.12434665113687515, -0.1272905319929123, -0.13952545821666718, -0.12591437995433807, -0.1254972666501999, -0.14513663947582245, -0.14107543230056763, -0.07140828669071198, -0.054776474833488464, -0.039388492703437805, -0.019435757771134377, -0.030157914385199547, -0.05080287903547287, -0.03880961239337921, -0.06449072062969208, -0.05959511920809746, -0.05774055793881416, 0.03809576481580734, 0.04188236594200134, 0.07714271545410156, 0.0746355652809143, 0.08655818551778793, 0.0607604905962944, 0.05746179074048996, 0.05183238908648491, 0.06600607931613922, 0.07522052526473999]))

    def test_Img3D_with_pad(self):
        ctf = EMAN2Ctf()
        ctf.from_dict({"defocus": 1, "cs": 2, "voltage": 300, "apix": 1.5, "bfactor": 0,"ampcont": 0.1})

        return_new = fu.filt_ctf(IMAGE_3D,ctf, dopad=True, sign=1, binary=0)
        return_old = oldfu.filt_ctf(IMAGE_3D,ctf, dopad=True, sign=1, binary=0)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview().flatten(),  [0.023586591705679893, -0.013203478418290615, 0.020849712193012238, 0.02944289520382881, -0.009907825849950314, -0.012981997802853584, 0.004331652075052261, -0.0071220495738089085, -0.02846667170524597, 0.01906382106244564, 0.03776717185974121, 0.014797932468354702, 0.058468230068683624, 0.06948373466730118, 0.022548381239175797, 0.02776752971112728, 0.06290294975042343, 0.04744148626923561, 0.016569433733820915, 0.05617404356598854, 0.10315033793449402, 0.09905882924795151, 0.17479975521564484, 0.19980782270431519, 0.12631361186504364, 0.13011160492897034, 0.1878654658794403, 0.16250114142894745, 0.10122313350439072, 0.11384059488773346, 0.10318674147129059, 0.10050909966230392, 0.16559553146362305, 0.18407198786735535, 0.10343051701784134, 0.10332056134939194, 0.174307718873024, 0.15352851152420044, 0.09483695030212402, 0.10784926265478134, 0.04000543802976608, 0.027542175725102425, 0.039046015590429306, 0.05679933726787567, 0.027526983991265297, 0.023120857775211334, 0.03962160646915436, 0.015102569945156574, 0.011828928254544735, 0.032702233642339706, 0.012450595386326313, 0.016450081020593643, 0.018445398658514023, 0.022895758971571922, -0.013556568883359432, -0.012169493362307549, 0.011999730952084064, 0.005988239776343107, 0.01577499322593212, 0.01796177215874195, -0.01644870825111866, -0.017100172117352486, -0.022629594430327415, -0.009465925395488739, -0.020319294184446335, -0.022933827713131905, -0.02669898234307766, -0.04355011507868767, -0.025470642372965813, -0.013120720162987709, 0.0031702073756605387, -0.0007787885842844844, -0.002637480851262808, 0.0014405231922864914, -0.02634320966899395, -0.030109120532870293, -0.01113195065408945, -0.01674795337021351, -0.0073600211180746555, 0.009645328857004642, 0.022693822160363197, 0.016299523413181305, 0.03090914711356163, 0.04254506900906563, 0.018018689006567, 0.021162398159503937, 0.032681044191122055, 0.020170455798506737, 0.01105836033821106, 0.025267550721764565, 0.05154673382639885, 0.06558912247419357, 0.07890106737613678, 0.08222218602895737, 0.05069886893033981, 0.04908974468708038, 0.07377184182405472, 0.07235942780971527, 0.0595582090318203, 0.04710054025053978, 0.17393597960472107, 0.25750473141670227, 0.296625018119812, 0.3216109871864319, 0.23123382031917572, 0.2144954651594162, 0.3053798973560333, 0.27828603982925415, 0.2593500018119812, 0.1784662902355194, 0.21933728456497192, 0.34540802240371704, 0.3655003309249878, 0.3822565972805023, 0.27348652482032776, 0.2658422291278839, 0.36361122131347656, 0.3444115221500397, 0.33893218636512756, 0.21821779012680054, 0.25605612993240356, 0.37873581051826477, 0.3688381016254425, 0.3697499632835388, 0.25523805618286133, 0.24052011966705322, 0.3559000492095947, 0.3551251292228699, 0.369206964969635, 0.23400425910949707, 0.22990623116493225, 0.34476998448371887, 0.3162952959537506, 0.3079151511192322, 0.20942820608615875, 0.20560331642627716, 0.307331919670105, 0.30196094512939453, 0.33005207777023315, 0.21030932664871216, 0.17507871985435486, 0.27301025390625, 0.2535279095172882, 0.24810868501663208, 0.17458301782608032, 0.1610059291124344, 0.23201826214790344, 0.24196979403495789, 0.2713526487350464, 0.16125860810279846, 0.12324119359254837, 0.19217023253440857, 0.1561899483203888, 0.14114932715892792, 0.09388826787471771, 0.08703292906284332, 0.1327546089887619, 0.14069868624210358, 0.18315444886684418, 0.11218402534723282, 0.14940540492534637, 0.21463602781295776, 0.18540824949741364, 0.17696861922740936, 0.1129496693611145, 0.11105512082576752, 0.1814534068107605, 0.19700080156326294, 0.2161424607038498, 0.13815003633499146, 0.11987029761075974, 0.1734609156847, 0.15622307360172272, 0.16447456181049347, 0.10626599937677383, 0.11271408200263977, 0.17237688601016998, 0.16966982185840607, 0.17737461626529694, 0.11457115411758423, 0.13920125365257263, 0.20104041695594788, 0.21094095706939697, 0.21969321370124817, 0.16672088205814362, 0.16055285930633545, 0.22023676335811615, 0.2167227566242218, 0.2027532458305359, 0.13738562166690826, 0.11277217417955399, 0.14435867965221405, 0.14963746070861816, 0.14230254292488098, 0.0936187282204628, 0.09089493751525879, 0.13367636501789093, 0.13366466760635376, 0.13703946769237518, 0.1046830490231514, -0.07997047901153564, -0.07766833901405334, -0.15493512153625488, -0.17896389961242676, -0.12414413690567017, -0.12476864457130432, -0.16130153834819794, -0.14543868601322174, -0.07827205955982208, -0.087246373295784, -0.13236239552497864, -0.1545265167951584, -0.2522730231285095, -0.2938041388988495, -0.19895175099372864, -0.19804829359054565, -0.2819136679172516, -0.24268807470798492, -0.15334394574165344, -0.1384129375219345, -0.2260153889656067, -0.2640024423599243, -0.41649186611175537, -0.4635540843009949, -0.3226063847541809, -0.3190475404262543, -0.437510222196579, -0.38143011927604675, -0.24364110827445984, -0.22151872515678406, -0.23497386276721954, -0.2708313763141632, -0.41172829270362854, -0.4498731195926666, -0.29287460446357727, -0.28114885091781616, -0.41727975010871887, -0.37189674377441406, -0.26902535557746887, -0.2380276620388031, -0.1343500167131424, -0.18778888881206512, -0.24764326214790344, -0.2757958769798279, -0.18675711750984192, -0.18177396059036255, -0.25422927737236023, -0.21733196079730988, -0.1859281063079834, -0.14147384464740753, -0.15300314128398895, -0.19963298738002777, -0.2470637559890747, -0.2582966685295105, -0.14820502698421478, -0.14487138390541077, -0.24397441744804382, -0.2299717515707016, -0.19522282481193542, -0.15867754817008972, -0.14654935896396637, -0.2135089784860611, -0.24835428595542908, -0.2634454369544983, -0.17842340469360352, -0.1806374341249466, -0.25482842326164246, -0.22816507518291473, -0.20765091478824615, -0.1518334448337555, -0.10433424264192581, -0.14843453466892242, -0.1688338667154312, -0.1893140971660614, -0.1089702770113945, -0.10791011154651642, -0.1906583607196808, -0.17338569462299347, -0.16971878707408905, -0.1279173344373703, -0.11036191880702972, -0.16602320969104767, -0.22106076776981354, -0.2503867447376251, -0.18800991773605347, -0.18878769874572754, -0.23714256286621094, -0.20911690592765808, -0.16842980682849884, -0.11914070695638657, -0.13601335883140564, -0.19876645505428314, -0.24923314154148102, -0.28114941716194153, -0.1882462501525879, -0.19033753871917725, -0.2729986011981964, -0.24322688579559326, -0.1954881101846695, -0.13684479892253876, -0.03999045491218567, -0.07668736577033997, -0.03011125884950161, -0.042626600712537766, 0.006119842641055584, 0.013861184008419514, -0.04994945228099823, -0.027827072888612747, -0.07439548522233963, -0.04090840369462967, -0.06870344281196594, -0.15253229439258575, -0.08987711369991302, -0.10430720448493958, -0.05567721650004387, -0.050623007118701935, -0.09990093111991882, -0.07811392843723297, -0.1463242471218109, -0.059529177844524384, -0.05381394922733307, -0.1294524222612381, -0.027889302000403404, -0.03528067097067833, 0.018407821655273438, 0.02698599360883236, -0.04916960746049881, -0.03185425326228142, -0.12740309536457062, -0.04559889808297157, -0.03980863466858864, -0.12203768640756607, -0.013446854427456856, -0.014221958816051483, 0.02204946242272854, 0.03150232881307602, -0.026550965383648872, -0.00810436625033617, -0.11597476154565811, -0.02766539715230465, 0.002098413649946451, -0.08721377700567245, 0.011504950001835823, 0.009353836067020893, 0.008691849187016487, 0.016727395355701447, 0.004824237897992134, 0.008046180941164494, -0.08639867603778839, 0.008010592311620712, 0.026484405621886253, -0.04764888808131218, 0.04640550911426544, 0.040181178599596024, 0.04062236100435257, 0.0412771999835968, 0.027621198445558548, 0.02898583747446537, -0.06319582462310791, 0.015583999454975128, -0.07451181858778, -0.16401663422584534, -0.10810301452875137, -0.12332216650247574, -0.07248318195343018, -0.06923429667949677, -0.12540794909000397, -0.11314930766820908, -0.16827192902565002, -0.07083678245544434, -0.06538830697536469, -0.14347396790981293, -0.09528377652168274, -0.12245132774114609, -0.0612868070602417, -0.05707057565450668, -0.11374679952859879, -0.08924763649702072, -0.1342315375804901, -0.05691595748066902, -0.10653583705425262, -0.1790478229522705, -0.15406514704227448, -0.1800835281610489, -0.10500749945640564, -0.09853547811508179, -0.17250674962997437, -0.15104569494724274, -0.17650070786476135, -0.09240864962339401, -0.060546670109033585, -0.09365830570459366, -0.06100589409470558, -0.07288432866334915, -0.010772972367703915, -0.013077369891107082, -0.08733895421028137, -0.08134616166353226, -0.10635750740766525, -0.06736012548208237, 0.01520473975688219, -0.0025368123315274715, -0.007476340979337692, -0.006158655975013971, -0.020736442878842354, -0.023586643859744072, -0.014622660353779793, -0.021360041573643684, -0.004312818869948387, 0.015471480786800385, 0.01579316519200802, 0.04673079028725624, 0.03396943211555481, 0.03794538229703903, 0.009804910980165005, 0.014591265469789505, 0.04147367924451828, 0.0303451307117939, 0.05256231874227524, 0.03591332584619522, 0.06292910128831863, 0.0840819701552391, 0.0965704396367073, 0.10358506441116333, 0.07158391177654266, 0.072715625166893, 0.10162169486284256, 0.08861914277076721, 0.08895280957221985, 0.07577942311763763, 0.04611456021666527, 0.048497747629880905, 0.04497835785150528, 0.0435476079583168, 0.0012927609495818615, -0.003927566576749086, 0.040938958525657654, 0.03700464218854904, 0.05556110665202141, 0.058848682790994644, 0.008719949051737785, 0.04290712997317314, 0.013129977509379387, 0.011920339427888393, 0.022198982536792755, 0.010660190135240555, 0.0002800417132675648, -0.00869857519865036, 0.032453231513500214, -1.712799166853074e-05, 0.003013265784829855, 0.022049393504858017, -0.008604746311903, -0.030453916639089584, -0.045343976467847824, -0.0478024035692215, -0.032399825751781464, -0.020735347643494606, 0.025300687178969383, 0.01566888391971588, -0.01538386382162571, 0.042416080832481384, -0.015145235694944859, -0.03267628699541092, -0.012813963927328587, -0.014243245124816895, -0.045453835278749466, -0.030412180349230766, 0.039125651121139526, -0.012381059117615223, 0.009343410842120647, 0.04320738837122917, -0.01664426177740097, -0.035787396132946014, -0.04234611615538597, -0.0435195192694664, -0.04227207601070404, -0.018552986904978752, 0.04804204776883125, 0.01610088348388672, 0.050699181854724884, 0.08029758185148239, 0.06408184766769409, 0.0538673922419548, 0.03207593411207199, 0.03046886995434761, 0.04257422313094139, 0.05379030108451843, 0.07296547293663025, 0.05199948325753212, 0.05342535674571991, 0.09830211102962494, 0.08408249169588089, 0.08153211325407028, 0.04591014236211777, 0.04733838140964508, 0.07320750504732132, 0.07742757350206375, 0.1043970063328743, 0.06084337830543518, 0.10275216400623322, 0.16179677844047546, 0.14726094901561737, 0.15013471245765686, 0.09707780182361603, 0.09023695439100266, 0.15138745307922363, 0.1435234397649765, 0.1643901765346527, 0.10488267987966537, 0.10999848693609238, 0.19094093143939972, 0.16366209089756012, 0.16477714478969574, 0.11293875426054001, 0.10996180772781372, 0.1546008437871933, 0.1584540158510208, 0.18850481510162354, 0.10435865074396133, 0.07374631613492966, 0.15790167450904846, 0.07537603378295898, 0.06214398145675659, 0.02837807685136795, 0.033118393272161484, 0.0686110258102417, 0.07944181561470032, 0.15175595879554749, 0.06657624989748001, 0.07158474624156952, 0.16288523375988007, 0.080108143389225, 0.06648948788642883, 0.042096201330423355, 0.04817695915699005, 0.07571866363286972, 0.08704396337270737, 0.15946947038173676, 0.06536496430635452, 0.053371597081422806, 0.12191368639469147, 0.05518948286771774, 0.045517291873693466, 0.02304217591881752, 0.022953355684876442, 0.04376688599586487, 0.05970174819231033, 0.1261974722146988, 0.05239271745085716, 0.033049341291189194, 0.1131468415260315, 0.040587738156318665, 0.03964093700051308, 0.035484567284584045, 0.03845375403761864, 0.03596116229891777, 0.04390232264995575, 0.11210393905639648, 0.02489813230931759, 0.07022234797477722, 0.13229914009571075, 0.06023021042346954, 0.05808393284678459, 0.014139287173748016, 0.028543271124362946, 0.06872577965259552, 0.07281035929918289, 0.12749573588371277, 0.06602312624454498, 0.07900744676589966, 0.13950376212596893, 0.08629727363586426, 0.10616058856248856, 0.061062444001436234, 0.06989733874797821, 0.11525498330593109, 0.10660392045974731, 0.1387212574481964, 0.07401753216981888, 0.07746321707963943, 0.15561622381210327, 0.12091846019029617, 0.14083679020404816, 0.09472294896841049, 0.10101993381977081, 0.1435384452342987, 0.1306324154138565, 0.16180849075317383, 0.08249921351671219, 0.06114620342850685, 0.07769650220870972, 0.05238047614693642, 0.06187409162521362, 0.022780220955610275, 0.02319072186946869, 0.05803624540567398, 0.052386537194252014, 0.07686249166727066, 0.05591798946261406, 0.0020856328774243593, 0.008134865202009678, 0.029530372470617294, 0.021393930539488792, 0.041423264890909195, 0.04564555361866951, 0.035406313836574554, 0.0344233512878418, 0.009296822361648083, 0.004733348730951548, -0.030831361189484596, -0.0668121948838234, -0.04196027293801308, -0.05296630412340164, -0.01432927418500185, -0.01727875880897045, -0.046422313898801804, -0.030814863741397858, -0.06015698239207268, -0.0270627960562706, -0.03445587307214737, -0.07424771785736084, -0.0673738345503807, -0.0812823548913002, -0.04246790334582329, -0.03976450860500336, -0.07377736270427704, -0.05463883653283119, -0.06886778771877289, -0.03215016424655914, -0.03588215261697769, -0.07495361566543579, -0.057939693331718445, -0.06024354696273804, -0.017217719927430153, -0.01618417166173458, -0.05697135254740715, -0.04508614540100098, -0.08359935134649277, -0.04836248233914375, 0.04590674117207527, -0.010943802073597908, 0.038804978132247925, 0.02838854119181633, 0.007905091159045696, 0.015239355154335499, 0.04593006148934364, 0.058612335473299026, -0.010339444503188133, 0.04569343850016594, 0.026828519999980927, -0.035273656249046326, 0.028312809765338898, 0.040800731629133224, 0.03285469487309456, 0.031913161277770996, 0.051856979727745056, 0.05158941447734833, -0.026151252910494804, 0.02837740071117878, 0.06073456630110741, -0.022188544273376465, 0.09298273175954819, 0.09457653760910034, 0.06864114850759506, 0.07068836688995361, 0.11469859629869461, 0.11877290904521942, -0.009187290444970131, 0.06897509843111038, 0.06905952095985413, -0.004205232951790094, 0.11534816771745682, 0.11573495715856552, 0.10313896089792252, 0.09954499453306198, 0.12572890520095825, 0.12644940614700317, -0.009492073208093643, 0.055148858577013016, 0.0003592834691517055, -0.08318514376878738, -0.029476473107933998, -0.03956737741827965, -0.02709481492638588, -0.028504204005002975, -0.021269386634230614, -0.01284062210470438, -0.07753726094961166, 0.0025290357880294323, -0.004407310858368874, -0.06822534650564194, -0.0049854242242872715, -0.017315395176410675, 0.01005136501044035, 0.0010888539254665375, -0.00960785336792469, 0.00982791930437088, -0.059542667120695114, -0.0052845231257379055, -0.12166716158390045, -0.16506308317184448, -0.17253223061561584, -0.1872020661830902, -0.11879464238882065, -0.12354359775781631, -0.2109140157699585, -0.19822260737419128, -0.17123565077781677, -0.12076131999492645, -0.15753638744354248, -0.22750836610794067, -0.25008082389831543, -0.27410241961479187, -0.20573630928993225, -0.2035105675458908, -0.27843618392944336, -0.26391729712486267, -0.22814179956912994, -0.14850275218486786, -0.11506886780261993, -0.18751336634159088, -0.15990598499774933, -0.178651362657547, -0.10613586008548737, -0.11114410310983658, -0.18785734474658966, -0.17470252513885498, -0.18870945274829865, -0.11835699528455734, -0.16204506158828735, -0.26010221242904663, -0.23808948695659637, -0.2498457133769989, -0.16386398673057556, -0.16663792729377747, -0.25207775831222534, -0.23888009786605835, -0.25087273120880127, -0.1502247452735901, -0.14348192512989044, -0.21804514527320862, -0.19258512556552887, -0.20227575302124023, -0.10803698748350143, -0.11285540461540222, -0.2091190218925476, -0.2111598253250122, -0.2214275300502777, -0.1435190588235855, -0.17990994453430176, -0.2810688316822052, -0.2667289674282074, -0.2973257005214691, -0.18941643834114075, -0.1910688877105713, -0.3040388226509094, -0.2974250614643097, -0.2921239733695984, -0.18505613505840302, -0.3251120150089264, -0.4283182621002197, -0.45302557945251465, -0.4889802038669586, -0.3052183985710144, -0.3126087784767151, -0.5144846439361572, -0.4907282590866089, -0.4429115056991577, -0.3295533061027527, -0.3121887445449829, -0.4229695498943329, -0.4721778929233551, -0.5223982930183411, -0.34450215101242065, -0.3485075831413269, -0.5457207560539246, -0.506430983543396, -0.42942333221435547, -0.30892348289489746, -0.2579355239868164, -0.3487236499786377, -0.3996111750602722, -0.45627686381340027, -0.30055904388427734, -0.30106398463249207, -0.45844992995262146, -0.4182935357093811, -0.34920966625213623, -0.24757082760334015, -0.20652569830417633, -0.24960263073444366, -0.3055744171142578, -0.34526827931404114, -0.21060892939567566, -0.21507564187049866, -0.36613696813583374, -0.33953332901000977, -0.26002049446105957, -0.21461786329746246, 0.03261337801814079, 0.0395793579518795, 0.0327419675886631, 0.024756906554102898, 0.011039906181395054, 0.011667987331748009, 0.02185935527086258, 0.02279442362487316, 0.03785958141088486, 0.0407414585351944, 0.05549701303243637, 0.11055079102516174, 0.10024824738502502, 0.09691979736089706, 0.06916361302137375, 0.07785581797361374, 0.10417904704809189, 0.10661065578460693, 0.11945229023694992, 0.07673374563455582, 0.0431794747710228, 0.07985737174749374, 0.08172298222780228, 0.09021604061126709, 0.06894827634096146, 0.07083171606063843, 0.0808115303516388, 0.07801181077957153, 0.08264468610286713, 0.0551719069480896, 0.05428587645292282, 0.08307398110628128, 0.07000663131475449, 0.06104947254061699, 0.030356163159012794, 0.030719388276338577, 0.04779966548085213, 0.0538325309753418, 0.07952290773391724, 0.0643550306558609, 0.03353455662727356, 0.07080746442079544, 0.04131011664867401, 0.025845268741250038, 0.01948191598057747, 0.01333862729370594, 0.01078358106315136, 0.01900755800306797, 0.05813126266002655, 0.03007517382502556, 0.05128253623843193, 0.09175065904855728, 0.04907633364200592, 0.017043152824044228, -0.007404636591672897, -0.0061151315458118916, 0.01660131849348545, 0.04457656294107437, 0.09682350605726242, 0.06394246965646744, 0.021538816392421722, 0.07805678248405457, 0.00044380570761859417, -0.034298453480005264, -0.0460783913731575, -0.03978901728987694, -0.028622284531593323, 0.012063351459801197, 0.0866914689540863, 0.03756248205900192, 0.06585328280925751, 0.12365368008613586, 0.0502503402531147, 0.020541783422231674, -0.0058403629809618, 0.0019970780704170465, 0.027417702600359917, 0.06706918776035309, 0.13590095937252045, 0.08519797027111053, 0.08298799395561218, 0.14576293528079987, 0.11785756051540375, 0.10305515676736832, 0.0643870010972023, 0.06798026710748672, 0.10114477574825287, 0.12231529504060745, 0.14756150543689728, 0.09740518778562546, 0.11047317832708359, 0.15856976807117462, 0.15285980701446533, 0.15023019909858704, 0.10203633457422256, 0.10055134445428848, 0.1465238481760025, 0.15541282296180725, 0.16812650859355927, 0.11613545566797256, 0.10758212953805923, 0.13310721516609192, 0.137374147772789, 0.12475212663412094, 0.07350423187017441, 0.08123092353343964, 0.13900704681873322, 0.13680854439735413, 0.1304943710565567, 0.10115199536085129, 0.07622743397951126, 0.07838579267263412, 0.07012955099344254, 0.06535527110099792, 0.03486282005906105, 0.03390762209892273, 0.06981061398983002, 0.08111829310655594, 0.07629596441984177, 0.06604597717523575, 0.04972628131508827, 0.052403517067432404, 0.011837450787425041, 0.00025485613150522113, -0.03788101300597191, -0.021914711222052574, 0.015186811797320843, 0.03165136277675629, 0.05741729959845543, 0.04790584743022919, 0.0658160001039505, 0.08709345012903214, 0.04905382916331291, 0.04372090846300125, 0.012099171057343483, 0.017757011577486992, 0.05850473791360855, 0.06825091689825058, 0.09143031388521194, 0.06272757053375244, 0.052061159163713455, 0.0754263773560524, 0.035609688609838486, 0.0335192009806633, -0.002056274563074112, 0.012672035954892635, 0.05548007786273956, 0.05229494720697403, 0.08264288306236267, 0.06181225925683975, 0.07045424729585648, 0.11128570884466171, 0.07927174866199493, 0.10136842727661133, 0.06335393339395523, 0.07289277017116547, 0.10716409236192703, 0.10258452594280243, 0.11756914108991623, 0.06573427468538284, 0.14422477781772614, 0.1637800931930542, 0.16689442098140717, 0.18342731893062592, 0.09770462661981583, 0.1130794808268547, 0.20219339430332184, 0.18551334738731384, 0.16191551089286804, 0.13381394743919373, 0.154616579413414, 0.17166288197040558, 0.19505420327186584, 0.22330573201179504, 0.13863785564899445, 0.1422366350889206, 0.24037842452526093, 0.21848338842391968, 0.17444336414337158, 0.14624807238578796, 0.09703952819108963, 0.11989770829677582, 0.1379690319299698, 0.16876089572906494, 0.1041337326169014, 0.1217326894402504, 0.18154117465019226, 0.15414518117904663, 0.12528255581855774, 0.09895676374435425, 0.08074771612882614, 0.06717552989721298, 0.09876604378223419, 0.1260204017162323, 0.06382708251476288, 0.06497742235660553, 0.12814731895923615, 0.10806093364953995, 0.0688214972615242, 0.07793571799993515]))

    def test_Img3D_without_pad(self):
        ctf = EMAN2Ctf()
        ctf.from_dict({"defocus": 1, "cs": 2, "voltage": 300, "apix": 1.5, "bfactor": 0,"ampcont": 0.1})

        return_new = fu.filt_ctf(IMAGE_3D,ctf, dopad=False, sign=1, binary=0)
        return_old = oldfu.filt_ctf(IMAGE_3D,ctf, dopad=False, sign=1, binary=0)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview().flatten(), [-0.24125555157661438, -0.25672122836112976, -0.26500141620635986, -0.23642247915267944, -0.24713952839374542, -0.23252330720424652, -0.23245450854301453, -0.21161998808383942, -0.21685823798179626, -0.2191438227891922, -0.3204488158226013, -0.3089563250541687, -0.30389299988746643, -0.27813461422920227, -0.2646484971046448, -0.2575472593307495, -0.2579401433467865, -0.26370730996131897, -0.2836834490299225, -0.28077954053878784, -0.27068620920181274, -0.2660908102989197, -0.2503470182418823, -0.2432328164577484, -0.23651456832885742, -0.22400355339050293, -0.2348373830318451, -0.2506527006626129, -0.2519492208957672, -0.2596857249736786, -0.25253403186798096, -0.23259860277175903, -0.22310812771320343, -0.23613391816616058, -0.2509085536003113, -0.2605186700820923, -0.28171947598457336, -0.29788413643836975, -0.2809503972530365, -0.263685405254364, -0.19598940014839172, -0.1832432597875595, -0.16290034353733063, -0.18632690608501434, -0.2164718210697174, -0.23893898725509644, -0.2739725112915039, -0.28600749373435974, -0.2543954849243164, -0.23405279219150543, -0.1024802029132843, -0.09749878942966461, -0.08013954013586044, -0.12432265281677246, -0.14619390666484833, -0.15461957454681396, -0.1625324785709381, -0.1683548092842102, -0.14794354140758514, -0.1272134631872177, -0.09171184152364731, -0.058140192180871964, -0.049601245671510696, -0.06464526802301407, -0.07820886373519897, -0.111853688955307, -0.12056633085012436, -0.15051783621311188, -0.15162359178066254, -0.13503287732601166, -0.08871184289455414, -0.09161169081926346, -0.09487227350473404, -0.10722675174474716, -0.10031693428754807, -0.09858947992324829, -0.08179493248462677, -0.08471350371837616, -0.061787255108356476, -0.07256646454334259, -0.061124496161937714, -0.06526099145412445, -0.06891657412052155, -0.08593082427978516, -0.05334426835179329, -0.06470433622598648, -0.04166009649634361, -0.028449708595871925, -0.041154153645038605, -0.040976569056510925, -0.09651787579059601, -0.10711891949176788, -0.10957476496696472, -0.08900041878223419, -0.0967639684677124, -0.07269614189863205, -0.07708362489938736, -0.06062537804245949, -0.07057970017194748, -0.0784105584025383, 0.38412246108055115, 0.3748283386230469, 0.349788635969162, 0.34860849380493164, 0.35497456789016724, 0.3631037771701813, 0.36372512578964233, 0.37025097012519836, 0.33380913734436035, 0.3283597528934479, 0.4643566906452179, 0.4551942050457001, 0.43016210198402405, 0.45036640763282776, 0.4468950033187866, 0.47020384669303894, 0.4635425806045532, 0.4706013798713684, 0.4438430964946747, 0.422454833984375, 0.6234195828437805, 0.620579719543457, 0.6230006814002991, 0.6161861419677734, 0.628067135810852, 0.6090173721313477, 0.5723510980606079, 0.5852817296981812, 0.6040332913398743, 0.6118117570877075, 0.5288111567497253, 0.5215668082237244, 0.5574353337287903, 0.534899115562439, 0.5176594853401184, 0.5147462487220764, 0.5034388899803162, 0.5094279646873474, 0.5461612343788147, 0.5599225759506226, 0.27067261934280396, 0.27766934037208557, 0.30202412605285645, 0.2998775541782379, 0.31300196051597595, 0.2851531505584717, 0.27351486682891846, 0.2526789605617523, 0.2936632037162781, 0.3008977174758911, 0.17748713493347168, 0.17452870309352875, 0.20047883689403534, 0.17170456051826477, 0.17044536769390106, 0.16094137728214264, 0.15172874927520752, 0.16364505887031555, 0.19638092815876007, 0.20387502014636993, -0.05915841832756996, -0.048195429146289825, -0.046392738819122314, -0.0567668192088604, -0.0802389457821846, -0.07302487641572952, -0.09094864875078201, -0.09206422418355942, -0.08531200140714645, -0.07654264569282532, -0.010712530463933945, -0.004093456547707319, -0.02705398015677929, -0.030234433710575104, -0.06561495363712311, -0.058524858206510544, -0.07587814331054688, -0.07396218925714493, -0.08294849097728729, -0.06644266843795776, 0.1757102906703949, 0.18666785955429077, 0.2196093648672104, 0.22004984319210052, 0.1591290682554245, 0.15302757918834686, 0.10158389806747437, 0.11248189210891724, 0.14763186872005463, 0.15624091029167175, 0.28046080470085144, 0.3096941411495209, 0.320995956659317, 0.3212288022041321, 0.28373977541923523, 0.2602471113204956, 0.21995988488197327, 0.21524503827095032, 0.2518453299999237, 0.27444523572921753, -0.1582431197166443, -0.15442027151584625, -0.16896621882915497, -0.1744735836982727, -0.17551468312740326, -0.18418066203594208, -0.16339023411273956, -0.16034992039203644, -0.16611307859420776, -0.15643881261348724, -0.23209886252880096, -0.23145556449890137, -0.23356139659881592, -0.23296436667442322, -0.22169026732444763, -0.22198820114135742, -0.23369473218917847, -0.25058984756469727, -0.23982474207878113, -0.22784045338630676, -0.3738114535808563, -0.38016277551651, -0.3960069715976715, -0.4042823612689972, -0.34824898838996887, -0.3557862341403961, -0.33413591980934143, -0.33218783140182495, -0.3515324294567108, -0.35879725217819214, -0.284396231174469, -0.29435017704963684, -0.32583242654800415, -0.317554771900177, -0.28388097882270813, -0.27725327014923096, -0.2687467038631439, -0.2825489044189453, -0.3097620904445648, -0.31763559579849243, -0.05002700909972191, -0.06549756228923798, -0.08052658289670944, -0.07339541614055634, -0.05172228813171387, -0.03850099444389343, -0.015372914262115955, 0.004498096648603678, -0.041287653148174286, -0.06012120097875595, -0.0464094802737236, -0.06078566238284111, -0.10064120590686798, -0.09317075461149216, -0.03645718842744827, -0.027585238218307495, -0.004229385405778885, -0.0004255638341419399, -0.03199503943324089, -0.05099625885486603, 0.21935690939426422, 0.20845764875411987, 0.17551036179065704, 0.19962020218372345, 0.2018207162618637, 0.19464099407196045, 0.2142016738653183, 0.2464359998703003, 0.23751391470432281, 0.2367195188999176, 0.22813256084918976, 0.21202018857002258, 0.20651018619537354, 0.20489473640918732, 0.22015529870986938, 0.2290576994419098, 0.26396018266677856, 0.26006102561950684, 0.25011029839515686, 0.22753533720970154, 0.0680462047457695, 0.07369658350944519, 0.033173274248838425, 0.037941187620162964, 0.08548296242952347, 0.07765762507915497, 0.12467653304338455, 0.12242063879966736, 0.0862044170498848, 0.08213838934898376, -0.06637555360794067, -0.07779958099126816, -0.07239747792482376, -0.07655331492424011, -0.022620750591158867, -0.020106740295886993, 0.009138012304902077, 0.008420450612902641, -0.0010753098176792264, -0.03126794472336769, -0.19360820949077606, -0.19004084169864655, -0.14657382667064667, -0.16294901072978973, -0.18121011555194855, -0.21977916359901428, -0.245553657412529, -0.25124233961105347, -0.20300021767616272, -0.18364572525024414, -0.16327565908432007, -0.13703764975070953, -0.08288130909204483, -0.09379658848047256, -0.12050960212945938, -0.14953936636447906, -0.18023720383644104, -0.21893608570098877, -0.18483379483222961, -0.15833574533462524, -0.03820544108748436, -0.04042080044746399, -0.01896629109978676, -0.04090023785829544, -0.04838300868868828, -0.05983978137373924, -0.07180681079626083, -0.08417392522096634, -0.04987729340791702, -0.04221981763839722, 0.0026605245657265186, 0.0023739777971059084, -0.007072086445987225, 0.005813061259686947, -0.03105888143181801, -0.01444392278790474, -0.047638535499572754, -0.02905738167464733, -0.04036252945661545, -0.037362005561590195, -0.1186102032661438, -0.12304715067148209, -0.15523770451545715, -0.13894839584827423, -0.14643773436546326, -0.09214447438716888, -0.10232424736022949, -0.09041997790336609, -0.12430161237716675, -0.1276092678308487, -0.15314258635044098, -0.18481943011283875, -0.21229147911071777, -0.18888475000858307, -0.18614418804645538, -0.1424693614244461, -0.14022113382816315, -0.13127179443836212, -0.16304658353328705, -0.17505477368831635, -0.3527917265892029, -0.37705785036087036, -0.39699044823646545, -0.36752647161483765, -0.3445301651954651, -0.333904892206192, -0.3147173225879669, -0.301343709230423, -0.3462609052658081, -0.36227554082870483, -0.4369845986366272, -0.45806899666786194, -0.4628857672214508, -0.46010076999664307, -0.42162713408470154, -0.4028800427913666, -0.3818449378013611, -0.3654381334781647, -0.3801756501197815, -0.39598724246025085, -0.42730918526649475, -0.4324664771556854, -0.43123769760131836, -0.41585424542427063, -0.43668630719184875, -0.4338071942329407, -0.45088663697242737, -0.44513648748397827, -0.4600085914134979, -0.4593697190284729, -0.3526458442211151, -0.33181995153427124, -0.33216211199760437, -0.34474852681159973, -0.34486204385757446, -0.4038274586200714, -0.41015052795410156, -0.4302993416786194, -0.41918790340423584, -0.3940339982509613, 0.08218249678611755, 0.10927345603704453, 0.15483900904655457, 0.09381052851676941, 0.09282510727643967, 0.024685315787792206, 0.012857220135629177, -0.022389909252524376, 0.03945565223693848, 0.091649629175663, 0.22887207567691803, 0.2718919813632965, 0.32810550928115845, 0.31168943643569946, 0.27208033204078674, 0.23863667249679565, 0.19026556611061096, 0.15162970125675201, 0.21581847965717316, 0.243734672665596, 0.47298142313957214, 0.4690338969230652, 0.49842768907546997, 0.4795891046524048, 0.4775146245956421, 0.47514909505844116, 0.4650574028491974, 0.45148319005966187, 0.47006872296333313, 0.49210599064826965, 0.3538069725036621, 0.3518352508544922, 0.3453153371810913, 0.3547065854072571, 0.3625732958316803, 0.3697706460952759, 0.35397636890411377, 0.3549349009990692, 0.3349047005176544, 0.35207560658454895, 0.2312399446964264, 0.20327703654766083, 0.20772331953048706, 0.21702361106872559, 0.2039473056793213, 0.21506880223751068, 0.20454278588294983, 0.21432119607925415, 0.217076376080513, 0.2169463038444519, 0.06267886608839035, 0.051456257700920105, 0.013880711048841476, 0.021883970126509666, 0.025814183056354523, 0.07052992284297943, 0.08691494911909103, 0.1052575558423996, 0.07234741747379303, 0.06138889864087105, -0.10031390935182571, -0.11697236448526382, -0.1428401619195938, -0.12204978615045547, -0.13964077830314636, -0.09582097083330154, -0.10446740686893463, -0.09909583628177643, -0.1163104847073555, -0.1292245239019394, -0.2319497913122177, -0.23283708095550537, -0.21818996965885162, -0.20314420759677887, -0.2262866348028183, -0.22893200814723969, -0.24901838600635529, -0.23625585436820984, -0.23026011884212494, -0.23547929525375366, -0.06116078048944473, -0.05004025250673294, -0.01791488006711006, -0.010142500512301922, -0.02628966048359871, -0.05417942628264427, -0.060746390372514725, -0.09760414063930511, -0.05203178524971008, -0.03137459233403206, 0.03166256472468376, 0.06202499940991402, 0.10503923892974854, 0.08312560617923737, 0.08583994209766388, 0.044149428606033325, 0.05075894668698311, 0.015718156471848488, 0.06558039039373398, 0.08518661558628082, 0.36556217074394226, 0.35096976161003113, 0.38711029291152954, 0.37386539578437805, 0.39837440848350525, 0.3583314120769501, 0.3692219853401184, 0.34769102931022644, 0.40795421600341797, 0.425164133310318, 0.28022223711013794, 0.2833232581615448, 0.30094289779663086, 0.2950420677661896, 0.31425827741622925, 0.26354408264160156, 0.2863486409187317, 0.26983216404914856, 0.28183990716934204, 0.29338616132736206, 0.14729130268096924, 0.12863226234912872, 0.12976868450641632, 0.13124698400497437, 0.18066327273845673, 0.18949519097805023, 0.22784920036792755, 0.2258545607328415, 0.23202262818813324, 0.21108923852443695, 0.21491575241088867, 0.19402475655078888, 0.15896399319171906, 0.1666676551103592, 0.18665580451488495, 0.19046156108379364, 0.2243926227092743, 0.23107139766216278, 0.1935582160949707, 0.19088108837604523, 0.2792300581932068, 0.2465856373310089, 0.20783387124538422, 0.2333093136548996, 0.20478861033916473, 0.25767946243286133, 0.2492401897907257, 0.28788167238235474, 0.25377294421195984, 0.24165372550487518, 0.266365110874176, 0.24910038709640503, 0.19069595634937286, 0.2261907458305359, 0.2204173058271408, 0.265880823135376, 0.2572929561138153, 0.29295966029167175, 0.26252830028533936, 0.23957806825637817, 0.32179033756256104, 0.3210739493370056, 0.2615155279636383, 0.2862343192100525, 0.27845385670661926, 0.335205614566803, 0.309998095035553, 0.3259732723236084, 0.27447310090065, 0.2543989419937134, 0.39211466908454895, 0.37629690766334534, 0.34784743189811707, 0.3652746081352234, 0.3810952305793762, 0.41272008419036865, 0.4185749590396881, 0.4204857349395752, 0.3900955319404602, 0.37290674448013306, 0.348750501871109, 0.35909903049468994, 0.3586270809173584, 0.3537607491016388, 0.35700100660324097, 0.35135525465011597, 0.34871095418930054, 0.3433600068092346, 0.3467765152454376, 0.35558485984802246, 0.3157629668712616, 0.3278503119945526, 0.3756203353404999, 0.36014556884765625, 0.35650649666786194, 0.30744948983192444, 0.3047245442867279, 0.284799188375473, 0.3341832756996155, 0.3474719524383545, -0.12827779352664948, -0.13840903341770172, -0.12853337824344635, -0.14176946878433228, -0.1256318837404251, -0.13581304252147675, -0.11269140243530273, -0.12125212699174881, -0.1330615133047104, -0.11501359194517136, -0.18733949959278107, -0.19074134528636932, -0.1770346313714981, -0.17045406997203827, -0.1861417591571808, -0.1718408167362213, -0.17941352725028992, -0.176125630736351, -0.1763763725757599, -0.1866207718849182, -0.302791565656662, -0.3034883737564087, -0.3142319321632385, -0.3139074742794037, -0.3054436445236206, -0.2943165898323059, -0.28858163952827454, -0.28607943654060364, -0.28010785579681396, -0.2801533639431, -0.23545260727405548, -0.2444285750389099, -0.2489718794822693, -0.23469430208206177, -0.23555289208889008, -0.2065325230360031, -0.20981614291667938, -0.19716858863830566, -0.20884746313095093, -0.21550016105175018, -0.08910539746284485, -0.0894169807434082, -0.1519140899181366, -0.12779681384563446, -0.11387903243303299, -0.08363353461027145, -0.04175910726189613, -0.044338200241327286, -0.0832657665014267, -0.08518140017986298, -0.09267570078372955, -0.12879188358783722, -0.15939781069755554, -0.12707304954528809, -0.09394658356904984, -0.07387171685695648, -0.030970387160778046, -0.019557824358344078, -0.045228783041238785, -0.0750354677438736, -0.06132665276527405, -0.08531578630208969, -0.09886552393436432, -0.0739910900592804, -0.03692002221941948, -0.013876667246222496, 0.017765233293175697, 0.033068183809518814, -0.017246218398213387, -0.02846391312777996, -0.03629598021507263, -0.037014078348875046, -0.042804036289453506, -0.031007280573248863, 0.003337341360747814, -0.004425551742315292, 0.018388396129012108, 0.028496166691184044, -0.016682136803865433, -0.02927006594836712, -0.20741553604602814, -0.21131648123264313, -0.21287330985069275, -0.2119668424129486, -0.20544980466365814, -0.20059360563755035, -0.21116232872009277, -0.20531533658504486, -0.21986830234527588, -0.23054340481758118, -0.1825350970029831, -0.1679929494857788, -0.18299438059329987, -0.18784727156162262, -0.17157667875289917, -0.18605288863182068, -0.17171379923820496, -0.19024577736854553, -0.20765210688114166, -0.20739775896072388, -0.3227529525756836, -0.32091033458709717, -0.29377248883247375, -0.30883297324180603, -0.34416916966438293, -0.3462267518043518, -0.3546919524669647, -0.37417158484458923, -0.3610401749610901, -0.3435474634170532, -0.1577918827533722, -0.15061791241168976, -0.1463303416967392, -0.1530473679304123, -0.2114836573600769, -0.2057259976863861, -0.2393037974834442, -0.24775929749011993, -0.2381553202867508, -0.2004571557044983, 0.061473578214645386, 0.040417809039354324, 0.07579795271158218, 0.07712585479021072, 0.042594362050294876, 0.04802314564585686, 0.031853556632995605, 0.025987237691879272, 0.06520524621009827, 0.058547962456941605, 0.012731444090604782, 0.03896868973970413, 0.028318429365754128, 0.031053734943270683, 0.025752468034625053, 0.012760433368384838, -0.005416782572865486, -0.017736386507749557, -0.004613727796822786, 0.0013396587455645204, -0.1347668319940567, -0.13219308853149414, -0.11273031681776047, -0.1137838065624237, -0.12237782776355743, -0.1346411108970642, -0.1552165299654007, -0.15224245190620422, -0.1365588903427124, -0.14434270560741425, -0.24767231941223145, -0.23536382615566254, -0.23778536915779114, -0.24104221165180206, -0.24620598554611206, -0.2454843521118164, -0.2508721351623535, -0.26464155316352844, -0.2501789629459381, -0.23549017310142517, -0.500896155834198, -0.4662973880767822, -0.43892017006874084, -0.4361701011657715, -0.4507923722267151, -0.4644588232040405, -0.4745752215385437, -0.5016679763793945, -0.4921388626098633, -0.49294424057006836, -0.5917808413505554, -0.5958925485610962, -0.559852123260498, -0.5652138590812683, -0.5750203132629395, -0.59206223487854, -0.5873842239379883, -0.5918130874633789, -0.5596047043800354, -0.5654974579811096, -0.4774826169013977, -0.44397231936454773, -0.421608030796051, -0.4491601586341858, -0.43186816573143005, -0.4473227858543396, -0.4361514449119568, -0.4691437780857086, -0.4419075846672058, -0.42937302589416504, -0.3916272222995758, -0.3984162509441376, -0.35851702094078064, -0.3645893335342407, -0.3772704005241394, -0.35442617535591125, -0.3869541585445404, -0.4055039584636688, -0.3935033977031708, -0.3887617290019989, 0.3879653513431549, 0.39707034826278687, 0.3978172242641449, 0.40060538053512573, 0.4111020267009735, 0.4124865233898163, 0.4202941060066223, 0.4290919899940491, 0.40768665075302124, 0.40319982171058655, 0.3382926881313324, 0.33375492691993713, 0.31421345472335815, 0.3190611004829407, 0.3549579381942749, 0.3711342215538025, 0.39081016182899475, 0.3913678228855133, 0.3565145432949066, 0.34060850739479065, 0.2711223065853119, 0.2590440511703491, 0.2595149576663971, 0.2671666741371155, 0.2878371775150299, 0.3085312247276306, 0.32535478472709656, 0.3340345621109009, 0.31562796235084534, 0.3003656268119812, 0.194159135222435, 0.19028447568416595, 0.20400775969028473, 0.21752750873565674, 0.2094285637140274, 0.21306321024894714, 0.2111898809671402, 0.21919816732406616, 0.21532104909420013, 0.213466078042984, 0.1663641631603241, 0.18013843894004822, 0.190687894821167, 0.15470574796199799, 0.14618724584579468, 0.128731831908226, 0.13565054535865784, 0.12089003622531891, 0.12704485654830933, 0.15323852002620697, 0.22408850491046906, 0.22816196084022522, 0.255845308303833, 0.2294231653213501, 0.2092985212802887, 0.21003983914852142, 0.179213747382164, 0.1736730933189392, 0.22015784680843353, 0.22066259384155273, 0.21194756031036377, 0.26146504282951355, 0.25591495633125305, 0.24254253506660461, 0.22132255136966705, 0.21114151179790497, 0.18283364176750183, 0.1583693027496338, 0.15228962898254395, 0.15973395109176636, 0.3488556444644928, 0.35190191864967346, 0.3398854732513428, 0.3139617145061493, 0.32595527172088623, 0.3222352862358093, 0.34164199233055115, 0.3196534216403961, 0.31038615107536316, 0.3259192109107971, 0.34745466709136963, 0.37142354249954224, 0.37996751070022583, 0.3876993656158447, 0.33391010761260986, 0.336941123008728, 0.3059091866016388, 0.315433531999588, 0.31511011719703674, 0.3211139142513275, 0.41725561022758484, 0.43004110455513, 0.4106869101524353, 0.4216420650482178, 0.39630988240242004, 0.41489940881729126, 0.3799037039279938, 0.3970066010951996, 0.3870408236980438, 0.3845503032207489, -0.13685153424739838, -0.16637392342090607, -0.18906672298908234, -0.17191733419895172, -0.13661478459835052, -0.1272091418504715, -0.10113035887479782, -0.07404901832342148, -0.11159549653530121, -0.12643514573574066, -0.3302597105503082, -0.348043829202652, -0.35841214656829834, -0.34420841932296753, -0.33826586604118347, -0.3255918622016907, -0.3181163966655731, -0.29687613248825073, -0.30188554525375366, -0.3137863576412201, -0.4570215940475464, -0.47788962721824646, -0.5211045742034912, -0.5097174644470215, -0.485474169254303, -0.4593217670917511, -0.4567747116088867, -0.43819963932037354, -0.48224231600761414, -0.4972307085990906, -0.3527955412864685, -0.35652926564216614, -0.3818807601928711, -0.3870643377304077, -0.37722888588905334, -0.3629171848297119, -0.34901705384254456, -0.34010541439056396, -0.37212496995925903, -0.38532668352127075, -0.13724029064178467, -0.1431252360343933, -0.1502200961112976, -0.14935509860515594, -0.13009969890117645, -0.13482271134853363, -0.11924628913402557, -0.12502224743366241, -0.12107689678668976, -0.13064800202846527, -0.018548736348748207, -0.0038158856332302094, 0.01141220424324274, -0.020860757678747177, -0.009472553618252277, -0.03322939574718475, -0.020116310566663742, -0.03255406767129898, -0.02521366998553276, -0.01240414660423994, 0.20417854189872742, 0.2219575047492981, 0.24254260957241058, 0.2339298576116562, 0.230685755610466, 0.2353093922138214, 0.2172067016363144, 0.19703233242034912, 0.23570777475833893, 0.21788080036640167, 0.3098985552787781, 0.3065699338912964, 0.30490124225616455, 0.30482029914855957, 0.3066959083080292, 0.29971542954444885, 0.33080387115478516, 0.32763004302978516, 0.33637750148773193, 0.3398226797580719, 0.1281445324420929, 0.11256427317857742, 0.07039786130189896, 0.07456143200397491, 0.09576182067394257, 0.13888223469257355, 0.1814115047454834, 0.19165655970573425, 0.14824539422988892, 0.11947736889123917, -0.0037294961512088776, -0.04378444701433182, -0.1105995625257492, -0.08936390280723572, -0.05542474985122681, -0.03845752030611038, 0.02270948700606823, 0.04835933819413185, -0.007195961195975542, -0.030620649456977844]))

    def test_Img2Dblank_with_pad(self):
        ctf = EMAN2Ctf()
        ctf.from_dict({"defocus": 1, "cs": 2, "voltage": 300, "apix": 1.5, "bfactor": 0,"ampcont": 0.1})

        return_new = fu.filt_ctf(IMAGE_BLANK_2D,ctf, dopad=True, sign=1, binary=0)
        return_old = oldfu.filt_ctf(IMAGE_BLANK_2D,ctf, dopad=True, sign=1, binary=0)
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview().flatten(), [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]))

    def test_Img2Dblank_without_pad(self):
        ctf = EMAN2Ctf()
        ctf.from_dict({"defocus": 1, "cs": 2, "voltage": 300, "apix": 1.5, "bfactor": 0,"ampcont": 0.1})

        return_new = fu.filt_ctf(IMAGE_BLANK_2D,ctf, dopad=False, sign=1, binary=0)
        return_old = oldfu.filt_ctf(IMAGE_BLANK_2D,ctf, dopad=False, sign=1, binary=0)
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview().flatten(), [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]))

    def test_Img3Dblank_with_pad(self):
        ctf = EMAN2Ctf()
        ctf.from_dict({"defocus": 1, "cs": 2, "voltage": 300, "apix": 1.5, "bfactor": 0,"ampcont": 0.1})

        return_new = fu.filt_ctf(IMAGE_BLANK_3D,ctf, dopad=True, sign=1, binary=0)
        return_old = oldfu.filt_ctf(IMAGE_BLANK_3D,ctf, dopad=True, sign=1, binary=0)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview().flatten(), [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0] ))

    def test_Img3Dblank_without_pad(self):
        ctf = EMAN2Ctf()
        ctf.from_dict({"defocus": 1, "cs": 2, "voltage": 300, "apix": 1.5, "bfactor": 0,"ampcont": 0.1})

        return_new = fu.filt_ctf(IMAGE_BLANK_3D,ctf, dopad=False, sign=1, binary=0)
        return_old = oldfu.filt_ctf(IMAGE_BLANK_3D,ctf, dopad=False, sign=1, binary=0)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview().flatten(),[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0] ))



""" not in use
class Test_filt_tophatl(unittest.TestCase):

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_tophatl()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_tophatl()
        self.assertEqual(str(cm_new.exception), "filt_tophatl() takes at least 2 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError)as cm_new:
            fu.filt_tophatl(EMData(), freq=0.25, pad=False)
        with self.assertRaises(RuntimeError)as cm_old:
            oldfu.filt_tophatl(EMData(), freq=0.25, pad=False)
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_NoneType_Img(self):
        return_new = fu.filt_tophatl(None, freq= 0.25, pad=False)
        return_old = oldfu.filt_tophatl(None,freq= 0.25, pad=False)
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_Img2D_without_pad(self):
        return_new = fu.filt_tophatl(IMAGE_2D, freq= 0.25, pad=False)
        return_old = oldfu.filt_tophatl(IMAGE_2D,freq= 0.25, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img2D_with_pad(self):
        return_new = fu.filt_tophatl(IMAGE_2D, freq= 0.25, pad=True)
        return_old = oldfu.filt_tophatl(IMAGE_2D,freq= 0.25, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img2Dblank_without_pad(self):
        return_new = fu.filt_tophatl(IMAGE_BLANK_2D, freq= 0.25, pad=False)
        return_old = oldfu.filt_tophatl(IMAGE_BLANK_2D,freq= 0.25, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img2Dblank_with_pad(self):
        return_new = fu.filt_tophatl(IMAGE_BLANK_2D, freq= 0.25, pad=True)
        return_old = oldfu.filt_tophatl(IMAGE_BLANK_2D,freq= 0.25, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img3D_without_pad(self):
        return_new = fu.filt_tophatl(IMAGE_3D, freq= 0.25, pad=False)
        return_old = oldfu.filt_tophatl(IMAGE_3D,freq= 0.25, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img3D_with_pad(self):
        return_new = fu.filt_tophatl(IMAGE_3D, freq= 0.25, pad=True)
        return_old = oldfu.filt_tophatl(IMAGE_3D,freq= 0.25, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img3Dblank_without_pad(self):
        return_new = fu.filt_tophatl(IMAGE_BLANK_3D, freq= 0.25, pad=False)
        return_old = oldfu.filt_tophatl(IMAGE_BLANK_3D,freq= 0.25, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_Img3Dblank_with_pad(self):
        return_new = fu.filt_tophatl(IMAGE_BLANK_3D, freq= 0.25, pad=True)
        return_old = oldfu.filt_tophatl(IMAGE_BLANK_3D,freq= 0.25, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
"""

class Test_filt_tophatb(unittest.TestCase):
    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError) as cm_new:
            fu.filt_tophatb(EMData(), freql=0.25, freqh=0.35)
        with self.assertRaises(RuntimeError) as cm_old:
            oldfu.filt_tophatb(EMData(), freql=0.25, freqh=0.35)
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_tophatb()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_tophatb()
        self.assertEqual(str(cm_new.exception), "filt_tophatb() takes at least 3 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_NoneType_Img(self):
        return_new = fu.filt_tophatb(None, freql=0.25, freqh=0.35, pad=True)
        return_old = oldfu.filt_tophatb(None, freql=0.25, freqh=0.35, pad=True)
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_2DImg_with_pad(self):
        return_new = fu.filt_tophatb(IMAGE_2D, freql=0.25, freqh=0.35, pad=True)
        return_old = oldfu.filt_tophatb(IMAGE_2D, freql=0.25, freqh=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview().flatten(), [0.026167402043938637, 0.037621915340423584, 0.008222237229347229, 0.00262068142183125, 0.03030978888273239, 0.026568500325083733, -0.009158039465546608, -0.004342420492321253, 0.03540031239390373, 0.029750248417258263, 0.03200497478246689, 0.04295366257429123, -0.012861724011600018, -0.030929915606975555, 0.011956736445426941, 0.014932963065803051, -0.029786033555865288, -0.01576891541481018, 0.045409951359033585, 0.033958617597818375, 0.009307480417191982, 0.00782070029526949, -0.05178101360797882, -0.05847933515906334, 0.0031363784801214933, 0.013135039247572422, -0.04068361222743988, -0.03939496725797653, 0.016866831108927727, 0.012771863490343094, 0.021791400387883186, 0.02762729674577713, -0.012304816395044327, -0.0037732694763690233, 0.05245263874530792, 0.05032268539071083, -0.007959370501339436, -0.01691078208386898, 0.02340402640402317, 0.02249978482723236, 0.027072200551629066, 0.031031297519803047, -0.0014643376925960183, 0.008297622203826904, 0.044068120419979095, 0.029178332537412643, -0.01312077697366476, -0.011714537627995014, 0.01772904396057129, 0.018739264458417892, 0.0012844371376559138, -0.012888182885944843, -0.0466008186340332, -0.04041878506541252, -0.021817931905388832, -0.03210131451487541, -0.0377383790910244, -0.01956363394856453, -0.008689728565514088, -0.010682480409741402, 0.005278824828565121, -0.0009520201128907502, -0.006707928143441677, -0.0007455176091752946, -0.010469828732311726, -0.019692042842507362, 0.008828721940517426, 0.030781544744968414, 0.006067151669412851, -0.009676872752606869, 0.008305580355226994, 0.017095079645514488, 0.05470750853419304, 0.06394107639789581, 0.0212238859385252, 0.003056279383599758, 0.0460505485534668, 0.05710890516638756, 0.0022333008237183094, -0.012429284863173962, -0.03821626305580139, -0.04551897570490837, 0.006025025155395269, 0.0196918323636055, -0.026948852464556694, -0.04008035734295845, 0.003993113059550524, 0.003734529484063387, -0.05448387935757637, -0.049284838140010834, -0.044808223843574524, -0.05791397765278816, -0.0218692384660244, -0.013469944708049297, -0.04268106445670128, -0.041458845138549805, -0.003498208476230502, -0.0023201496805995703, -0.04203713312745094, -0.03745141997933388]))

    def test_2DImg_without_pad(self):
        return_new = fu.filt_tophatb(IMAGE_2D, freql=0.25, freqh=0.35, pad=False)
        return_old = oldfu.filt_tophatb(IMAGE_2D, freql=0.25, freqh=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview().flatten(), [0.03803342953324318, 0.043678734451532364, 0.04493684694170952, 0.04099206253886223, 0.04772791638970375, 0.04888412356376648, 0.03529301658272743, 0.034627776592969894, 0.04688477888703346, 0.04469328746199608, 0.013452548533678055, 0.027659986168146133, 0.028956541791558266, 0.013245804235339165, 0.013618583790957928, 0.017235470935702324, 0.003414788283407688, 0.0015809523174539208, 0.01657288707792759, 0.016293136402964592, -0.06159285083413124, -0.05079991742968559, -0.05324093997478485, -0.0649799033999443, -0.05641961470246315, -0.04394252225756645, -0.04655062034726143, -0.04503452777862549, -0.04205203056335449, -0.055099185556173325, 0.011915279552340508, 0.019042663276195526, 0.012222583405673504, 0.010822711512446404, 0.020561017096042633, 0.020652156323194504, 0.01819652132689953, 0.024982241913676262, 0.021689124405384064, 0.009084752760827541, 0.05279374122619629, 0.054310303181409836, 0.040280312299728394, 0.04892842099070549, 0.053895410150289536, 0.03104851394891739, 0.024234430864453316, 0.0391681082546711, 0.03637603670358658, 0.03412459045648575, -0.030502261593937874, -0.040736425668001175, -0.061923690140247345, -0.04034031927585602, -0.027773797512054443, -0.05288097262382507, -0.050592612475156784, -0.028812479227781296, -0.04208362475037575, -0.05010579153895378, -0.007406658958643675, -0.017870396375656128, -0.04022625833749771, -0.015907958149909973, -0.001429694821126759, -0.02271760255098343, -0.01186711061745882, 0.009951474145054817, -0.015085631050169468, -0.029470866546034813, 0.0657639130949974, 0.06651275604963303, 0.047506824135780334, 0.05981568247079849, 0.06152654066681862, 0.03658556193113327, 0.044021546840667725, 0.0621025487780571, 0.04103722423315048, 0.03483949974179268, -0.007417646702378988, -0.006516335532069206, -0.020252637565135956, -0.014219391159713268, -0.012065748684108257, -0.02768254280090332, -0.023912101984024048, -0.010210158303380013, -0.020936394110322, -0.025956101715564728, -0.04621945321559906, -0.04967659339308739, -0.05526493862271309, -0.04873064532876015, -0.03622407838702202, -0.03600224480032921, -0.037842631340026855, -0.03135059401392937, -0.03202885016798973, -0.04181987792253494]))

    def test_2DImgBlank_with_pad(self):
        return_new = fu.filt_tophatb(IMAGE_BLANK_2D, freql=0.25, freqh=0.35, pad=True)
        return_old = oldfu.filt_tophatb(IMAGE_BLANK_2D, freql=0.25, freqh=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview(), IMAGE_BLANK_2D.get_2dview()))

    def test_2DImgBlank_without_pad(self):
        return_new = fu.filt_tophatb(IMAGE_BLANK_2D, freql=0.25, freqh=0.35, pad=False)
        return_old = oldfu.filt_tophatb(IMAGE_BLANK_2D, freql=0.25, freqh=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview(), IMAGE_BLANK_2D.get_2dview()))

    def test_3DImg_with_pad(self):
        return_new = fu.filt_tophatb(IMAGE_3D, freql=0.25, freqh=0.35, pad=True)
        return_old = oldfu.filt_tophatb(IMAGE_3D, freql=0.25, freqh=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview().flatten(), [0.15215063095092773, 0.21025031805038452, 0.2260209619998932, 0.21625171601772308, 0.20752252638339996, 0.20695142447948456, 0.20886701345443726, 0.20814184844493866, 0.1898215115070343, 0.1363684982061386, 0.19591645896434784, 0.2639799118041992, 0.27731719613075256, 0.2683919072151184, 0.26354578137397766, 0.25955930352211, 0.2546764612197876, 0.25144508481025696, 0.2292204648256302, 0.16382154822349548, 0.17265872657299042, 0.23218408226966858, 0.23947905004024506, 0.23753739893436432, 0.24383744597434998, 0.24142803251743317, 0.23246930539608002, 0.22751019895076752, 0.20590487122535706, 0.14453910291194916, 0.13584935665130615, 0.1846623569726944, 0.1900702565908432, 0.19251172244548798, 0.20036785304546356, 0.1956692636013031, 0.18627646565437317, 0.1812574565410614, 0.16094791889190674, 0.11217984557151794, 0.10669887810945511, 0.14609692990779877, 0.15301506221294403, 0.1508793830871582, 0.14606979489326477, 0.13967108726501465, 0.14177869260311127, 0.14003890752792358, 0.11497296392917633, 0.07871506363153458, 0.07833150029182434, 0.1074007898569107, 0.12277588248252869, 0.11684777587652206, 0.09581556916236877, 0.09189357608556747, 0.11215401440858841, 0.10919429361820221, 0.06781915575265884, 0.04080064967274666, 0.04277072474360466, 0.057380348443984985, 0.08582774549722672, 0.08167805522680283, 0.04495954513549805, 0.037792786955833435, 0.06662826240062714, 0.056321363896131516, 0.0004260845307726413, -0.011589115485548973, -0.02322435937821865, -0.03436359390616417, -0.0027642862405627966, -0.004306865390390158, -0.050350237637758255, -0.0649341568350792, -0.03774029016494751, -0.048802319914102554, -0.09651023149490356, -0.08071634918451309, -0.09227190166711807, -0.12607353925704956, -0.10280996561050415, -0.10136497765779495, -0.1398593932390213, -0.1524672508239746, -0.1284717619419098, -0.13129602372646332, -0.15541404485702515, -0.11939547955989838, -0.08285310864448547, -0.10873288661241531, -0.0929187536239624, -0.08997651189565659, -0.11101405322551727, -0.11510229855775833, -0.09799109399318695, -0.09703505039215088, -0.1070128008723259, -0.0812857523560524, -0.09557361155748367, -0.14517465233802795, -0.16363860666751862, -0.15047305822372437, -0.13309414684772491, -0.14320611953735352, -0.17699702084064484, -0.19403311610221863, -0.1670447736978531, -0.11047838628292084, -0.1498929262161255, -0.22598157823085785, -0.26238518953323364, -0.2443644255399704, -0.2135247141122818, -0.22514432668685913, -0.2703157961368561, -0.2880823612213135, -0.24749259650707245, -0.1710750162601471, -0.17893722653388977, -0.26590394973754883, -0.31047070026397705, -0.28416943550109863, -0.2382872998714447, -0.24730849266052246, -0.29918819665908813, -0.31944581866264343, -0.27608755230903625, -0.19479544460773468, -0.1829124242067337, -0.2707059979438782, -0.31800025701522827, -0.2917763888835907, -0.24483826756477356, -0.2547012269496918, -0.3076989948749542, -0.3293520212173462, -0.28682416677474976, -0.19969193637371063, -0.19309929013252258, -0.2846449613571167, -0.3319961726665497, -0.31375986337661743, -0.27799898386001587, -0.28549420833587646, -0.326537549495697, -0.3479853868484497, -0.31347864866256714, -0.2167990356683731, -0.22842688858509064, -0.3285157084465027, -0.36435651779174805, -0.3468589782714844, -0.32299116253852844, -0.3226392865180969, -0.3423280119895935, -0.3660656809806824, -0.35178300738334656, -0.24996055662631989, -0.26611748337745667, -0.37507596611976624, -0.39040735363960266, -0.3663524389266968, -0.3561113476753235, -0.35403957962989807, -0.35526275634765625, -0.3787202835083008, -0.38166770339012146, -0.27793750166893005, -0.2811591923236847, -0.396200954914093, -0.3977912664413452, -0.3704226016998291, -0.37352123856544495, -0.37648919224739075, -0.3664105534553528, -0.37952515482902527, -0.3810344934463501, -0.27653375267982483, -0.25392523407936096, -0.35782259702682495, -0.3546355664730072, -0.32836097478866577, -0.33420732617378235, -0.33839839696884155, -0.3241909146308899, -0.3246779143810272, -0.3168301582336426, -0.2260773926973343, -0.16787855327129364, -0.23258036375045776, -0.22655165195465088, -0.2060420960187912, -0.20760023593902588, -0.21040961146354675, -0.201919287443161, -0.1994980275630951, -0.19067271053791046, -0.13462795317173004, -0.15071731805801392, -0.20977289974689484, -0.2311704158782959, -0.21893572807312012, -0.20216800272464752, -0.20536744594573975, -0.22082960605621338, -0.21763892471790314, -0.17868965864181519, -0.11841754615306854, -0.16740237176418304, -0.22890667617321014, -0.2568710744380951, -0.24666157364845276, -0.22686493396759033, -0.2257395088672638, -0.23296885192394257, -0.21790184080600739, -0.17423969507217407, -0.12253174185752869, -0.12908492982387543, -0.17294281721115112, -0.19792215526103973, -0.1893811970949173, -0.16880916059017181, -0.1647901087999344, -0.1663893759250641, -0.14664915204048157, -0.1112939640879631, -0.08467835187911987, -0.07523269951343536, -0.09946899861097336, -0.1254478245973587, -0.1284819394350052, -0.11676422506570816, -0.11479055881500244, -0.11278923600912094, -0.08858603984117508, -0.056328121572732925, -0.043531276285648346, -0.031249001622200012, -0.04157508164644241, -0.06820499151945114, -0.08281512558460236, -0.08014929294586182, -0.07703693956136703, -0.06933856010437012, -0.04481981694698334, -0.0189227107912302, -0.012721844017505646, 0.0011660606833174825, 0.008060773834586143, -0.0011418996145948768, -0.010386458598077297, -0.008922749198973179, -1.3320923244464211e-05, 0.015229149721562862, 0.031849849969148636, 0.03579007461667061, 0.024198437109589577, 0.040892984718084335, 0.07144413888454437, 0.09246829897165298, 0.09686383605003357, 0.09521179646253586, 0.10607276856899261, 0.13041168451309204, 0.14202924072742462, 0.12131451815366745, 0.08253935724496841, 0.09929689764976501, 0.15020623803138733, 0.1916913390159607, 0.20093198120594025, 0.18977390229701996, 0.1971643716096878, 0.22966733574867249, 0.24409638345241547, 0.21012678742408752, 0.14850866794586182, 0.14357168972492218, 0.2040437012910843, 0.24778425693511963, 0.2529948353767395, 0.2349395900964737, 0.2380557358264923, 0.2707476019859314, 0.2862919569015503, 0.24944116175174713, 0.17820361256599426, 0.1299755573272705, 0.18592803180217743, 0.21735887229442596, 0.21420104801654816, 0.194351464509964, 0.1931021511554718, 0.21764695644378662, 0.23197521269321442, 0.20393677055835724, 0.14209319651126862, 0.1404513567686081, 0.20672214031219482, 0.23009662330150604, 0.21310345828533173, 0.18561166524887085, 0.18528474867343903, 0.2169816642999649, 0.24250224232673645, 0.22349970042705536, 0.1569007784128189, 0.22612079977989197, 0.3281317949295044, 0.37138062715530396, 0.3510112464427948, 0.3120001256465912, 0.31559106707572937, 0.36376041173934937, 0.3918464481830597, 0.3477247953414917, 0.2398781031370163, 0.2715591490268707, 0.39460262656211853, 0.450533390045166, 0.4260435402393341, 0.37698885798454285, 0.3822382092475891, 0.44138869643211365, 0.47162383794784546, 0.4116344749927521, 0.2781737148761749, 0.2678735852241516, 0.39160969853401184, 0.4412822723388672, 0.40607932209968567, 0.34948399662971497, 0.35263654589653015, 0.41455140709877014, 0.45359906554222107, 0.4034932553768158, 0.27235037088394165, 0.2578345537185669, 0.37362349033355713, 0.4079924523830414, 0.36584407091140747, 0.31309613585472107, 0.31347665190696716, 0.3648020327091217, 0.40632355213165283, 0.3741894066333771, 0.2556264400482178, 0.2600763440132141, 0.3742746114730835, 0.40246322751045227, 0.36707621812820435, 0.32949918508529663, 0.3268131911754608, 0.35665565729141235, 0.3876572251319885, 0.36356547474861145, 0.2501143515110016, 0.2612805962562561, 0.37832191586494446, 0.4057318866252899, 0.3786192834377289, 0.3535612225532532, 0.34876441955566406, 0.3630412220954895, 0.38535329699516296, 0.3646932542324066, 0.2528713643550873, 0.2582678198814392, 0.37020912766456604, 0.3899973928928375, 0.36163175106048584, 0.34023261070251465, 0.33640506863594055, 0.34711119532585144, 0.36575910449028015, 0.3465902805328369, 0.2424663007259369, 0.23049615323543549, 0.3223625123500824, 0.331267774105072, 0.30194053053855896, 0.2827388346195221, 0.2801532745361328, 0.28757423162460327, 0.2968134880065918, 0.27475684881210327, 0.1902794986963272, 0.1476886123418808, 0.20550476014614105, 0.2075691819190979, 0.18664777278900146, 0.1733737587928772, 0.17068710923194885, 0.17352734506130219, 0.1746748983860016, 0.15556372702121735, 0.10328072309494019, 0.09995116293430328, 0.13727451860904694, 0.15485167503356934, 0.1458444595336914, 0.12286651879549026, 0.11640092730522156, 0.13050143420696259, 0.1307854950428009, 0.10186128318309784, 0.06842900812625885, 0.10017897188663483, 0.1305181235074997, 0.15833532810211182, 0.1496754288673401, 0.11588763445615768, 0.10886583477258682, 0.12554840743541718, 0.11004181206226349, 0.06205948814749718, 0.03923153877258301, 0.049479033797979355, 0.059508439153432846, 0.09765493869781494, 0.09733738005161285, 0.06023162230849266, 0.05368228629231453, 0.0713074654340744, 0.04522468522191048, -0.010151850059628487, -0.013521332293748856, -0.01759668067097664, -0.029434561729431152, 0.009880087338387966, 0.01956968940794468, -0.010429427027702332, -0.017235783860087395, -0.0048184446059167385, -0.02954099141061306, -0.0705547034740448, -0.05390704423189163, -0.06259309500455856, -0.09346713125705719, -0.06904760003089905, -0.05230560898780823, -0.0636589452624321, -0.07315677404403687, -0.08072654157876968, -0.10301106423139572, -0.11581259965896606, -0.08233904838562012, -0.09945950657129288, -0.14913322031497955, -0.15276378393173218, -0.13405536115169525, -0.12162048369646072, -0.1356346160173416, -0.17330649495124817, -0.19672891497612, -0.1759517937898636, -0.12276574969291687, -0.15167193114757538, -0.22229334712028503, -0.261489599943161, -0.2509794533252716, -0.22040505707263947, -0.23293137550354004, -0.28816676139831543, -0.3068910539150238, -0.2530670166015625, -0.1753421425819397, -0.19409766793251038, -0.2824646830558777, -0.3525412678718567, -0.3568241000175476, -0.31887850165367126, -0.3223098814487457, -0.3754349946975708, -0.38787350058555603, -0.31743741035461426, -0.2208406627178192, -0.1989685595035553, -0.2916358709335327, -0.3677661120891571, -0.37621450424194336, -0.3386775851249695, -0.3364717364311218, -0.3838580250740051, -0.40154561400413513, -0.34076422452926636, -0.23995853960514069, -0.17195163667201996, -0.2518220841884613, -0.30348217487335205, -0.296896755695343, -0.26132965087890625, -0.2597004473209381, -0.3013291656970978, -0.3274710774421692, -0.290648877620697, -0.20387406647205353, -0.17316946387290955, -0.2493167668581009, -0.27200672030448914, -0.25358158349990845, -0.23428034782409668, -0.23617757856845856, -0.25346872210502625, -0.2696676254272461, -0.253831684589386, -0.17736874520778656, -0.2658993601799011, -0.38335248827934265, -0.412861704826355, -0.3946043848991394, -0.37960079312324524, -0.37899062037467957, -0.3950890600681305, -0.42241883277893066, -0.40525221824645996, -0.28499501943588257, -0.32375094294548035, -0.4644981920719147, -0.48160964250564575, -0.4512549638748169, -0.436941921710968, -0.4349009096622467, -0.4502834677696228, -0.4875565469264984, -0.4744177460670471, -0.3313043713569641, -0.31647413969039917, -0.4520358145236969, -0.44921448826789856, -0.4034709632396698, -0.38521701097488403, -0.3846563994884491, -0.4031600058078766, -0.4430280923843384, -0.43226930499076843, -0.29687634110450745, -0.273023784160614, -0.3913125693798065, -0.383688360452652, -0.3319573998451233, -0.305067777633667, -0.30720263719558716, -0.33495253324508667, -0.3709731698036194, -0.3538515269756317, -0.24025486409664154, -0.23882323503494263, -0.34364840388298035, -0.3504818379878998, -0.3045171797275543, -0.267151802778244, -0.27024519443511963, -0.30876123905181885, -0.33659109473228455, -0.30316033959388733, -0.20500986278057098, -0.21443872153759003, -0.30884456634521484, -0.33521851897239685, -0.3008714020252228, -0.25455740094184875, -0.25111865997314453, -0.29003414511680603, -0.30719026923179626, -0.2595723867416382, -0.17242836952209473, -0.17618145048618317, -0.25617268681526184, -0.29270267486572266, -0.26996928453445435, -0.2215520292520523, -0.20759892463684082, -0.2361554056406021, -0.24657651782035828, -0.20048992335796356, -0.12931840121746063, -0.12338938564062119, -0.18144045770168304, -0.21104975044727325, -0.1948477029800415, -0.15604892373085022, -0.14207646250724792, -0.16329987347126007, -0.1749987006187439, -0.14331449568271637, -0.09011658281087875, -0.07297073304653168, -0.10622949153184891, -0.11704301089048386, -0.10081367939710617, -0.07766174525022507, -0.0737304612994194, -0.09186453372240067, -0.10486899316310883, -0.08850663900375366, -0.05297158285975456, -0.024751298129558563, -0.030937213450670242, -0.03875948116183281, -0.037424009293317795, -0.030934102833271027, -0.0281885527074337, -0.023896576836705208, -0.012824028730392456, -0.003336241003125906, -0.0019435654394328594, -0.013855298981070518, -0.012677719816565514, -0.01334559079259634, -0.011774594895541668, -0.006064162123948336, 0.004338463768362999, 0.01863039843738079, 0.031075194478034973, 0.03343375399708748, 0.02320660836994648, 0.016208825632929802, 0.034420110285282135, 0.04869719594717026, 0.050318051129579544, 0.04952755942940712, 0.06276972591876984, 0.08561588078737259, 0.09959927946329117, 0.09420894831418991, 0.06920633465051651, 0.07439403235912323, 0.11639054119586945, 0.14430801570415497, 0.14210782945156097, 0.13050734996795654, 0.1407187581062317, 0.16820071637630463, 0.1843227744102478, 0.17112162709236145, 0.12633731961250305, 0.1286698281764984, 0.1903727948665619, 0.22174900770187378, 0.2108641415834427, 0.18925192952156067, 0.19658100605010986, 0.2289007008075714, 0.24948401749134064, 0.2293836772441864, 0.16387781500816345, 0.1698930412530899, 0.2491631954908371, 0.2821193337440491, 0.26292598247528076, 0.23246869444847107, 0.2383381426334381, 0.27750763297080994, 0.303252637386322, 0.27561652660369873, 0.191539466381073, 0.21909500658512115, 0.3179793953895569, 0.3622249960899353, 0.34310972690582275, 0.30715206265449524, 0.3139043152332306, 0.36017540097236633, 0.38498276472091675, 0.3423648774623871, 0.23828598856925964, 0.25833067297935486, 0.3695089817047119, 0.428852915763855, 0.41689157485961914, 0.38009151816368103, 0.38947534561157227, 0.44033852219581604, 0.45869991183280945, 0.3997415602207184, 0.2812769412994385, 0.251063734292984, 0.35926395654678345, 0.42412152886390686, 0.41695529222488403, 0.37875545024871826, 0.38448360562324524, 0.43170565366744995, 0.44614478945732117, 0.38753876090049744, 0.2759438753128052, 0.1976500302553177, 0.2869988679885864, 0.34005317091941833, 0.3303336203098297, 0.2906445860862732, 0.28648433089256287, 0.3212507367134094, 0.33666378259658813, 0.29749736189842224, 0.21347622573375702, 0.18381747603416443, 0.2588214874267578, 0.27689889073371887, 0.25643637776374817, 0.23350585997104645, 0.22768869996070862, 0.24091345071792603, 0.2579358220100403, 0.2413453310728073, 0.16610269248485565, 0.2541799247264862, 0.3596050441265106, 0.38797658681869507, 0.3693770170211792, 0.3502500653266907, 0.3484659790992737, 0.363709956407547, 0.38202932476997375, 0.35641926527023315, 0.24616259336471558, 0.27885857224464417, 0.40263888239860535, 0.4277169108390808, 0.3979707360267639, 0.3751031756401062, 0.37570062279701233, 0.39370614290237427, 0.41637882590293884, 0.39412909746170044, 0.2750154435634613, 0.2563081681728363, 0.37290337681770325, 0.38383692502975464, 0.34058091044425964, 0.31264910101890564, 0.31483492255210876, 0.334425687789917, 0.35729870200157166, 0.34113362431526184, 0.23940934240818024, 0.2035556137561798, 0.29518863558769226, 0.2956989109516144, 0.24850091338157654, 0.2178848534822464, 0.22371207177639008, 0.24961557984352112, 0.2688615918159485, 0.24899059534072876, 0.1706133335828781, 0.15829019248485565, 0.23052053153514862, 0.2383699268102646, 0.1954500824213028, 0.15414981544017792, 0.15824739634990692, 0.19508948922157288, 0.21020084619522095, 0.17578522861003876, 0.11350937187671661, 0.12504516541957855, 0.18353772163391113, 0.21138077974319458, 0.17714038491249084, 0.1184292808175087, 0.11391129344701767, 0.15869992971420288, 0.1667087823152542, 0.11458081752061844, 0.06612925976514816, 0.06500464677810669, 0.09863132238388062, 0.13983716070652008, 0.11747334897518158, 0.051592692732810974, 0.04256826266646385, 0.0903618112206459, 0.09218129515647888, 0.03447341173887253, 0.007546427194029093, -0.006007340736687183, 0.0010792503599077463, 0.0410798005759716, 0.029609907418489456, -0.027579965069890022, -0.0347561277449131, 0.009955590590834618, 0.013240600004792213, -0.029381006956100464, -0.032698068767786026, -0.020793331786990166, -0.020347489044070244, 0.009252173826098442, 0.003457076149061322, -0.036409806460142136, -0.04244353994727135, -0.01239029411226511, -0.007713945582509041, -0.029093917459249496, -0.023465434089303017, -0.042964689433574677, -0.06567909568548203, -0.06357067823410034, -0.059766776859760284, -0.062290776520967484, -0.06791365146636963, -0.0789356380701065, -0.08854242414236069, -0.08279843628406525, -0.059228576719760895, -0.06455651670694351, -0.09695227444171906, -0.10490568727254868, -0.1008705422282219, -0.09684392064809799, -0.10344807803630829, -0.12217999994754791, -0.1313021034002304, -0.11467345803976059, -0.08404415100812912, -0.07935640215873718, -0.11222799867391586, -0.1401950865983963, -0.15072520077228546, -0.14581318199634552, -0.15180130302906036, -0.17628253996372223, -0.18433856964111328, -0.1544625163078308, -0.11066242307424545, -0.12821975350379944, -0.17802958190441132, -0.226976215839386, -0.24550476670265198, -0.23386061191558838, -0.23427675664424896, -0.26233625411987305, -0.2755824029445648, -0.23831626772880554, -0.16755081713199615, -0.18775473535060883, -0.26376208662986755, -0.31458327174186707, -0.32079771161079407, -0.2976928949356079, -0.2889808416366577, -0.31196749210357666, -0.333973228931427, -0.3067984879016876, -0.21619100868701935, -0.2099246084690094, -0.29674768447875977, -0.3247653543949127, -0.31333303451538086, -0.29574307799339294, -0.2870999276638031, -0.29612013697624207, -0.3225521445274353, -0.3183695077896118, -0.22517794370651245, -0.22248147428035736, -0.314081609249115, -0.31530603766441345, -0.2959933578968048, -0.3019137978553772, -0.30394434928894043, -0.2993616461753845, -0.3266565799713135, -0.3416946530342102, -0.24447739124298096, -0.271060585975647, -0.37991175055503845, -0.37054285407066345, -0.34934866428375244, -0.37064510583877563, -0.3778851628303528, -0.36427247524261475, -0.38971835374832153, -0.4076820909976959, -0.2960766553878784, -0.2986251413822174, -0.4151757061481476, -0.4081827402114868, -0.38678768277168274, -0.4044623076915741, -0.40609198808670044, -0.3878917396068573, -0.4053804874420166, -0.4120289981365204, -0.29846611618995667, -0.21734407544136047, -0.301952064037323, -0.29759907722473145, -0.2809039354324341, -0.28845569491386414, -0.28502601385116577, -0.2715456783771515, -0.2815971076488495, -0.27961474657058716, -0.19805973768234253, -0.18704275786876678, -0.2588561475276947, -0.2512293756008148, -0.2287496030330658, -0.22200550138950348, -0.2161194086074829, -0.2162770926952362, -0.2274370789527893, -0.21576347947120667, -0.14989805221557617, -0.2188621461391449, -0.30573564767837524, -0.3027157187461853, -0.27710267901420593, -0.26701638102531433, -0.2608714699745178, -0.26207104325294495, -0.27171075344085693, -0.2533685564994812, -0.1773650199174881, -0.17047381401062012, -0.23902511596679688, -0.24204999208450317, -0.22669871151447296, -0.2193233072757721, -0.21424157917499542, -0.2178831696510315, -0.2283666729927063, -0.21182642877101898, -0.14595796167850494, -0.14392203092575073, -0.19992363452911377, -0.20979264378547668, -0.20063871145248413, -0.19142533838748932, -0.1852969378232956, -0.19060181081295013, -0.20304721593856812, -0.18988916277885437, -0.12932807207107544, -0.1370810568332672, -0.18841548264026642, -0.1924629658460617, -0.17520946264266968, -0.16094471514225006, -0.1519639641046524, -0.15136823058128357, -0.16272711753845215, -0.15988703072071075, -0.10986582189798355, -0.08908727020025253, -0.12054608762264252, -0.10209294408559799, -0.07654478400945663, -0.07106077671051025, -0.06426793336868286, -0.04820771887898445, -0.05182444304227829, -0.06744793802499771, -0.045301653444767, -0.021782848984003067, -0.02579095959663391, 0.0161111019551754, 0.040127065032720566, 0.025245755910873413, 0.0258165430277586, 0.057239070534706116, 0.060876086354255676, 0.027216188609600067, 0.021489392966032028, 0.013656721450388432, 0.02396857924759388, 0.07680224627256393, 0.09719544649124146, 0.0716320052742958, 0.07079813629388809, 0.10771778225898743, 0.11031713336706161, 0.06635671854019165, 0.0471455454826355, 0.024955186992883682, 0.03942035511136055, 0.08831100910902023, 0.10401860624551773, 0.08098158985376358, 0.08370761573314667, 0.11746014654636383, 0.11814133077859879, 0.07750929892063141, 0.05384279415011406, 0.0364532470703125, 0.055794086307287216, 0.08753442019224167, 0.08975447714328766, 0.06971660256385803, 0.07405244559049606, 0.10112936794757843, 0.10668003559112549, 0.08228324353694916, 0.05746401473879814]))

    def test_3DImg_without_pad(self):
        return_new = fu.filt_tophatb(IMAGE_3D, freql=0.25, freqh=0.35, pad=False)
        return_old = oldfu.filt_tophatb(IMAGE_3D, freql=0.25, freqh=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview().flatten(),[0.29554757475852966, 0.30748289823532104, 0.32250872254371643, 0.3054152727127075, 0.3015120327472687, 0.31848230957984924, 0.3034394383430481, 0.2815804183483124, 0.2975582778453827, 0.307605117559433, 0.3747550845146179, 0.3831050395965576, 0.3911198079586029, 0.3715601861476898, 0.366081565618515, 0.38326674699783325, 0.3757174611091614, 0.35999375581741333, 0.3739883005619049, 0.3837365210056305, 0.4358121156692505, 0.43507274985313416, 0.4359193444252014, 0.4289260804653168, 0.4317464828491211, 0.4454766809940338, 0.4475037753582001, 0.44263923168182373, 0.44586148858070374, 0.44472846388816833, 0.4580897390842438, 0.4544431269168854, 0.45230403542518616, 0.46266642212867737, 0.46862661838531494, 0.46172040700912476, 0.46040353178977966, 0.4650138020515442, 0.4611421525478363, 0.4567222595214844, 0.4318566620349884, 0.42894604802131653, 0.4241914451122284, 0.44643524289131165, 0.45017585158348083, 0.4190458655357361, 0.4093421995639801, 0.4219163656234741, 0.41711950302124023, 0.4163421094417572, 0.35633841156959534, 0.35269495844841003, 0.3438398838043213, 0.3684374690055847, 0.3717311918735504, 0.33308902382850647, 0.32294538617134094, 0.34124070405960083, 0.3362647294998169, 0.3356574475765228, 0.2590830326080322, 0.2616787254810333, 0.25244322419166565, 0.2661321461200714, 0.2624037563800812, 0.2252645194530487, 0.21474586427211761, 0.2318200170993805, 0.23089860379695892, 0.23467908799648285, 0.1920117437839508, 0.2050381600856781, 0.20230388641357422, 0.20064720511436462, 0.18769928812980652, 0.1574617475271225, 0.14228759706020355, 0.1498868614435196, 0.15669801831245422, 0.1679665595293045, 0.18406496942043304, 0.1981738805770874, 0.20540457963943481, 0.19804930686950684, 0.1899903118610382, 0.18080154061317444, 0.16489405930042267, 0.15895991027355194, 0.1689150333404541, 0.17728431522846222, 0.22516927123069763, 0.23607300221920013, 0.25089961290359497, 0.2416466921567917, 0.2416897416114807, 0.25353288650512695, 0.23857136070728302, 0.22078074514865875, 0.2322596162557602, 0.2365562617778778, -0.19787758588790894, -0.1845804899930954, -0.1719670295715332, -0.1851726472377777, -0.20109020173549652, -0.209214448928833, -0.22991584241390228, -0.24212999641895294, -0.22127333283424377, -0.20102642476558685, -0.13485988974571228, -0.11770238727331161, -0.10660768300294876, -0.12301880121231079, -0.14571645855903625, -0.15943388640880585, -0.1775260716676712, -0.18655139207839966, -0.1679266393184662, -0.14593029022216797, -0.12560530006885529, -0.11360283195972443, -0.10471662133932114, -0.1098894476890564, -0.1240219846367836, -0.13745363056659698, -0.1477750539779663, -0.1503920704126358, -0.1430257111787796, -0.13380670547485352, -0.1739887148141861, -0.16561409831047058, -0.16434498131275177, -0.16185860335826874, -0.16968971490859985, -0.18894562125205994, -0.1979946494102478, -0.19555625319480896, -0.1950768083333969, -0.18912026286125183, -0.26096659898757935, -0.25345611572265625, -0.2648913860321045, -0.264665424823761, -0.27122989296913147, -0.2964032292366028, -0.3066399097442627, -0.30108916759490967, -0.3022257685661316, -0.2903396487236023, -0.38169625401496887, -0.37432852387428284, -0.3900129497051239, -0.3881285786628723, -0.38736698031425476, -0.407522976398468, -0.4157591164112091, -0.41200190782546997, -0.420389324426651, -0.41324272751808167, -0.49493780732154846, -0.4871591031551361, -0.4961927831172943, -0.4905736446380615, -0.4850247800350189, -0.4984268248081207, -0.5046470761299133, -0.5022041201591492, -0.5134548544883728, -0.5158936381340027, -0.5111770033836365, -0.5073257088661194, -0.5098471641540527, -0.5071072578430176, -0.5055345296859741, -0.5153325200080872, -0.52000492811203, -0.5129001140594482, -0.5119863152503967, -0.515884280204773, -0.4168866276741028, -0.41929200291633606, -0.4166685938835144, -0.41695085167884827, -0.4168506860733032, -0.41958120465278625, -0.42439162731170654, -0.4173751473426819, -0.40391919016838074, -0.4055175185203552, -0.2945519983768463, -0.2931198179721832, -0.2836236357688904, -0.28713881969451904, -0.28990986943244934, -0.28984421491622925, -0.3020848035812378, -0.3061808943748474, -0.28851985931396484, -0.2824063301086426, -0.19024065136909485, -0.19976596534252167, -0.1986512541770935, -0.19230352342128754, -0.18727101385593414, -0.18304717540740967, -0.1793423891067505, -0.1765204221010208, -0.17461468279361725, -0.17848290503025055, -0.31697964668273926, -0.3262803554534912, -0.32252007722854614, -0.3142087459564209, -0.3120959401130676, -0.31128427386283875, -0.3045424818992615, -0.29660168290138245, -0.29512232542037964, -0.30288535356521606, -0.37780311703681946, -0.38513410091400146, -0.3799133598804474, -0.3682522177696228, -0.36132514476776123, -0.3562783896923065, -0.3455739915370941, -0.3380819857120514, -0.34525972604751587, -0.3621285557746887, -0.3528919816017151, -0.35857972502708435, -0.3638688325881958, -0.36073043942451477, -0.3511139154434204, -0.33934688568115234, -0.32569319009780884, -0.3203180432319641, -0.3313692808151245, -0.3459621071815491, -0.23004204034805298, -0.23756887018680573, -0.25968867540359497, -0.2711383104324341, -0.2611328959465027, -0.24229438602924347, -0.22534728050231934, -0.2193397581577301, -0.22726835310459137, -0.23313789069652557, -0.07693717628717422, -0.08342790603637695, -0.10498116910457611, -0.11406230926513672, -0.09732310473918915, -0.07344355434179306, -0.058054305613040924, -0.05645609647035599, -0.06860636919736862, -0.0785122662782669, 0.03169523924589157, 0.02813730388879776, 0.020358305424451828, 0.023463698104023933, 0.04490901902318001, 0.06730370968580246, 0.07856712490320206, 0.0771474614739418, 0.0606515072286129, 0.040129028260707855, 0.09136407822370529, 0.08368460088968277, 0.07987893372774124, 0.08407922089099884, 0.10019643604755402, 0.1181747317314148, 0.13111679255962372, 0.1377103626728058, 0.1299704760313034, 0.10887780785560608, 0.08384592086076736, 0.07003594189882278, 0.06367854028940201, 0.06499850749969482, 0.07632223516702652, 0.09236517548561096, 0.1069333627820015, 0.1182178184390068, 0.119184710085392, 0.10434732586145401, -0.027099937200546265, -0.03969230130314827, -0.04272530600428581, -0.03830953314900398, -0.028161240741610527, -0.01605111174285412, -0.00758994510397315, -0.0029114247299730778, -0.0021790105383843184, -0.01079106517136097, 0.29711204767227173, 0.28688153624534607, 0.28175088763237, 0.29565542936325073, 0.30383679270744324, 0.3027523159980774, 0.3121362328529358, 0.3171044886112213, 0.3039461374282837, 0.2963883876800537, 0.328866183757782, 0.31141892075538635, 0.3058435320854187, 0.32171985507011414, 0.3321673572063446, 0.3346995711326599, 0.35033079981803894, 0.36320626735687256, 0.3536575436592102, 0.3398207724094391, 0.3615414500236511, 0.3545425832271576, 0.3546929359436035, 0.36568939685821533, 0.37424448132514954, 0.37968164682388306, 0.3910154402256012, 0.39597004652023315, 0.38379377126693726, 0.36940446496009827, 0.3799961507320404, 0.38275080919265747, 0.38292789459228516, 0.38161349296569824, 0.38683193922042847, 0.3978530764579773, 0.4042947590351105, 0.4004993140697479, 0.39038124680519104, 0.3817153573036194, 0.4174616038799286, 0.41843515634536743, 0.4132024049758911, 0.4004192054271698, 0.4031383693218231, 0.41955357789993286, 0.4254213869571686, 0.4230857193470001, 0.4243501126766205, 0.42208024859428406, 0.45750853419303894, 0.46042293310165405, 0.46153688430786133, 0.45108968019485474, 0.45281919836997986, 0.46524882316589355, 0.4640488624572754, 0.4603331387042999, 0.46745797991752625, 0.4662768542766571, 0.46068868041038513, 0.47198423743247986, 0.4828927516937256, 0.47788378596305847, 0.475612074136734, 0.4780573844909668, 0.4687964916229248, 0.46093133091926575, 0.46578648686408997, 0.464919775724411, 0.431876540184021, 0.4455764591693878, 0.45119327306747437, 0.4412045180797577, 0.43191400170326233, 0.4292251169681549, 0.42352959513664246, 0.4185697138309479, 0.4209599494934082, 0.42489752173423767, 0.3808751404285431, 0.39160051941871643, 0.3881090581417084, 0.3769276440143585, 0.3672013282775879, 0.3639182448387146, 0.36447593569755554, 0.36140868067741394, 0.35725343227386475, 0.3640599250793457, 0.3194316029548645, 0.3232749104499817, 0.31914663314819336, 0.32094788551330566, 0.3203006684780121, 0.3169366717338562, 0.3196415603160858, 0.3158918619155884, 0.30267333984375, 0.30414241552352905, -0.004180673975497484, -0.0032385331578552723, -0.01097504049539566, -0.003222427563741803, -0.009229790419340134, -0.029482349753379822, -0.029733872041106224, -0.026603126898407936, -0.03789288178086281, -0.029465822502970695, 0.14576900005340576, 0.144807368516922, 0.13195030391216278, 0.13145488500595093, 0.12249460816383362, 0.10476330667734146, 0.10595749318599701, 0.11230816692113876, 0.10854987800121307, 0.12138758599758148, 0.18313102424144745, 0.19719691574573517, 0.19379642605781555, 0.18474683165550232, 0.16834668815135956, 0.14876005053520203, 0.13786233961582184, 0.13269604742527008, 0.13328292965888977, 0.15301956236362457, 0.09738098829984665, 0.11959373950958252, 0.13051459193229675, 0.12027014046907425, 0.10211699455976486, 0.08463934808969498, 0.0637354776263237, 0.05042171850800514, 0.05787838250398636, 0.07670147716999054, -0.05365742743015289, -0.03984340280294418, -0.020581522956490517, -0.02672022208571434, -0.04029429331421852, -0.050478700548410416, -0.07112789899110794, -0.07998960465192795, -0.06058806926012039, -0.04921729117631912, -0.20887334644794464, -0.19986854493618011, -0.17595744132995605, -0.17875340580940247, -0.19085098803043365, -0.1997288465499878, -0.2211793065071106, -0.22731205821037292, -0.20108285546302795, -0.1922810822725296, -0.32097217440605164, -0.30909866094589233, -0.2894565463066101, -0.2962039113044739, -0.31108397245407104, -0.32067030668258667, -0.34019580483436584, -0.348075270652771, -0.3264063000679016, -0.31406670808792114, -0.35641515254974365, -0.3444073796272278, -0.33907952904701233, -0.3526873290538788, -0.36844268441200256, -0.374546617269516, -0.3830074667930603, -0.38972631096839905, -0.3805251121520996, -0.36610227823257446, -0.30732986330986023, -0.29506340622901917, -0.29766950011253357, -0.3074098825454712, -0.3208158016204834, -0.32983601093292236, -0.3322961926460266, -0.3387413024902344, -0.3444012999534607, -0.33146199584007263, -0.18087062239646912, -0.1701722890138626, -0.17231421172618866, -0.16909387707710266, -0.17839515209197998, -0.196834534406662, -0.20099765062332153, -0.20640479028224945, -0.22082588076591492, -0.2108980268239975, -0.2848885655403137, -0.2946258783340454, -0.3033205568790436, -0.29151424765586853, -0.28822290897369385, -0.29692333936691284, -0.29014167189598083, -0.28301405906677246, -0.29283320903778076, -0.2933294177055359, -0.3796074092388153, -0.38661953806877136, -0.4023694097995758, -0.4027855396270752, -0.40058061480522156, -0.4015295207500458, -0.39382943511009216, -0.3904956877231598, -0.3984411060810089, -0.39339762926101685, -0.45015212893486023, -0.4496076703071594, -0.45874926447868347, -0.465937077999115, -0.4678502082824707, -0.46694526076316833, -0.46642357110977173, -0.46947532892227173, -0.4708895683288574, -0.46209949254989624, -0.45760008692741394, -0.457237184047699, -0.4516223967075348, -0.4542556703090668, -0.45590507984161377, -0.4535638391971588, -0.45891448855400085, -0.4624035358428955, -0.4534687399864197, -0.4500505328178406, -0.41820770502090454, -0.4260549545288086, -0.4100086987018585, -0.40455806255340576, -0.4003787338733673, -0.391452819108963, -0.39601320028305054, -0.3962780237197876, -0.3795676529407501, -0.3858321011066437, -0.35251474380493164, -0.3625533878803253, -0.3463212847709656, -0.34196358919143677, -0.3371467888355255, -0.32446134090423584, -0.32805803418159485, -0.32958367466926575, -0.31121698021888733, -0.31669583916664124, -0.26855388283729553, -0.2789284288883209, -0.27300599217414856, -0.2756999433040619, -0.2720668911933899, -0.2556053400039673, -0.25326642394065857, -0.25605738162994385, -0.24339249730110168, -0.2439945489168167, -0.20148372650146484, -0.21818237006664276, -0.2230033427476883, -0.22373946011066437, -0.21469810605049133, -0.19324278831481934, -0.178913414478302, -0.17740283906459808, -0.17634335160255432, -0.18187448382377625, -0.18542525172233582, -0.20356972515583038, -0.20833787322044373, -0.197329580783844, -0.1854843646287918, -0.1727609783411026, -0.15643928945064545, -0.1507200449705124, -0.159317746758461, -0.17062419652938843, -0.21602149307727814, -0.22819413244724274, -0.23010601103305817, -0.2122945636510849, -0.20567244291305542, -0.21089023351669312, -0.20256879925727844, -0.1956590861082077, -0.20653046667575836, -0.21386122703552246, 0.2097201645374298, 0.19965386390686035, 0.2002539187669754, 0.21094834804534912, 0.21557319164276123, 0.21411286294460297, 0.2179969996213913, 0.22325177490711212, 0.22235801815986633, 0.2179354727268219, 0.10038521140813828, 0.08962682634592056, 0.0873887687921524, 0.09635376185178757, 0.11195085942745209, 0.12779740989208221, 0.13740184903144836, 0.13595540821552277, 0.12586720287799835, 0.11326045542955399, 0.08425220847129822, 0.07131922990083694, 0.06898617744445801, 0.07486943155527115, 0.09288186579942703, 0.1168583333492279, 0.13011470437049866, 0.1297053098678589, 0.12180371582508087, 0.1052863597869873, 0.18339721858501434, 0.16853360831737518, 0.16798201203346252, 0.17046599090099335, 0.183965802192688, 0.20700712502002716, 0.22057652473449707, 0.22502008080482483, 0.22623562812805176, 0.21113035082817078, 0.30805712938308716, 0.29617398977279663, 0.29816707968711853, 0.2988245189189911, 0.3090435862541199, 0.330160915851593, 0.34029245376586914, 0.34154048562049866, 0.3446376919746399, 0.3334980607032776, 0.4026404917240143, 0.39983895421028137, 0.40118280053138733, 0.3961382806301117, 0.39984244108200073, 0.4154271185398102, 0.41858240962028503, 0.4107668399810791, 0.41145792603492737, 0.4115348756313324, 0.47026124596595764, 0.4709816873073578, 0.46908634901046753, 0.4608140289783478, 0.45937177538871765, 0.46912893652915955, 0.4697476029396057, 0.45929840207099915, 0.4586022198200226, 0.46684613823890686, 0.4820815324783325, 0.47475582361221313, 0.4740014374256134, 0.4762948751449585, 0.47974324226379395, 0.48781445622444153, 0.492961585521698, 0.48928767442703247, 0.48643600940704346, 0.4870709478855133, 0.42198529839515686, 0.40744346380233765, 0.4116314649581909, 0.4269067645072937, 0.4335572123527527, 0.4350667893886566, 0.441772997379303, 0.44740936160087585, 0.44604140520095825, 0.4381619393825531, 0.3257715404033661, 0.3128170371055603, 0.31756991147994995, 0.33311009407043457, 0.3349253237247467, 0.3272817134857178, 0.3304024338722229, 0.34017524123191833, 0.3434462249279022, 0.3387312889099121, 0.18599820137023926, 0.1961660534143448, 0.2076491266489029, 0.19779200851917267, 0.18075211346149445, 0.16955164074897766, 0.15538883209228516, 0.15140356123447418, 0.16988947987556458, 0.18476450443267822, 0.2972208559513092, 0.30911126732826233, 0.32673972845077515, 0.3248617947101593, 0.3176296651363373, 0.3135709762573242, 0.2988795340061188, 0.2883494794368744, 0.2974153757095337, 0.30199164152145386, 0.3575321435928345, 0.3684465289115906, 0.38216811418533325, 0.37900310754776, 0.3727603256702423, 0.3709448575973511, 0.36142876744270325, 0.35401418805122375, 0.35967880487442017, 0.3611595034599304, 0.35749655961990356, 0.3692646324634552, 0.3724239766597748, 0.3604714274406433, 0.3476243317127228, 0.342160701751709, 0.33737999200820923, 0.33495038747787476, 0.3403666913509369, 0.3484443426132202, 0.2518511414527893, 0.266758531332016, 0.26374125480651855, 0.2503150403499603, 0.23736266791820526, 0.2301364243030548, 0.2260196954011917, 0.21972833573818207, 0.216610848903656, 0.22864730656147003, 0.08790324628353119, 0.10455507040023804, 0.09958682954311371, 0.08917882293462753, 0.07828085869550705, 0.06906060874462128, 0.0631328597664833, 0.05170717090368271, 0.04125906899571419, 0.05566119775176048, -0.03494706004858017, -0.01892807148396969, -0.021785713732242584, -0.02900073677301407, -0.04159653186798096, -0.05596962943673134, -0.06452523171901703, -0.0754690170288086, -0.08424713462591171, -0.06773421168327332, -0.09462927281856537, -0.08151914924383163, -0.0768391489982605, -0.07770353555679321, -0.08961717784404755, -0.10568293184041977, -0.1155056580901146, -0.12380354851484299, -0.1284625232219696, -0.1163446381688118, -0.08257728815078735, -0.07381153851747513, -0.06458134949207306, -0.06470096856355667, -0.07708713412284851, -0.0911533534526825, -0.1001395434141159, -0.10379889607429504, -0.10001587867736816, -0.09093643724918365, 0.029865672811865807, 0.03721962124109268, 0.04527999833226204, 0.036599837243556976, 0.018273698166012764, 0.004400556907057762, -0.005714235361665487, -0.005325428210198879, 0.011337459087371826, 0.026148008182644844, -0.31247925758361816, -0.304238498210907, -0.29377299547195435, -0.3145798444747925, -0.32452940940856934, -0.3109554052352905, -0.31831100583076477, -0.3286324441432953, -0.30862170457839966, -0.2993082106113434, -0.3099076747894287, -0.29728642106056213, -0.2791686952114105, -0.29256337881088257, -0.3030788004398346, -0.2980736196041107, -0.3126833438873291, -0.3251945674419403, -0.30634650588035583, -0.2980670928955078, -0.341769814491272, -0.3276621699333191, -0.31606143712997437, -0.32864144444465637, -0.34145990014076233, -0.34409549832344055, -0.3557066023349762, -0.3635554015636444, -0.35115328431129456, -0.34219658374786377, -0.3872794210910797, -0.37298014760017395, -0.3742886185646057, -0.38754886388778687, -0.40285584330558777, -0.4143677353858948, -0.4204343855381012, -0.4218868911266327, -0.4185657203197479, -0.40664035081863403, -0.44471901655197144, -0.43743330240249634, -0.44630375504493713, -0.44750547409057617, -0.45298632979393005, -0.46625375747680664, -0.46545547246932983, -0.4622703790664673, -0.4726664423942566, -0.4686680734157562, -0.46982985734939575, -0.47737354040145874, -0.4908195436000824, -0.47783806920051575, -0.46923139691352844, -0.4765019714832306, -0.4655121862888336, -0.45436152815818787, -0.472207635641098, -0.4815255403518677, -0.4354936480522156, -0.44815754890441895, -0.4619060158729553, -0.448258638381958, -0.438408225774765, -0.44265440106391907, -0.4281282424926758, -0.4130299985408783, -0.42770546674728394, -0.4395410418510437, -0.39955422282218933, -0.4025176763534546, -0.40897461771965027, -0.40412530303001404, -0.40006402134895325, -0.40026870369911194, -0.39113903045654297, -0.385378360748291, -0.3968241512775421, -0.40426602959632874, -0.3884325325489044, -0.38393405079841614, -0.3843528628349304, -0.39183542132377625, -0.3909646272659302, -0.3789730668067932, -0.3731521666049957, -0.37843483686447144, -0.3847954273223877, -0.3885202705860138, -0.35632309317588806, -0.3512677550315857, -0.34914565086364746, -0.36874523758888245, -0.3731183707714081, -0.35372012853622437, -0.3509845435619354, -0.35910171270370483, -0.3509983420372009, -0.34773513674736023, -0.001977024134248495, -0.0039475844241678715, 0.005250808782875538, -0.010502820834517479, 0.0007791462121531367, 0.04294402897357941, 0.04658159241080284, 0.029712162911891937, 0.03905783221125603, 0.03148656338453293, -0.11759784817695618, -0.12223591655492783, -0.11483608186244965, -0.12818065285682678, -0.11814773082733154, -0.08083763718605042, -0.07600393146276474, -0.08804760873317719, -0.0777687132358551, -0.0850525051355362, -0.15969380736351013, -0.1689860075712204, -0.1706680804491043, -0.1772172898054123, -0.1649426817893982, -0.1355065256357193, -0.12404534965753555, -0.12671364843845367, -0.12502209842205048, -0.1359485387802124, -0.10720741748809814, -0.11815351992845535, -0.12674137949943542, -0.12084735184907913, -0.10812187939882278, -0.09785200655460358, -0.08617762476205826, -0.07923935353755951, -0.08688116073608398, -0.09903723746538162, 0.021356714889407158, 0.0045918370597064495, -0.006259073503315449, 0.018384892493486404, 0.03591347113251686, 0.028345974162220955, 0.03891604766249657, 0.056410159915685654, 0.04206671193242073, 0.02426101453602314, 0.1921377331018448, 0.1637677401304245, 0.1484750658273697, 0.18374556303024292, 0.20758183300495148, 0.19651664793491364, 0.21341736614704132, 0.24342311918735504, 0.22871504724025726, 0.20287397503852844, 0.3423236608505249, 0.3165728747844696, 0.2986169457435608, 0.3233378827571869, 0.34026849269866943, 0.3303167521953583, 0.3483787178993225, 0.37995973229408264, 0.3713485598564148, 0.350749135017395, 0.3849014341831207, 0.3780042231082916, 0.36662644147872925, 0.37155431509017944, 0.37706810235977173, 0.3736687898635864, 0.3831138014793396, 0.39731693267822266, 0.3915874660015106, 0.382752925157547, 0.29814767837524414, 0.3017285168170929, 0.30017080903053284, 0.2927630543708801, 0.3003101348876953, 0.31900158524513245, 0.3246465027332306, 0.3178962767124176, 0.31094372272491455, 0.30282941460609436, 0.14792338013648987, 0.14857709407806396, 0.15358738601207733, 0.14049378037452698, 0.15394820272922516, 0.19360606372356415, 0.20012791454792023, 0.18381159007549286, 0.18274210393428802, 0.17184047400951385]))

    def test_3DImgBlank_with_pad(self):
        return_new = fu.filt_tophatb(IMAGE_BLANK_3D, freql=0.25, freqh=0.35, pad=True)
        return_old = oldfu.filt_tophatb(IMAGE_BLANK_3D, freql=0.25, freqh=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview(), IMAGE_BLANK_3D.get_3dview()))

    def test_3DImgBlank_without_pad(self):
        return_new = fu.filt_tophatb(IMAGE_BLANK_3D, freql=0.25, freqh=0.35, pad=False)
        return_old = oldfu.filt_tophatb(IMAGE_BLANK_3D, freql=0.25, freqh=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview(), IMAGE_BLANK_3D.get_3dview()))


class Test_filt_gaussl(unittest.TestCase):

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_gaussl()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_gaussl()
        self.assertEqual(str(cm_new.exception), "filt_gaussl() takes at least 2 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError) as cm_new:
            fu.filt_gaussl(EMData(), sigma=0.23)
        with self.assertRaises(RuntimeError) as cm_old:
            oldfu.filt_gaussl(EMData(), sigma=0.23)
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_NoneType_Img(self):
        return_new =  fu.filt_gaussl(None,sigma= 0.23, pad=False )
        return_old = oldfu.filt_gaussl(None,sigma= 0.23, pad=False )
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_2DImg_without_pad(self):
        return_new = fu.filt_gaussl(IMAGE_2D,sigma= 0.23, pad=False )
        return_old = oldfu.filt_gaussl(IMAGE_2D,sigma= 0.23, pad=False )
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview().flatten(), [-0.07254021614789963, -0.07856544107198715, -0.081752248108387, -0.08076252043247223, -0.07590368390083313, -0.07091961801052094, -0.0675322487950325, -0.06027483195066452, -0.05347320809960365, -0.05706670135259628, 0.05743204057216644, 0.051544561982154846, 0.0485745407640934, 0.04487817734479904, 0.04840565100312233, 0.058143842965364456, 0.0614781454205513, 0.06956527382135391, 0.07496936619281769, 0.06766314804553986, 0.06593409925699234, 0.06876398622989655, 0.0707014799118042, 0.07054559141397476, 0.07922782748937607, 0.08860933780670166, 0.0880674347281456, 0.08905935287475586, 0.08129028975963593, 0.06787627935409546, 0.05070506036281586, 0.06283573806285858, 0.06505990773439407, 0.0657278448343277, 0.07707791030406952, 0.08098454028367996, 0.06649869680404663, 0.05234840139746666, 0.042487982660532, 0.03817972540855408, -0.010621808469295502, 0.0019574356265366077, -0.003070474835112691, -0.006531324237585068, -0.006163818761706352, -0.013850401155650616, -0.028704656288027763, -0.040457453578710556, -0.04833649471402168, -0.04313838854432106, -0.09555826336145401, -0.08834890276193619, -0.10420064628124237, -0.11160119622945786, -0.11946356296539307, -0.12714998424053192, -0.13158193230628967, -0.1401275247335434, -0.15054622292518616, -0.13964055478572845, -0.20932859182357788, -0.20354168117046356, -0.22109484672546387, -0.23208877444267273, -0.24182769656181335, -0.24717774987220764, -0.24810908734798431, -0.2526644468307495, -0.2665521800518036, -0.2566162943840027, -0.3206581771373749, -0.3087061941623688, -0.32116207480430603, -0.3305239677429199, -0.33785632252693176, -0.3447803556919098, -0.3520355224609375, -0.35561031103134155, -0.3659018576145172, -0.36112406849861145, -0.39632707834243774, -0.38070663809776306, -0.3857714831829071, -0.390390545129776, -0.39625322818756104, -0.39990198612213135, -0.40174269676208496, -0.40653517842292786, -0.417561411857605, -0.4224570691585541, -0.3369361162185669, -0.33616799116134644, -0.34022828936576843, -0.33912393450737, -0.33440297842025757, -0.3304048180580139, -0.32537132501602173, -0.3223040997982025, -0.32677531242370605, -0.3340654671192169]))

    def test_2DImg_with_pad(self):
        return_new = fu.filt_gaussl(IMAGE_2D,sigma= 0.23, pad=True )
        return_old = oldfu.filt_gaussl(IMAGE_2D,sigma= 0.23, pad=True )
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview().flatten(),[-0.04933172091841698, -0.014552726410329342, -0.01566758193075657, -0.014472446404397488, -0.013207469135522842, -0.010710191912949085, -0.008787059225142002, -0.0031881332397460938, 0.0041608428582549095, -0.030665339902043343, 0.005580849479883909, 0.05118938162922859, 0.048576176166534424, 0.04571714252233505, 0.049022722989320755, 0.0588608980178833, 0.06240376457571983, 0.0697125717997551, 0.07485240697860718, 0.01877225749194622, 0.01567690260708332, 0.06895192712545395, 0.07144773006439209, 0.07204976677894592, 0.0802731141448021, 0.08950576931238174, 0.08934017270803452, 0.08947663754224777, 0.08125299215316772, 0.016443796455860138, 0.006176776718348265, 0.06117887794971466, 0.06375937163829803, 0.0650477483868599, 0.07630815356969833, 0.08024155348539352, 0.0660836324095726, 0.051116447895765305, 0.04095485433936119, -0.011500678025186062, -0.034123338758945465, 0.0020147417671978474, -0.0025619124062359333, -0.005812787916511297, -0.005517845042049885, -0.013489446602761745, -0.027902670204639435, -0.040388889610767365, -0.048481088131666183, -0.08119247108697891, -0.09767692536115646, -0.08903937041759491, -0.10475015640258789, -0.11231938749551773, -0.11991054564714432, -0.1277458518743515, -0.13189652562141418, -0.14096981287002563, -0.1513466089963913, -0.16136252880096436, -0.18448053300380707, -0.20257098972797394, -0.22009140253067017, -0.23160743713378906, -0.24109043180942535, -0.24676576256752014, -0.24747876822948456, -0.25211986899375916, -0.2658611536026001, -0.25328582525253296, -0.27447885274887085, -0.3086613714694977, -0.3214435875415802, -0.3316986858844757, -0.33852240443229675, -0.3454986810684204, -0.3528769910335541, -0.35614264011383057, -0.36608612537384033, -0.332570880651474, -0.33754709362983704, -0.3802223205566406, -0.3855055272579193, -0.3911431133747101, -0.39663082361221313, -0.400522917509079, -0.4025404155254364, -0.4065818190574646, -0.41738444566726685, -0.3752693831920624, -0.33286619186401367, -0.37758535146713257, -0.3822827935218811, -0.3828573524951935, -0.37796035408973694, -0.3733980357646942, -0.36933082342147827, -0.3673282861709595, -0.37330955266952515, -0.33457401394844055] ))

    def test_2DImgBlank_without_pad(self):
        return_new = fu.filt_gaussl(IMAGE_BLANK_2D,sigma= 0.23, pad=False )
        return_old = oldfu.filt_gaussl(IMAGE_BLANK_2D,sigma= 0.23, pad=False )
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview(), IMAGE_BLANK_2D.get_2dview()))

    def test_2DImgBlank_with_pad(self):
        return_new = fu.filt_gaussl(IMAGE_BLANK_2D,sigma= 0.23, pad=True )
        return_old = oldfu.filt_gaussl(IMAGE_BLANK_2D,sigma= 0.23, pad=True )
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview(), IMAGE_BLANK_2D.get_2dview()))

    def test_3DImg_without_pad(self):
        return_new = fu.filt_gaussl(IMAGE_3D,sigma= 0.23, pad=False )
        return_old = oldfu.filt_gaussl(IMAGE_3D,sigma= 0.23, pad=False )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview().flatten(),[-0.31184864044189453, -0.32317915558815, -0.3197837173938751, -0.31311309337615967, -0.3034275770187378, -0.2948652505874634, -0.2890019714832306, -0.28079095482826233, -0.2728981077671051, -0.2809889018535614, -0.22470682859420776, -0.23239976167678833, -0.22860723733901978, -0.2243449091911316, -0.21801042556762695, -0.20934134721755981, -0.20409250259399414, -0.1961471140384674, -0.19142891466617584, -0.20277388393878937, -0.19219577312469482, -0.19490395486354828, -0.18992303311824799, -0.18403242528438568, -0.17502683401107788, -0.16647183895111084, -0.16342271864414215, -0.16050048172473907, -0.16430802643299103, -0.1780894547700882, -0.1874544322490692, -0.1800595372915268, -0.1782490313053131, -0.17718081176280975, -0.17110185325145721, -0.16901323199272156, -0.17748671770095825, -0.18726789951324463, -0.19524914026260376, -0.19749712944030762, -0.23201321065425873, -0.21960173547267914, -0.2233715057373047, -0.22746886312961578, -0.2306823581457138, -0.23820903897285461, -0.2500529885292053, -0.2599981725215912, -0.26766544580459595, -0.26239013671875, -0.3018622100353241, -0.2916189134120941, -0.3021945655345917, -0.3091137707233429, -0.3165138065814972, -0.3243699371814728, -0.3307797908782959, -0.33887261152267456, -0.3475992679595947, -0.3393021523952484, -0.38483673334121704, -0.3771900534629822, -0.3876686692237854, -0.39530837535858154, -0.40079906582832336, -0.40429583191871643, -0.4070855677127838, -0.412995308637619, -0.4238087236881256, -0.417980819940567, -0.4564669132232666, -0.45413193106651306, -0.4611338973045349, -0.4653511047363281, -0.46463361382484436, -0.46346983313560486, -0.4642443358898163, -0.4635324478149414, -0.4679681062698364, -0.46875131130218506, -0.4771991968154907, -0.4747806191444397, -0.4761160612106323, -0.4753378629684448, -0.4732588827610016, -0.4709625244140625, -0.4670259952545166, -0.46488094329833984, -0.468636691570282, -0.4760153889656067, -0.4342554807662964, -0.44078966975212097, -0.4388323426246643, -0.43322592973709106, -0.4247972071170807, -0.41762834787368774, -0.4103044867515564, -0.4046875834465027, -0.4031088054180145, -0.41187533736228943, -0.4525874853134155, -0.46050775051116943, -0.45556336641311646, -0.45146405696868896, -0.4474864602088928, -0.4437023997306824, -0.4433915317058563, -0.44060018658638, -0.4344477653503418, -0.4348633587360382, -0.38438645005226135, -0.38143953680992126, -0.3751833736896515, -0.37107053399086, -0.37409159541130066, -0.3770548701286316, -0.3803003132343292, -0.38182276487350464, -0.3851791322231293, -0.3877909481525421, -0.38957902789115906, -0.38771599531173706, -0.3801697790622711, -0.37036970257759094, -0.3675359785556793, -0.368726909160614, -0.36925652623176575, -0.3707383871078491, -0.37959596514701843, -0.3885897397994995, -0.4063608646392822, -0.3986346125602722, -0.3969060480594635, -0.3945785164833069, -0.39563804864883423, -0.40055006742477417, -0.40695929527282715, -0.41579240560531616, -0.42712604999542236, -0.42636626958847046, -0.46690821647644043, -0.4551657736301422, -0.4629576504230499, -0.4702495038509369, -0.4795711934566498, -0.4894500970840454, -0.4992082417011261, -0.5075975060462952, -0.5155611634254456, -0.5062839984893799, -0.5536296367645264, -0.5419275760650635, -0.5513123869895935, -0.5578508973121643, -0.566343367099762, -0.5747588276863098, -0.5824527144432068, -0.591442883014679, -0.6015794277191162, -0.5937737822532654, -0.6449899673461914, -0.6353552341461182, -0.6425133943557739, -0.6470655798912048, -0.649864673614502, -0.6510971188545227, -0.656514048576355, -0.6678410172462463, -0.681552529335022, -0.6777026653289795, -0.7128188610076904, -0.7168163657188416, -0.7229447364807129, -0.7247064709663391, -0.7189958095550537, -0.7112531065940857, -0.7084845900535583, -0.7072518467903137, -0.709209144115448, -0.7127267718315125, -0.705424964427948, -0.7160392999649048, -0.7166861891746521, -0.7131708264350891, -0.7030528783798218, -0.6932861804962158, -0.6843817830085754, -0.674077033996582, -0.6679440140724182, -0.6784214377403259, -0.6104300618171692, -0.6245461702346802, -0.6202375292778015, -0.6137368679046631, -0.6019951701164246, -0.5910747647285461, -0.5818872451782227, -0.5715479254722595, -0.561954140663147, -0.5712412595748901, -0.4427522122859955, -0.4504043161869049, -0.4396023154258728, -0.4308057725429535, -0.4238254129886627, -0.42324844002723694, -0.4240153431892395, -0.42055341601371765, -0.41182127594947815, -0.4134751260280609, -0.44303610920906067, -0.4466113746166229, -0.4302724301815033, -0.41534748673439026, -0.40666067600250244, -0.40395116806030273, -0.40503692626953125, -0.4079801142215729, -0.4095621407032013, -0.4176761209964752, -0.39379259943962097, -0.4000127613544464, -0.38739851117134094, -0.37148091197013855, -0.3620619475841522, -0.35822612047195435, -0.3558809459209442, -0.3556956946849823, -0.35966238379478455, -0.3713949918746948, -0.35812118649482727, -0.35800719261169434, -0.35040178894996643, -0.34382110834121704, -0.3405124545097351, -0.3420692980289459, -0.3423544764518738, -0.34273624420166016, -0.34382495284080505, -0.3481746315956116, -0.33898571133613586, -0.3379935324192047, -0.33978205919265747, -0.3423621952533722, -0.34443944692611694, -0.3469720780849457, -0.3483853340148926, -0.347979873418808, -0.344841867685318, -0.3415045142173767, -0.3401157557964325, -0.34282442927360535, -0.3424329459667206, -0.34030473232269287, -0.3401467800140381, -0.3400660753250122, -0.3386402726173401, -0.33714938163757324, -0.3350435793399811, -0.3360319137573242, -0.32903411984443665, -0.3310008943080902, -0.32514357566833496, -0.31737595796585083, -0.311097115278244, -0.3081052303314209, -0.3067764639854431, -0.30752795934677124, -0.3103655278682709, -0.31736886501312256, -0.30846086144447327, -0.31448790431022644, -0.31064751744270325, -0.3055482506752014, -0.29596102237701416, -0.2871740460395813, -0.2815800607204437, -0.27767661213874817, -0.2768790125846863, -0.28666236996650696, -0.2674556076526642, -0.2729981243610382, -0.2751295864582062, -0.2742435336112976, -0.2666367292404175, -0.2594626247882843, -0.25242847204208374, -0.24460095167160034, -0.24179206788539886, -0.25035813450813293, -0.30594706535339355, -0.3120605945587158, -0.31157734990119934, -0.3088688552379608, -0.30441319942474365, -0.3022659718990326, -0.298507422208786, -0.2913254499435425, -0.2863668203353882, -0.2904532849788666, -0.2030310481786728, -0.2008538842201233, -0.19918373227119446, -0.1990930587053299, -0.1994534581899643, -0.20654639601707458, -0.21354758739471436, -0.21705256402492523, -0.21865500509738922, -0.21125344932079315, -0.2134198695421219, -0.21348704397678375, -0.21070246398448944, -0.20784340798854828, -0.2051226794719696, -0.20714914798736572, -0.21125568449497223, -0.21551905572414398, -0.21790820360183716, -0.2138456404209137, -0.21941854059696198, -0.22342978417873383, -0.2180052250623703, -0.20922668278217316, -0.20732524991035461, -0.20843352377414703, -0.21029050648212433, -0.21107950806617737, -0.21278353035449982, -0.21563374996185303, -0.21176110208034515, -0.21188831329345703, -0.20721569657325745, -0.20052997767925262, -0.19561055302619934, -0.19906866550445557, -0.20312604308128357, -0.20110583305358887, -0.19981443881988525, -0.204609677195549, -0.18972374498844147, -0.19168198108673096, -0.19154787063598633, -0.18837808072566986, -0.1808546930551529, -0.1829071044921875, -0.1863529086112976, -0.18285830318927765, -0.17786990106105804, -0.1799795776605606, -0.16189058125019073, -0.16468431055545807, -0.16195298731327057, -0.15829715132713318, -0.15413029491901398, -0.15276406705379486, -0.15208157896995544, -0.1480902135372162, -0.14486323297023773, -0.1505456119775772, -0.1350923627614975, -0.13243849575519562, -0.12778151035308838, -0.12133560329675674, -0.11753315478563309, -0.11917421966791153, -0.12014341354370117, -0.11841027438640594, -0.1192820593714714, -0.12780499458312988, -0.11909842491149902, -0.11561687290668488, -0.1138782724738121, -0.11093936115503311, -0.10683437436819077, -0.1064561977982521, -0.1046646311879158, -0.10405193269252777, -0.10701168328523636, -0.11306902021169662, -0.12233191728591919, -0.11767255514860153, -0.12337090820074081, -0.12839637696743011, -0.12969887256622314, -0.12737604975700378, -0.12453096359968185, -0.12659679353237152, -0.13584661483764648, -0.1368074268102646, -0.1637212634086609, -0.1582074910402298, -0.1620120108127594, -0.16499850153923035, -0.1704600304365158, -0.17565488815307617, -0.17961524426937103, -0.1846819967031479, -0.1939704865217209, -0.18974259495735168, -0.3201892673969269, -0.30981314182281494, -0.3160504996776581, -0.32410183548927307, -0.33693739771842957, -0.3522254526615143, -0.3658865690231323, -0.3715808391571045, -0.3754359781742096, -0.3611193895339966, -0.3429493010044098, -0.3341371715068817, -0.34455111622810364, -0.3533167243003845, -0.3652534484863281, -0.3788484036922455, -0.390058308839798, -0.39639273285865784, -0.39872512221336365, -0.3829270303249359, -0.42802444100379944, -0.4260379374027252, -0.4335385262966156, -0.4380180537700653, -0.45003798604011536, -0.4588400423526764, -0.4646936357021332, -0.4681728780269623, -0.4669639766216278, -0.4547315239906311, -0.47627654671669006, -0.47819703817367554, -0.4809967875480652, -0.4801819324493408, -0.4829024374485016, -0.48752325773239136, -0.4900602102279663, -0.48735371232032776, -0.4824097752571106, -0.4798361361026764, -0.47678908705711365, -0.4858919084072113, -0.48597773909568787, -0.4802554249763489, -0.47136250138282776, -0.4694858491420746, -0.47034502029418945, -0.464105486869812, -0.4544256031513214, -0.45790237188339233, -0.4364160895347595, -0.44193559885025024, -0.43728959560394287, -0.4314786195755005, -0.42393702268600464, -0.4184056520462036, -0.4160845875740051, -0.4126853048801422, -0.4076216220855713, -0.41536781191825867, -0.400842547416687, -0.3986366391181946, -0.39430779218673706, -0.38854777812957764, -0.38357117772102356, -0.3802821934223175, -0.379901647567749, -0.38208508491516113, -0.38361144065856934, -0.39189815521240234, -0.3914589285850525, -0.39041537046432495, -0.3906053304672241, -0.38826319575309753, -0.38570353388786316, -0.38508370518684387, -0.38513320684432983, -0.38714221119880676, -0.38812556862831116, -0.38938993215560913, -0.41242700815200806, -0.4083086848258972, -0.4130288362503052, -0.4194999039173126, -0.4275864362716675, -0.4310053288936615, -0.4306805729866028, -0.4345862567424774, -0.4418594539165497, -0.43465644121170044, -0.40650060772895813, -0.3966964781284332, -0.4020009934902191, -0.40999260544776917, -0.42328834533691406, -0.43416160345077515, -0.44274458289146423, -0.45030319690704346, -0.4595653712749481, -0.4474804997444153, -0.5322672128677368, -0.5278232097625732, -0.5331622362136841, -0.5381612181663513, -0.5484880805015564, -0.5624606013298035, -0.5725611448287964, -0.5723485350608826, -0.5671567320823669, -0.5557988286018372, -0.6356889009475708, -0.6315876245498657, -0.6431716680526733, -0.6498777866363525, -0.6577594876289368, -0.6702945828437805, -0.6813141703605652, -0.6844165325164795, -0.6819006204605103, -0.6671537756919861, -0.7049124240875244, -0.7084478139877319, -0.7168745398521423, -0.7240026593208313, -0.7313708662986755, -0.7369573712348938, -0.741470992565155, -0.7398269176483154, -0.7319878935813904, -0.7187924981117249, -0.7249734997749329, -0.7340551614761353, -0.7319876551628113, -0.7314026355743408, -0.7318041324615479, -0.7294543385505676, -0.7275898456573486, -0.7210804224014282, -0.7083900570869446, -0.707425594329834, -0.674045205116272, -0.6905673146247864, -0.6807358860969543, -0.6672201752662659, -0.6545206904411316, -0.6459725499153137, -0.6411502957344055, -0.6324257850646973, -0.618144154548645, -0.6280214190483093, -0.5755621194839478, -0.589549720287323, -0.5735631585121155, -0.5566087365150452, -0.5417721271514893, -0.5328606963157654, -0.5260964632034302, -0.5184115171432495, -0.5074567794799805, -0.5219907760620117, -0.4708912670612335, -0.47948598861694336, -0.46367982029914856, -0.44827985763549805, -0.4372110366821289, -0.42895039916038513, -0.4210028350353241, -0.41675710678100586, -0.41017597913742065, -0.4256698489189148, -0.4000071883201599, -0.4082777500152588, -0.402797669172287, -0.3945893347263336, -0.38841283321380615, -0.38028281927108765, -0.37248772382736206, -0.3707641363143921, -0.3668791949748993, -0.37399351596832275, -0.3648861050605774, -0.36748799681663513, -0.36264491081237793, -0.3618604838848114, -0.36634668707847595, -0.3640997111797333, -0.35706281661987305, -0.3574833571910858, -0.35687899589538574, -0.3559735417366028, -0.4011750817298889, -0.39848342537879944, -0.39450952410697937, -0.3961215615272522, -0.4064144790172577, -0.415242075920105, -0.41774696111679077, -0.41734275221824646, -0.4137188494205475, -0.40711596608161926, -0.3169611394405365, -0.3199279308319092, -0.32011938095092773, -0.32088741660118103, -0.32359087467193604, -0.3289119303226471, -0.3270946145057678, -0.32086706161499023, -0.3098447322845459, -0.3074738085269928, -0.3397194743156433, -0.3464663028717041, -0.34794339537620544, -0.3433430790901184, -0.3373163938522339, -0.3383365869522095, -0.3370622396469116, -0.33322879672050476, -0.3285735249519348, -0.328413188457489, -0.32263821363449097, -0.33349621295928955, -0.32958778738975525, -0.32562047243118286, -0.3170163631439209, -0.31052905321121216, -0.30786386132240295, -0.30374908447265625, -0.2979327142238617, -0.29930514097213745, -0.2865963876247406, -0.2921944856643677, -0.28492340445518494, -0.28514254093170166, -0.2839776873588562, -0.2782427966594696, -0.27835768461227417, -0.27674439549446106, -0.26846936345100403, -0.26850807666778564, -0.25371646881103516, -0.2576770782470703, -0.2541654407978058, -0.25354698300361633, -0.2514672577381134, -0.24787181615829468, -0.248664990067482, -0.24739119410514832, -0.2423495650291443, -0.24295476078987122, -0.23706088960170746, -0.23950287699699402, -0.23501090705394745, -0.23258742690086365, -0.230976864695549, -0.23029495775699615, -0.23024943470954895, -0.22936008870601654, -0.22918701171875, -0.2307482808828354, -0.22791209816932678, -0.22632789611816406, -0.21873655915260315, -0.21375077962875366, -0.21655282378196716, -0.21818438172340393, -0.21499787271022797, -0.21444876492023468, -0.21550357341766357, -0.22121849656105042, -0.22457878291606903, -0.2255510687828064, -0.22392815351486206, -0.21960006654262543, -0.21919944882392883, -0.21574904024600983, -0.2077060043811798, -0.2054402083158493, -0.2081809639930725, -0.2164502739906311, -0.21526415646076202, -0.21569637954235077, -0.21113695204257965, -0.20796288549900055, -0.20876142382621765, -0.20495326817035675, -0.1981821209192276, -0.19927647709846497, -0.20024420320987701, -0.20450782775878906, -0.23843267560005188, -0.23829232156276703, -0.2306978851556778, -0.22870346903800964, -0.23373475670814514, -0.23813629150390625, -0.23590001463890076, -0.2335033118724823, -0.2249884456396103, -0.22461090981960297, -0.23428687453269958, -0.235978364944458, -0.2345566302537918, -0.23541876673698425, -0.23351776599884033, -0.230828195810318, -0.22479519248008728, -0.21906594932079315, -0.214029923081398, -0.21942496299743652, -0.13686081767082214, -0.141640767455101, -0.1404249370098114, -0.13483572006225586, -0.12825758755207062, -0.12262564152479172, -0.11712679266929626, -0.11625177413225174, -0.11849016696214676, -0.1253136247396469, -0.11772236227989197, -0.1210738942027092, -0.11719904094934464, -0.11507070809602737, -0.11136019974946976, -0.10457085818052292, -0.10160181671380997, -0.1035238578915596, -0.10421499609947205, -0.10674337297677994, -0.11811897158622742, -0.11277410387992859, -0.1110253781080246, -0.11891671270132065, -0.1253158003091812, -0.12404568493366241, -0.12558908760547638, -0.13008509576320648, -0.13235393166542053, -0.127523273229599, -0.16332222521305084, -0.15052351355552673, -0.15667983889579773, -0.17071592807769775, -0.17877928912639618, -0.18075090646743774, -0.1872602105140686, -0.19661931693553925, -0.2039535790681839, -0.1952526867389679, -0.24177591502666473, -0.2278403341770172, -0.23602139949798584, -0.24846738576889038, -0.259547621011734, -0.2655501663684845, -0.2723626494407654, -0.2833558917045593, -0.2963103950023651, -0.2856926918029785, -0.3385685980319977, -0.32068705558776855, -0.3234102725982666, -0.3320249915122986, -0.34718817472457886, -0.3581726551055908, -0.36668840050697327, -0.37751615047454834, -0.38977181911468506, -0.3818908929824829, -0.42624807357788086, -0.41238197684288025, -0.4127974510192871, -0.41741448640823364, -0.4283241033554077, -0.4363669753074646, -0.4422912299633026, -0.4491484463214874, -0.4577339291572571, -0.45530256628990173, -0.4817712604999542, -0.47385960817337036, -0.4719805121421814, -0.4738967716693878, -0.4807446002960205, -0.4839438199996948, -0.48533549904823303, -0.4908694326877594, -0.4938269555568695, -0.49214863777160645, -0.4267919659614563, -0.42391061782836914, -0.4194823205471039, -0.42076376080513, -0.4242449700832367, -0.42575064301490784, -0.4239218235015869, -0.4220750331878662, -0.4154067635536194, -0.416476845741272, -0.5125853419303894, -0.5228280425071716, -0.519354522228241, -0.5156859159469604, -0.5071333050727844, -0.49660947918891907, -0.4862942099571228, -0.4742506742477417, -0.46692147850990295, -0.4803580939769745, -0.41942235827445984, -0.42445892095565796, -0.4227546155452728, -0.41663241386413574, -0.4097881317138672, -0.40233445167541504, -0.3956044912338257, -0.39208972454071045, -0.3932672441005707, -0.4046427011489868, -0.4053128957748413, -0.4049130082130432, -0.40297016501426697, -0.40179792046546936, -0.40205031633377075, -0.3968638479709625, -0.3927571177482605, -0.39470118284225464, -0.39762526750564575, -0.4022779166698456, -0.43050816655158997, -0.42246055603027344, -0.4232470691204071, -0.4321835935115814, -0.4425296485424042, -0.4443872570991516, -0.44618064165115356, -0.45246386528015137, -0.45965954661369324, -0.45308738946914673, -0.49611249566078186, -0.4792758822441101, -0.4822230935096741, -0.49495309591293335, -0.5080826282501221, -0.5160122513771057, -0.5238274335861206, -0.5335258841514587, -0.5437701344490051, -0.5344603061676025, -0.5767538547515869, -0.5613611340522766, -0.5689364075660706, -0.5809077620506287, -0.5930805206298828, -0.6034414768218994, -0.6099366545677185, -0.6156356334686279, -0.6246267557144165, -0.6160798072814941, -0.6576700806617737, -0.6404296159744263, -0.6436222791671753, -0.6524901986122131, -0.6657387614250183, -0.679426908493042, -0.6876334547996521, -0.6926917433738708, -0.7010067105293274, -0.694355309009552, -0.7281213998794556, -0.7159558534622192, -0.7119042873382568, -0.7160637974739075, -0.7266241312026978, -0.7353325486183167, -0.7391027212142944, -0.7416109442710876, -0.7476679682731628, -0.7465499043464661, -0.7579745054244995, -0.7563879489898682, -0.7483867406845093, -0.745473325252533, -0.7487121224403381, -0.7486344575881958, -0.742292046546936, -0.739154577255249, -0.7410372495651245, -0.7480032444000244, -0.6848940849304199, -0.6931357383728027, -0.683464527130127, -0.6778410077095032, -0.6731989979743958, -0.6650893688201904, -0.6526495218276978, -0.6406078338623047, -0.6327083706855774, -0.6465581655502319, -0.5249553322792053, -0.544536292552948, -0.5343893766403198, -0.5200774669647217, -0.5019490718841553, -0.48663240671157837, -0.47267642617225647, -0.4560893476009369, -0.44272205233573914, -0.46318352222442627, -0.47193726897239685, -0.4896271526813507, -0.47825977206230164, -0.46239838004112244, -0.4436480700969696, -0.4265877306461334, -0.41251471638679504, -0.3989783823490143, -0.38970035314559937, -0.4137754440307617, -0.37924516201019287, -0.3903525769710541, -0.3834666609764099, -0.3743407428264618, -0.36112263798713684, -0.345477819442749, -0.33513742685317993, -0.32885119318962097, -0.3255159258842468, -0.3423997461795807, -0.3384416401386261, -0.3366250693798065, -0.3340670168399811, -0.33560827374458313, -0.3337792456150055, -0.32873135805130005, -0.3299151062965393, -0.33442234992980957, -0.3361944556236267, -0.3368164896965027, -0.34742897748947144, -0.3364311158657074, -0.3348855674266815, -0.33977973461151123, -0.34562811255455017, -0.3506215512752533, -0.3576866686344147, -0.3643185496330261, -0.36890536546707153, -0.36502984166145325, -0.37979573011398315, -0.3717457950115204, -0.37653860449790955, -0.383242666721344, -0.38970205187797546, -0.39633339643478394, -0.39997878670692444, -0.40181973576545715, -0.4036698639392853, -0.39862775802612305, -0.40593597292900085, -0.4000208377838135, -0.4021030068397522, -0.4062632918357849, -0.41000425815582275, -0.4152242839336395, -0.4160575270652771, -0.4148111939430237, -0.41720134019851685, -0.4158981740474701, -0.42333537340164185, -0.42321598529815674, -0.41989049315452576, -0.419466495513916, -0.41791024804115295, -0.41706767678260803, -0.4138612449169159, -0.4086519181728363, -0.40955260396003723, -0.4150257706642151, -0.40745559334754944, -0.40730398893356323, -0.4026482403278351, -0.3981177508831024, -0.3962997794151306, -0.39535194635391235, -0.38822799921035767, -0.38357287645339966, -0.3874538242816925, -0.39664268493652344, -0.43741634488105774, -0.4455743134021759, -0.4383990466594696, -0.4297291934490204, -0.42220139503479004, -0.41551974415779114, -0.4049021899700165, -0.39582163095474243, -0.39244961738586426, -0.40500396490097046] ))

    def test_3DImg_with_pad(self):
        return_new = fu.filt_gaussl(IMAGE_3D,sigma= 0.23, pad=True )
        return_old = oldfu.filt_gaussl(IMAGE_3D,sigma= 0.23, pad=True )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview().flatten(), [-0.23205262422561646, -0.20199142396450043, -0.20257334411144257, -0.20208442211151123, -0.20207519829273224, -0.20090104639530182, -0.2010726034641266, -0.19947843253612518, -0.1964445412158966, -0.22673694789409637, -0.1933843493461609, -0.15394288301467896, -0.15504498779773712, -0.1568550169467926, -0.15798276662826538, -0.15519006550312042, -0.15482895076274872, -0.1521577090024948, -0.1512966752052307, -0.19595134258270264, -0.1979748159646988, -0.15682128071784973, -0.15404780209064484, -0.151466503739357, -0.14795222878456116, -0.14501969516277313, -0.1457826942205429, -0.14656396210193634, -0.15369127690792084, -0.2024582028388977, -0.21031998097896576, -0.1714814156293869, -0.17039433121681213, -0.16930530965328217, -0.1646033674478531, -0.16486288607120514, -0.17429758608341217, -0.1851179301738739, -0.19467957317829132, -0.23290322721004486, -0.24857346713542938, -0.22460807859897614, -0.22951777279376984, -0.23334193229675293, -0.23616978526115417, -0.24397818744182587, -0.2548864185810089, -0.264637291431427, -0.2724878489971161, -0.29365274310112, -0.30551862716674805, -0.3018640875816345, -0.3128858208656311, -0.3193877935409546, -0.3261915445327759, -0.3336597979068756, -0.33934447169303894, -0.3478318750858307, -0.35744208097457886, -0.3603969216346741, -0.3772070109844208, -0.39480113983154297, -0.40668222308158875, -0.41520315408706665, -0.42144954204559326, -0.42538154125213623, -0.42856645584106445, -0.43548429012298584, -0.44726288318634033, -0.4318363666534424, -0.4481644034385681, -0.4815642535686493, -0.4908721446990967, -0.4973941445350647, -0.4991941750049591, -0.5003542900085449, -0.5034566521644592, -0.5048683285713196, -0.5103857517242432, -0.47973814606666565, -0.483419269323349, -0.5205800533294678, -0.5232401490211487, -0.52476966381073, -0.5239099264144897, -0.5221382975578308, -0.5202232599258423, -0.5187917947769165, -0.5218896865844727, -0.4885145425796509, -0.46253085136413574, -0.4940471947193146, -0.4945267140865326, -0.49254241585731506, -0.4861496686935425, -0.4798375964164734, -0.47457993030548096, -0.47030213475227356, -0.4700717628002167, -0.4436586797237396, -0.37759697437286377, -0.38805511593818665, -0.38447853922843933, -0.38214385509490967, -0.3815569281578064, -0.38121673464775085, -0.38415589928627014, -0.38429972529411316, -0.38084545731544495, -0.3692348301410675, -0.37258732318878174, -0.3794940114021301, -0.37333840131759644, -0.3694647252559662, -0.372467041015625, -0.3754681348800659, -0.37880611419677734, -0.38029715418815613, -0.38360142707824707, -0.37823790311813354, -0.3779696524143219, -0.3862555921077728, -0.37880998849868774, -0.3692200481891632, -0.36638298630714417, -0.36769217252731323, -0.3683644235134125, -0.3697304427623749, -0.37849491834640503, -0.3780117332935333, -0.385638952255249, -0.3982069790363312, -0.3965458869934082, -0.39460307359695435, -0.3953431248664856, -0.40030911564826965, -0.4066121280193329, -0.4152584969997406, -0.4263044595718384, -0.41437482833862305, -0.42582595348358154, -0.4531744122505188, -0.4610918164253235, -0.46905991435050964, -0.4778326451778412, -0.487833172082901, -0.4975530207157135, -0.5057152509689331, -0.5133606195449829, -0.48195797204971313, -0.49291494488716125, -0.5392917990684509, -0.5488813519477844, -0.5564247965812683, -0.5642905831336975, -0.5728027820587158, -0.5805920362472534, -0.5891072154045105, -0.5988011956214905, -0.550220251083374, -0.5659317374229431, -0.6316733956336975, -0.6392186880111694, -0.6450067758560181, -0.6470755338668823, -0.6483752131462097, -0.654080867767334, -0.6645798087120056, -0.6776648759841919, -0.6127889752388, -0.6288267970085144, -0.7123820781707764, -0.7191351652145386, -0.7222087383270264, -0.7159361839294434, -0.7081515192985535, -0.7058927416801453, -0.7034883499145508, -0.70476895570755, -0.6297864317893982, -0.6315385103225708, -0.7114549875259399, -0.7127847075462341, -0.7103246450424194, -0.6998082399368286, -0.6899290680885315, -0.6816838383674622, -0.6700840592384338, -0.6633641719818115, -0.5940319895744324, -0.5506290793418884, -0.6051682829856873, -0.6023457050323486, -0.597530722618103, -0.5868259072303772, -0.5765356421470642, -0.5674239993095398, -0.5565487146377563, -0.5484443306922913, -0.5008902549743652, -0.448047935962677, -0.4710073471069336, -0.4605187475681305, -0.45242780447006226, -0.4456918239593506, -0.4453365206718445, -0.44754770398139954, -0.4448223412036896, -0.4358356297016144, -0.4069122076034546, -0.4283364415168762, -0.4446983337402344, -0.4286062717437744, -0.4139031171798706, -0.4054378271102905, -0.40272653102874756, -0.4041566252708435, -0.4067595899105072, -0.40831902623176575, -0.39252158999443054, -0.38904768228530884, -0.3993561863899231, -0.3869224190711975, -0.3711082637310028, -0.36178866028785706, -0.35796886682510376, -0.35586172342300415, -0.35550349950790405, -0.3594816029071808, -0.35866451263427734, -0.35758790373802185, -0.35734236240386963, -0.34971627593040466, -0.3431377112865448, -0.33995071053504944, -0.3415378928184509, -0.3419102728366852, -0.342298299074173, -0.3434749245643616, -0.34378400444984436, -0.33999669551849365, -0.3387763798236847, -0.34065499901771545, -0.3433097004890442, -0.34543728828430176, -0.34804749488830566, -0.34947726130485535, -0.34905847907066345, -0.34589338302612305, -0.34344571828842163, -0.34243425726890564, -0.343426376581192, -0.3430546820163727, -0.3409532904624939, -0.34090089797973633, -0.3408571779727936, -0.3393971621990204, -0.33791646361351013, -0.33588549494743347, -0.33739519119262695, -0.3373491168022156, -0.33328482508659363, -0.32753899693489075, -0.3197040259838104, -0.31354671716690063, -0.31057196855545044, -0.30927297472953796, -0.3099534213542938, -0.3128044903278351, -0.3213554322719574, -0.3238748013973236, -0.3159831762313843, -0.31208762526512146, -0.30677810311317444, -0.29753121733665466, -0.2887704074382782, -0.28323787450790405, -0.27946996688842773, -0.2789680063724518, -0.2940436005592346, -0.2912691533565521, -0.27591297030448914, -0.27805233001708984, -0.27685871720314026, -0.2694738507270813, -0.26223260164260864, -0.2551504075527191, -0.24740636348724365, -0.24475793540477753, -0.26756802201271057, -0.2858968675136566, -0.2708998918533325, -0.27257245779037476, -0.27147701382637024, -0.2693476676940918, -0.26710236072540283, -0.2627464234828949, -0.25749316811561584, -0.25694024562835693, -0.2778085470199585, -0.2669922709465027, -0.24404767155647278, -0.24142079055309296, -0.24042677879333496, -0.23860876262187958, -0.24386560916900635, -0.24945780634880066, -0.2512858211994171, -0.2498934119939804, -0.26459845900535583, -0.24459512531757355, -0.21631485223770142, -0.2132342904806137, -0.2097611427307129, -0.2071618139743805, -0.20909367501735687, -0.2129833847284317, -0.217646986246109, -0.22018632292747498, -0.24370010197162628, -0.24863074719905853, -0.22536438703536987, -0.2197360098361969, -0.21049334108829498, -0.20867066085338593, -0.20970968902111053, -0.21133045852184296, -0.21246302127838135, -0.214210644364357, -0.24398232996463776, -0.2430732250213623, -0.21284328401088715, -0.2078889012336731, -0.20068784058094025, -0.19596382975578308, -0.19938084483146667, -0.2032346874475479, -0.2016333043575287, -0.20056533813476562, -0.23312199115753174, -0.22698359191417694, -0.19257549941539764, -0.1921464055776596, -0.18832100927829742, -0.1809639185667038, -0.18293339014053345, -0.18619228899478912, -0.18316033482551575, -0.17841732501983643, -0.21261854469776154, -0.20490425825119019, -0.16514146327972412, -0.16196614503860474, -0.15758293867111206, -0.1536729633808136, -0.15223917365074158, -0.15134195983409882, -0.14801025390625, -0.1451307088136673, -0.18923404812812805, -0.18208248913288116, -0.1324772834777832, -0.12736496329307556, -0.12011045217514038, -0.1165391057729721, -0.11813008785247803, -0.11888089030981064, -0.11780403554439545, -0.11900648474693298, -0.17172499001026154, -0.16975153982639313, -0.1155947595834732, -0.11343515664339066, -0.10962638258934021, -0.10581619292497635, -0.10525725036859512, -0.10316334664821625, -0.10326839983463287, -0.10669616609811783, -0.16013188660144806, -0.16524794697761536, -0.11748056858778, -0.12283292412757874, -0.127162903547287, -0.12866827845573425, -0.1263718158006668, -0.12315691262483597, -0.12600789964199066, -0.135575532913208, -0.1859412044286728, -0.21484313905239105, -0.18494513630867004, -0.18918880820274353, -0.1921808272600174, -0.19812516868114471, -0.2014032006263733, -0.2031252682209015, -0.209080308675766, -0.21967139840126038, -0.2539796233177185, -0.2933211624622345, -0.28420504927635193, -0.2891674041748047, -0.29572823643684387, -0.3056644797325134, -0.31845876574516296, -0.3294171094894409, -0.33289292454719543, -0.33390262722969055, -0.33687499165534973, -0.3294803202152252, -0.332497239112854, -0.3428848683834076, -0.35194727778434753, -0.3636157810688019, -0.37740200757980347, -0.3884718120098114, -0.3949907720088959, -0.39718514680862427, -0.3860120475292206, -0.3996841311454773, -0.4239563047885895, -0.4315795600414276, -0.4365825355052948, -0.4483507573604584, -0.45724016427993774, -0.4630504250526428, -0.46637582778930664, -0.4649922847747803, -0.4381791651248932, -0.44547590613365173, -0.4771665036678314, -0.48017367720603943, -0.4798808693885803, -0.48240160942077637, -0.4870891273021698, -0.4898534119129181, -0.4867902398109436, -0.4816645085811615, -0.4512213468551636, -0.452722430229187, -0.4846631586551666, -0.4849894642829895, -0.4796430468559265, -0.47072383761405945, -0.46880826354026794, -0.4699031114578247, -0.46312615275382996, -0.4532114267349243, -0.426645964384079, -0.42253929376602173, -0.4418502151966095, -0.43740424513816833, -0.4318268299102783, -0.4242657423019409, -0.4186859428882599, -0.4165404140949249, -0.41273030638694763, -0.4075529873371124, -0.39328527450561523, -0.3904975950717926, -0.3984244465827942, -0.3942154049873352, -0.3886544704437256, -0.3837229907512665, -0.3804413080215454, -0.38017427921295166, -0.382061243057251, -0.383552610874176, -0.37824907898902893, -0.38262736797332764, -0.3912634253501892, -0.391582727432251, -0.38941192626953125, -0.3868260681629181, -0.3862159252166748, -0.38635435700416565, -0.3881687819957733, -0.3891957104206085, -0.37933409214019775, -0.39121097326278687, -0.4090852737426758, -0.41389593482017517, -0.42073965072631836, -0.4286157488822937, -0.4320873022079468, -0.43169164657592773, -0.4354349672794342, -0.44249728322029114, -0.422858327627182, -0.39819028973579407, -0.4184802770614624, -0.4231230616569519, -0.4301568269729614, -0.44002535939216614, -0.4474136233329773, -0.452602356672287, -0.45953369140625, -0.46865370869636536, -0.44544821977615356, -0.4828588366508484, -0.5272529721260071, -0.5343824625015259, -0.5403003096580505, -0.5478941202163696, -0.5592836141586304, -0.5682594180107117, -0.5674777626991272, -0.562785267829895, -0.5151292085647583, -0.5625557899475098, -0.6314874887466431, -0.643602728843689, -0.651556670665741, -0.6587612628936768, -0.6714443564414978, -0.6827822923660278, -0.6850454807281494, -0.6819483041763306, -0.6074115037918091, -0.622677743434906, -0.708369791507721, -0.7174338102340698, -0.7258980870246887, -0.7326951622962952, -0.7382904291152954, -0.7431507706642151, -0.7403050065040588, -0.7317352890968323, -0.6422778367996216, -0.64769047498703, -0.7335696220397949, -0.7321674227714539, -0.7327558994293213, -0.7327008247375488, -0.7303289175033569, -0.7290552258491516, -0.7211478352546692, -0.7077687978744507, -0.6230466365814209, -0.617043673992157, -0.6905187368392944, -0.6812263131141663, -0.6684510707855225, -0.6555014252662659, -0.6467037200927734, -0.6424607038497925, -0.6323844194412231, -0.6176013946533203, -0.5518400073051453, -0.5420845150947571, -0.5890800356864929, -0.5734385251998901, -0.5568114519119263, -0.5418849587440491, -0.532745897769928, -0.526572585105896, -0.5178985595703125, -0.5066628456115723, -0.46577996015548706, -0.45765697956085205, -0.47976991534233093, -0.4640845060348511, -0.44876912236213684, -0.43772605061531067, -0.42924848198890686, -0.4216543734073639, -0.416756808757782, -0.40998297929763794, -0.3932165801525116, -0.39542195200920105, -0.4073786437511444, -0.40196511149406433, -0.3936900198459625, -0.38746708631515503, -0.37914690375328064, -0.37153738737106323, -0.369536817073822, -0.365632563829422, -0.35821592807769775, -0.36258310079574585, -0.36617934703826904, -0.3613310754299164, -0.3604753017425537, -0.3649352788925171, -0.3625108301639557, -0.35543742775917053, -0.35570836067199707, -0.3550240397453308, -0.348936527967453, -0.35026106238365173, -0.3493851125240326, -0.34388354420661926, -0.3440053462982178, -0.35164105892181396, -0.35738688707351685, -0.3577713966369629, -0.3582051694393158, -0.3564739227294922, -0.35056450963020325, -0.34844258427619934, -0.35071396827697754, -0.3537711203098297, -0.35580408573150635, -0.3570273816585541, -0.36015838384628296, -0.35801801085472107, -0.35230743885040283, -0.3434861898422241, -0.33998510241508484, -0.3435259163379669, -0.3452852964401245, -0.3468225300312042, -0.34211021661758423, -0.3361228108406067, -0.33711478114128113, -0.3359093964099884, -0.33200064301490784, -0.32736799120903015, -0.3273997902870178, -0.33434996008872986, -0.3324025571346283, -0.328535795211792, -0.3243102729320526, -0.3158375322818756, -0.30912989377975464, -0.3064775764942169, -0.3024120628833771, -0.2967226207256317, -0.3010239899158478, -0.3037615716457367, -0.2905055582523346, -0.28311634063720703, -0.2829626500606537, -0.28197625279426575, -0.27621719241142273, -0.2763795256614685, -0.2749629020690918, -0.2667897045612335, -0.278047651052475, -0.27611809968948364, -0.2569148540496826, -0.2532975673675537, -0.2523477375507355, -0.25048956274986267, -0.2468346357345581, -0.24751824140548706, -0.24653635919094086, -0.24162445962429047, -0.2610473036766052, -0.26144298911094666, -0.23870670795440674, -0.23409561812877655, -0.2312781661748886, -0.2298775315284729, -0.22923997044563293, -0.22904616594314575, -0.22852522134780884, -0.22851695120334625, -0.2531020939350128, -0.25461089611053467, -0.22638148069381714, -0.21862170100212097, -0.2133040577173233, -0.2163221687078476, -0.2179374247789383, -0.21451377868652344, -0.21430566906929016, -0.2155449539422989, -0.2457299828529358, -0.2522973120212555, -0.2254592627286911, -0.22361110150814056, -0.21881921589374542, -0.21867069602012634, -0.21529941260814667, -0.2072136551141739, -0.20535922050476074, -0.20848245918750763, -0.24174770712852478, -0.2471693754196167, -0.21645328402519226, -0.21167536079883575, -0.20802420377731323, -0.20909442007541656, -0.2052062600851059, -0.19829076528549194, -0.19976356625556946, -0.20105703175067902, -0.2316494584083557, -0.2638096511363983, -0.23531803488731384, -0.22654423117637634, -0.2225799262523651, -0.2268451303243637, -0.23052416741847992, -0.22925794124603271, -0.22933951020240784, -0.22450387477874756, -0.2466403990983963, -0.2355337142944336, -0.20355746150016785, -0.2035626471042633, -0.20428265631198883, -0.20154239237308502, -0.1977412849664688, -0.19157962501049042, -0.1873612105846405, -0.18503162264823914, -0.21993616223335266, -0.18710273504257202, -0.1445235013961792, -0.14295367896556854, -0.13656222820281982, -0.13032189011573792, -0.12473689764738083, -0.11899970471858978, -0.11877821385860443, -0.12144041806459427, -0.17165814340114594, -0.17267119884490967, -0.12407077103853226, -0.11987496167421341, -0.11691311001777649, -0.11361702531576157, -0.10680630058050156, -0.10358542948961258, -0.10629218071699142, -0.10735560953617096, -0.15714560449123383, -0.16744709014892578, -0.11672262847423553, -0.1146068200469017, -0.12173587828874588, -0.12844803929328918, -0.12728489935398102, -0.12842147052288055, -0.13362328708171844, -0.13620728254318237, -0.18023207783699036, -0.19443298876285553, -0.15315720438957214, -0.15894527733325958, -0.17263217270374298, -0.18069735169410706, -0.1827707439661026, -0.1888573318719864, -0.19901670515537262, -0.20657983422279358, -0.23937538266181946, -0.25186821818351746, -0.23036924004554749, -0.23823243379592896, -0.25060519576072693, -0.26153239607810974, -0.2677692770957947, -0.2742917835712433, -0.2858540117740631, -0.2988933324813843, -0.3142896890640259, -0.32641181349754333, -0.3216150104999542, -0.32419002056121826, -0.3331807553768158, -0.34801506996154785, -0.35914117097854614, -0.3675113320350647, -0.37860462069511414, -0.3907020390033722, -0.3878117501735687, -0.3995242416858673, -0.41368305683135986, -0.4141315817832947, -0.41919147968292236, -0.42973756790161133, -0.4378889799118042, -0.4437808692455292, -0.4504695534706116, -0.45885488390922546, -0.44096773862838745, -0.44906923174858093, -0.47449809312820435, -0.4727988839149475, -0.47531184554100037, -0.48182743787765503, -0.48496347665786743, -0.4865192174911499, -0.4916197955608368, -0.49422532320022583, -0.46298015117645264, -0.4413129985332489, -0.4621924161911011, -0.45773640275001526, -0.4578354060649872, -0.46177229285240173, -0.4644804894924164, -0.4647466242313385, -0.4642319679260254, -0.45909038186073303, -0.4311719834804535, -0.4135725200176239, -0.43307173252105713, -0.4328562915325165, -0.4312490224838257, -0.4238896667957306, -0.4154365360736847, -0.4088599681854248, -0.40004441142082214, -0.39522311091423035, -0.38562941551208496, -0.40506577491760254, -0.42237019538879395, -0.42071977257728577, -0.41476690769195557, -0.4078144133090973, -0.40030455589294434, -0.39369553327560425, -0.3898570239543915, -0.3908778429031372, -0.38531559705734253, -0.3909253478050232, -0.40286505222320557, -0.401030033826828, -0.4001035690307617, -0.4002557694911957, -0.3950534164905548, -0.3910875916481018, -0.3929268717765808, -0.3958223760128021, -0.387287437915802, -0.40408429503440857, -0.42171379923820496, -0.42260506749153137, -0.4320123791694641, -0.442120760679245, -0.4440287947654724, -0.4457418918609619, -0.45176249742507935, -0.4586300253868103, -0.4357566833496094, -0.44917330145835876, -0.4769698977470398, -0.4801586866378784, -0.49377158284187317, -0.5065010786056519, -0.5145682692527771, -0.5223873853683472, -0.5317087173461914, -0.5415164232254028, -0.5030893087387085, -0.5118110775947571, -0.5590435266494751, -0.5669934153556824, -0.5800772905349731, -0.5917057991027832, -0.6021811366081238, -0.6087052226066589, -0.613638162612915, -0.6220588088035583, -0.5670592188835144, -0.5752713084220886, -0.6371493339538574, -0.6408289074897766, -0.6510681509971619, -0.6636567711830139, -0.6774659752845764, -0.685894787311554, -0.6899301409721375, -0.6975703239440918, -0.626700758934021, -0.635499894618988, -0.7118597030639648, -0.7083981037139893, -0.7140086889266968, -0.7240115404129028, -0.7329092025756836, -0.7371237277984619, -0.7383851408958435, -0.7437998652458191, -0.6617279052734375, -0.6676791310310364, -0.7519532442092896, -0.7446496486663818, -0.7431593537330627, -0.7459729909896851, -0.7459862232208252, -0.7403697967529297, -0.735850989818573, -0.7370743751525879, -0.6539939045906067, -0.598231852054596, -0.6620401740074158, -0.6530230641365051, -0.648164689540863, -0.6455731987953186, -0.6402093768119812, -0.6303332448005676, -0.620048463344574, -0.6140168905258179, -0.554103434085846, -0.5440199971199036, -0.5958273410797119, -0.5873593091964722, -0.574995756149292, -0.5580819845199585, -0.5443927645683289, -0.5334755778312683, -0.518623948097229, -0.5073394775390625, -0.46991634368896484, -0.5278677344322205, -0.573922336101532, -0.5623740553855896, -0.5462299585342407, -0.5282361507415771, -0.513038158416748, -0.5001920461654663, -0.4874495565891266, -0.4790011942386627, -0.4500247538089752, -0.4517354965209961, -0.4793705940246582, -0.4731847047805786, -0.4642597436904907, -0.4529494345188141, -0.4392557442188263, -0.42915093898773193, -0.4224841296672821, -0.41728925704956055, -0.40115606784820557, -0.4075644910335541, -0.4239859879016876, -0.4220772385597229, -0.42400863766670227, -0.42453163862228394, -0.4202750325202942, -0.41844072937965393, -0.4195341169834137, -0.4189731776714325, -0.4010012745857239, -0.3997851610183716, -0.41085025668144226, -0.408282607793808, -0.4126162827014923, -0.41823703050613403, -0.4215523600578308, -0.42548975348472595, -0.42933130264282227, -0.4321293234825134, -0.41367432475090027, -0.4098515212535858, -0.42515069246292114, -0.4265649616718292, -0.43200647830963135, -0.43656057119369507, -0.4415619671344757, -0.4443839192390442, -0.4441302716732025, -0.44357946515083313, -0.4222995638847351, -0.41477170586586, -0.4292895197868347, -0.42767050862312317, -0.4296879172325134, -0.43113183975219727, -0.4351654648780823, -0.4359598457813263, -0.43333494663238525, -0.43251901865005493, -0.41326817870140076, -0.412925660610199, -0.42751288414001465, -0.42167696356773376, -0.4194228947162628, -0.4163636565208435, -0.4140184223651886, -0.40949249267578125, -0.40324661135673523, -0.4018295109272003, -0.3887462317943573, -0.3875454366207123, -0.3963559865951538, -0.39073264598846436, -0.38528984785079956, -0.382303923368454, -0.38053563237190247, -0.3732328414916992, -0.367439866065979, -0.36898675560951233, -0.3646416962146759, -0.36364880204200745, -0.3656448721885681, -0.35989415645599365, -0.35488125681877136, -0.35364845395088196, -0.3519926965236664, -0.3459988832473755, -0.342074990272522, -0.3415548503398895, -0.3413810133934021]))

    def test_3DImgBlank_without_pad(self):
        return_new = fu.filt_gaussl(IMAGE_BLANK_3D,sigma= 0.23, pad=False )
        return_old = oldfu.filt_gaussl(IMAGE_BLANK_3D,sigma= 0.23, pad=False )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview(), IMAGE_BLANK_3D.get_3dview()))

    def test_3DImgBlank_with_pad(self):
        return_new = fu.filt_gaussl(IMAGE_BLANK_3D,sigma= 0.23, pad=True )
        return_old = oldfu.filt_gaussl(IMAGE_BLANK_3D,sigma= 0.23, pad=True )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview(), IMAGE_BLANK_3D.get_3dview()))


class Test_filt_gaussinv(unittest.TestCase):
    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_gaussinv()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_gaussinv()
        self.assertEqual(str(cm_new.exception), "filt_gaussinv() takes at least 2 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError) as cm_new:
            fu.filt_gaussinv(EMData(), sigma=0.23)
        with self.assertRaises(RuntimeError) as cm_old:
            oldfu.filt_gaussinv(EMData(), sigma=0.23)
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_NoneType_Img(self):
        return_new =  fu.filt_gaussinv(None,sigma= 0.23, pad=False )
        return_old = oldfu.filt_gaussinv(None,sigma= 0.23, pad=False )
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_2DImg_without_pad(self):
        return_new = fu.filt_gaussinv(IMAGE_2D,sigma= 0.23, pad=False )
        return_old = oldfu.filt_gaussinv(IMAGE_2D,sigma= 0.23, pad=False )
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview().flatten(), [0.45262575149536133, 0.5768970847129822, 0.5531002879142761, 0.6785516142845154, 0.6042968034744263, 0.31882089376449585, 0.5883294343948364, 0.5100200772285461, 0.5304109454154968, 0.4359275996685028, -0.2261962890625, -0.16902823746204376, -0.3123248517513275, -0.2982003390789032, -0.40521910786628723, 0.08208223432302475, -0.3231307864189148, -0.2265091985464096, -0.18016719818115234, 0.010418090969324112, 0.42804259061813354, 0.0641087219119072, 0.45431262254714966, 0.24034371972084045, 0.42325595021247864, -0.008572673425078392, 0.3440161943435669, 0.3692653179168701, 0.37193113565444946, -0.09308040142059326, -0.33330991864204407, 0.23524197936058044, -0.2661950886249542, 0.013958816416561604, -0.16407380998134613, 0.39720427989959717, -0.11012826859951019, -0.046704232692718506, -0.19944074749946594, 0.33897489309310913, 0.5617084503173828, -0.23964466154575348, 0.5175716280937195, -0.05820592865347862, 0.39529696106910706, -0.2982371747493744, 0.23204348981380463, -0.054929062724113464, 0.3356565833091736, -0.5047627687454224, -0.40446287393569946, 0.053085699677467346, -0.566263735294342, -0.12938284873962402, -0.4145878255367279, 0.01624280959367752, -0.3348883092403412, -0.24355122447013855, -0.3831919729709625, 0.0499538779258728, 0.4641338586807251, -0.39392009377479553, 0.3165914714336395, -0.19444185495376587, 0.12922076880931854, -0.4730393588542938, 0.19869941473007202, -0.23827022314071655, 0.1516210287809372, -0.7053251266479492, -0.7803490161895752, -0.37237438559532166, -0.8582987189292908, -0.5740319490432739, -0.7623782157897949, -0.22006669640541077, -0.9514382481575012, -0.4072047472000122, -0.8197686672210693, -0.23559096455574036, 0.23516704142093658, -0.20683753490447998, 0.2000838816165924, -0.029528627172112465, 0.09387044608592987, -0.4742232859134674, 0.26148906350135803, -0.41658297181129456, 0.19572409987449646, -0.7313680052757263, -1.1932495832443237, -0.8981632590293884, -1.2247973680496216, -1.0797088146209717, -1.1308889389038086, -0.6720301508903503, -1.1926982402801514, -0.7214475274085999, -1.157007098197937, -0.5729562640190125]))

    def test_2DImg_with_pad(self):
        return_new = fu.filt_gaussinv(IMAGE_2D,sigma= 0.23, pad=True )
        return_old = oldfu.filt_gaussinv(IMAGE_2D,sigma= 0.23, pad=True )
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview().flatten(), [0.3655117452144623, 0.160753071308136, 0.19166792929172516, 0.302569180727005, 0.24998542666435242, 0.14923034608364105, 0.14606045186519623, 0.41024816036224365, 0.00230967509560287, 0.6197155117988586, 0.20866218209266663, -0.13790956139564514, -0.017925461754202843, -0.14898186922073364, -0.18817096948623657, 0.15733575820922852, -0.10678524523973465, -0.10934371501207352, -0.03398965671658516, 0.20595598220825195, 0.4389292001724243, -0.07644972950220108, 0.32365211844444275, 0.1287827342748642, 0.27884313464164734, -0.017537737265229225, 0.14984402060508728, 0.39807093143463135, 0.08252570778131485, 0.20020854473114014, 0.08351690322160721, 0.1295960545539856, -0.06411267817020416, 0.036360111087560654, -0.029752396047115326, 0.39445793628692627, 0.006547031458467245, 0.0009858417324721813, -0.134884774684906, 0.4485468864440918, 0.4423190653324127, -0.24456344544887543, 0.38810116052627563, -0.08246559649705887, 0.2677111029624939, -0.25720638036727905, 0.07478515058755875, 0.007981309667229652, 0.08751124888658524, -0.19710499048233032, -0.22937467694282532, 0.035665273666381836, -0.44557830691337585, -0.09747371822595596, -0.3120240271091461, 0.0048720454797148705, -0.23317988216876984, -0.22650481760501862, -0.2788636386394501, 0.01906999573111534, 0.20345255732536316, -0.3320469856262207, 0.1613970845937729, -0.20381729304790497, -0.00457810377702117, -0.43655797839164734, 0.06126280501484871, -0.21739055216312408, -0.03304087370634079, -0.5312901735305786, -0.8643596172332764, -0.24692031741142273, -0.7839536666870117, -0.4933319687843323, -0.6419053673744202, -0.23062896728515625, -0.8016420602798462, -0.42536887526512146, -0.5662639737129211, -0.5302684307098389, -0.17483162879943848, -0.1524597704410553, -0.014983654022216797, -0.09823411703109741, -0.0911780372262001, -0.495481938123703, 0.111320361495018, -0.5244719386100769, 0.06993483752012253, -0.8234034776687622, -1.4371017217636108, -0.5051594376564026, -1.1211860179901123, -0.8053766489028931, -0.8929319381713867, -0.5767344832420349, -0.913802444934845, -0.6188921332359314, -0.6950093507766724, -0.9424852728843689]))

    def test_2DImgBlank_without_pad(self):
        return_new = fu.filt_gaussinv(IMAGE_BLANK_2D,sigma= 0.23, pad=False )
        return_old = oldfu.filt_gaussinv(IMAGE_BLANK_2D,sigma= 0.23, pad=False )
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview(), IMAGE_BLANK_2D.get_2dview()))

    def test_2DImgBlank_with_pad(self):
        return_new = fu.filt_gaussinv(IMAGE_BLANK_2D,sigma= 0.23, pad=True )
        return_old = oldfu.filt_gaussinv(IMAGE_BLANK_2D,sigma= 0.23, pad=True )
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview(), IMAGE_BLANK_2D.get_2dview()))

    def test_3DImg_without_pad(self):
        return_new = fu.filt_gaussinv(IMAGE_3D,sigma= 0.23, pad=False )
        return_old = oldfu.filt_gaussinv(IMAGE_3D,sigma= 0.23, pad=False )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_new.get_3dview().flatten(), [4.358497142791748, 4.150956630706787, 4.08411979675293, 4.3806562423706055, 3.2932040691375732, 2.519829750061035, 3.540926933288574, 2.56312894821167, 3.7164146900177, 2.542010545730591, -0.6538330316543579, 0.09464554488658905, -0.5462655425071716, -0.194256991147995, 0.0280838031321764, 1.364084005355835, 0.01699020527303219, 0.6485134363174438, 0.25287574529647827, 1.3792635202407837, 3.7235612869262695, 1.4488110542297363, 3.250392436981201, 1.688694715499878, 2.2335307598114014, 0.6697651743888855, 2.0822672843933105, 1.6604862213134766, 2.0817065238952637, -0.15467578172683716, -1.4272024631500244, 1.6011592149734497, -0.6490747332572937, 1.1063755750656128, 0.4508305788040161, 2.3571441173553467, 0.5554294586181641, 1.007419228553772, 0.23466730117797852, 2.4695541858673096, 3.6297037601470947, -0.0871431902050972, 2.9626996517181396, 0.4755823016166687, 1.6998809576034546, -0.3826119601726532, 1.3685048818588257, 0.39140456914901733, 1.9143480062484741, -0.9690380692481995, -1.0993088483810425, 1.1021881103515625, -1.1717486381530762, 0.5166670083999634, -0.06904895603656769, 1.0505540370941162, 0.0902526006102562, 0.4218798279762268, -0.2897090017795563, 1.293203353881836, 2.5095560550689697, -0.3876453936100006, 1.678127408027649, 0.28245192766189575, 0.6598072052001953, -0.547799825668335, 1.1030219793319702, 0.31778115034103394, 1.3444429636001587, -0.640400230884552, -1.14214289188385, -0.2824602723121643, -1.3277254104614258, -0.7373857498168945, -0.7283359169960022, -0.002818298526108265, -1.6469453573226929, -0.45823776721954346, -1.623731255531311, -0.838344931602478, 1.9921377897262573, 0.4043664038181305, 1.6735320091247559, 0.9607619643211365, 0.8118382096290588, -0.5580400824546814, 1.5953785181045532, -0.8720784187316895, 1.7595540285110474, -1.2469229698181152, -3.9799482822418213, -3.2372677326202393, -4.01227331161499, -3.8101933002471924, -3.165562152862549, -2.1568925380706787, -3.686366319656372, -1.721175193786621, -3.6908559799194336, -2.1295053958892822, -0.06539618223905563, -1.9335908889770508, -0.4757586717605591, -1.449454665184021, -0.0015596314333379269, -0.01723773218691349, -0.375846266746521, -0.2549591362476349, -0.8277685046195984, -1.3497647047042847, -0.5418170690536499, -1.235833764076233, -1.130818247795105, -1.641550064086914, -2.084322452545166, -2.843555212020874, -2.0004191398620605, -2.4472944736480713, -1.7353739738464355, -2.9833908081054688, -2.9169068336486816, -1.2769719362258911, -2.2902371883392334, -0.7991743683815002, -1.1722137928009033, -0.3984132409095764, -1.240470051765442, -0.9687489867210388, -1.388169288635254, 0.14432629942893982, 0.43572816252708435, -2.4692625999450684, -0.6436928510665894, -2.447849750518799, -1.7340366840362549, -3.0032427310943604, -1.7760066986083984, -2.1746666431427, -1.4357695579528809, -3.5876309871673584, -2.8276102542877197, -0.9772220849990845, -2.4903669357299805, -0.9891308546066284, -1.4274241924285889, -0.6718279123306274, -1.4240902662277222, -1.3812439441680908, -1.8963104486465454, -0.8453232049942017, -1.1445587873458862, -2.187091588973999, -1.251505970954895, -2.191692352294922, -2.0084221363067627, -2.5188233852386475, -2.1592605113983154, -1.9350254535675049, -1.7643812894821167, -2.515712261199951, -1.623340129852295, -1.5552539825439453, -1.5282402038574219, -1.507745623588562, -1.1523513793945312, -1.060190200805664, -1.522345781326294, -2.2385079860687256, -1.8355604410171509, -2.615017890930176, -2.728449821472168, -2.1512510776519775, -2.625607490539551, -2.5222837924957275, -2.7814178466796875, -2.934252977371216, -2.0275719165802, -2.3753018379211426, -1.8509870767593384, -1.3872673511505127, -1.9368011951446533, -1.9996068477630615, -1.9565370082855225, -1.793576717376709, -1.577394723892212, -0.690995991230011, -2.1695005893707275, -0.5869089961051941, -2.424006462097168, -1.1682206392288208, -2.549983501434326, -0.6417763829231262, -1.526795506477356, -0.8142204880714417, -1.8102275133132935, -1.775558590888977, -1.1585220098495483, -1.8251299858093262, -1.0441324710845947, 0.015120239928364754, -3.575972318649292, -0.6166261434555054, -3.012561321258545, -1.2924809455871582, -3.3872618675231934, -2.1098458766937256, -3.0820367336273193, -2.0738158226013184, -2.281075954437256, -0.04596545547246933, 0.35679689049720764, -0.07711218297481537, 1.1825755834579468, 0.984119176864624, 2.028066873550415, 1.3602046966552734, 1.9339008331298828, 1.0726556777954102, 1.2815457582473755, 0.8717706799507141, -0.09354732185602188, 0.04716913029551506, -0.7881562113761902, -0.7758991718292236, -1.5171140432357788, -0.48283687233924866, -1.3305964469909668, -0.03775305300951004, -0.9376487731933594, -0.5229816436767578, -0.7628234028816223, 0.7956007122993469, 0.6061779856681824, 1.2064415216445923, 1.6540166139602661, 0.988463819026947, 1.6562557220458984, 0.6079373955726624, 0.8059596419334412, 1.730096697807312, 1.1621732711791992, -0.19481153786182404, 0.17870160937309265, -0.4451200067996979, -1.2268853187561035, -0.3973144292831421, -1.0416101217269897, -0.24450801312923431, -0.2125542163848877, -0.8008989095687866, -0.020605333149433136, 0.12838715314865112, 0.29379206895828247, 0.36315762996673584, 1.0489059686660767, 0.3342096209526062, 1.1634539365768433, 0.16302290558815002, 0.8093291521072388, 0.6868023872375488, -0.3519294261932373, 0.24224349856376648, -0.671788215637207, 0.01087335217744112, -0.8687125444412231, -0.2593602240085602, -0.5643178820610046, 0.4439847767353058, -0.5833317637443542, 0.7237284183502197, 1.125127911567688, 0.024611787870526314, 1.350245714187622, 0.6702991724014282, 1.1831501722335815, 1.2581202983856201, 0.8306653499603271, 0.9338728189468384, 0.7521986961364746, 0.011332702822983265, -0.5078868865966797, 0.34635359048843384, -0.5560849905014038, -0.18984922766685486, -0.44213324785232544, -1.064766764640808, -0.2774818241596222, -1.1065969467163086, 0.23280557990074158, -0.11287250369787216, 2.0962321758270264, 0.27590397000312805, 1.436746597290039, 0.515575110912323, 1.5850167274475098, 1.2284138202667236, 1.1435221433639526, 1.5447540283203125, 0.7973789572715759, -0.4163471758365631, -0.7668255567550659, -1.584176778793335, -0.3689256012439728, -1.859118103981018, 0.7750543355941772, -0.957493782043457, -0.21817085146903992, -0.2922053933143616, -1.0916026830673218, -1.0305745601654053, -0.03615158423781395, 0.5452252626419067, -0.5374817252159119, 0.034838899970054626, -1.6908414363861084, -0.01584530808031559, -1.0548596382141113, -0.2278253585100174, -0.8293047547340393, -0.15081928670406342, -0.8237374424934387, -1.4230411052703857, -0.4968150556087494, -0.7928194999694824, 0.5561739802360535, -1.0991308689117432, -0.04521411284804344, -1.120585322380066, -0.08839654922485352, -0.6930123567581177, 0.4080708920955658, -0.406589150428772, -0.24424788355827332, -0.4999544322490692, -1.5093120336532593, -0.12823767960071564, -1.2391104698181152, -0.04787153750658035, -0.5207414031028748, -0.9595637917518616, -1.9423260688781738, 0.10689516365528107, -0.7972241640090942, -0.3846600651741028, 1.1868027448654175, -0.334003746509552, 0.4585758149623871, -0.04190664738416672, -0.39174994826316833, 0.8965047001838684, 0.740319013595581, 0.18771366775035858, 0.38089242577552795, 0.700252115726471, -0.8413050770759583, 0.6278604865074158, -0.26463592052459717, 0.40705227851867676, 0.02062039263546467, -0.13883353769779205, -0.6253393888473511, 0.28365013003349304, 0.27032986283302307, -0.09610561281442642, 1.2259830236434937, 0.31205275654792786, 0.2584942579269409, 0.29603293538093567, 0.44004347920417786, 0.5849286913871765, 0.8251032829284668, 0.9767653346061707, 0.49446478486061096, 1.094560980796814, 0.20454749464988708, 0.34736379981040955, 0.957705020904541, 0.26413750648498535, 0.8783121705055237, 0.8291942477226257, -0.5184789896011353, 0.5052614808082581, 0.062226321548223495, -0.00013922119978815317, 0.41974353790283203, 1.159888505935669, 0.04914303869009018, 1.5868645906448364, -0.5285437107086182, 1.2078075408935547, 2.0820276737213135, 1.4551745653152466, 1.6822839975357056, 2.254640817642212, 0.9449949860572815, 1.1889787912368774, 1.7563002109527588, 0.37800082564353943, 2.278756856918335, 1.0527448654174805, 4.311829090118408, 3.31416916847229, 3.330571174621582, 4.278013706207275, 1.7369977235794067, 3.4913971424102783, 2.5724639892578125, 2.5982327461242676, 3.657505989074707, 2.6688199043273926, -1.1883167028427124, -0.5771337151527405, -0.39187830686569214, -1.1645656824111938, 1.0012626647949219, -1.1825358867645264, 0.13887229561805725, -0.5918527841567993, -0.3293658494949341, -0.37243056297302246, 2.242542266845703, 1.5226887464523315, 1.3667387962341309, 2.0309953689575195, 0.1281147450208664, 2.084547281265259, 1.027426838874817, 1.7354127168655396, 1.2233909368515015, 1.0372984409332275, -1.0470595359802246, 0.3987700045108795, -0.18119418621063232, -0.03648495301604271, 1.1153035163879395, -0.33507806062698364, 0.6992042660713196, -0.27782902121543884, -0.0518653467297554, 0.4662898778915405, 2.9435055255889893, -0.23899859189987183, 1.1673732995986938, 0.5141104459762573, -0.5832515358924866, 0.4104181230068207, -0.23960110545158386, -0.04566778615117073, 0.8338859677314758, -1.2385295629501343, -1.9753684997558594, -0.5052438974380493, -0.9338756799697876, -1.4304078817367554, 0.09746026247739792, -1.150886058807373, -0.36523550748825073, -0.6400086879730225, -0.7851029634475708, 0.1357768028974533, 2.4895517826080322, -0.8164538741111755, 0.21303169429302216, 0.12610600888729095, -1.0761921405792236, -0.43868276476860046, -0.15309998393058777, -1.1069798469543457, 0.14194408059120178, -2.596163511276245, -3.7251057624816895, -1.3374018669128418, -2.2939889430999756, -2.2324678897857666, -1.303802251815796, -1.7435529232025146, -2.182217597961426, -1.0842769145965576, -2.5638585090637207, -0.6480188369750977, 2.1736202239990234, -0.9789963364601135, 0.5781975388526917, 0.037310272455215454, -0.39932259917259216, -0.813237726688385, -0.005293029826134443, -1.4265872240066528, 0.8597825169563293, -2.135815143585205, -5.189095497131348, -4.157756805419922, -4.567033290863037, -5.232769966125488, -3.572397470474243, -4.414363861083984, -4.258468151092529, -3.6416547298431396, -5.05242395401001, -4.122173309326172, -4.990355014801025, -4.537363529205322, -4.1757025718688965, -5.021676063537598, -3.0437724590301514, -4.399928569793701, -3.717235565185547, -3.6953420639038086, -4.2721381187438965, -3.805314302444458, -0.01247546449303627, -1.1281098127365112, -1.039132833480835, -0.7611454129219055, -2.048027276992798, -0.8567951917648315, -1.5093449354171753, -1.4565930366516113, -1.3127553462982178, -2.149798631668091, -3.331514835357666, -3.6479439735412598, -3.175222396850586, -3.882967233657837, -2.6672897338867188, -3.9994304180145264, -3.2107622623443604, -4.198822975158691, -2.9432168006896973, -3.427924394607544, -1.6225777864456177, -2.2321290969848633, -2.1738054752349854, -2.1191039085388184, -3.035125732421875, -2.226799964904785, -2.8058462142944336, -1.7465509176254272, -2.437113046646118, -2.4490158557891846, -4.963855743408203, -2.0774741172790527, -3.2874279022216797, -2.570594072341919, -1.7397416830062866, -1.991422176361084, -1.7823842763900757, -1.900194525718689, -2.400341749191284, -0.4134300649166107, -0.5951598286628723, -0.8389652371406555, -1.193982481956482, -0.10460803657770157, -1.7874257564544678, -0.5677878856658936, -1.4998453855514526, -0.8855391144752502, -1.3596112728118896, -1.1507925987243652, -3.8889241218566895, -0.5762010812759399, -1.3189399242401123, -1.3591524362564087, -0.19892145693302155, -0.7222462296485901, -0.6266548037528992, 0.02168530412018299, -1.093878984451294, 1.53388512134552, 1.9928791522979736, 0.15286093950271606, 0.4797120690345764, 0.9304448366165161, -0.22251960635185242, 0.8564232587814331, 0.27223271131515503, -0.22262904047966003, 0.8212599754333496, -0.404854953289032, -2.7764697074890137, -0.5687159299850464, -1.1433433294296265, -1.2662899494171143, -0.5966479778289795, -0.9599617123603821, -0.5656105875968933, -0.06347516179084778, -1.53376042842865, 0.7153767347335815, 3.552332878112793, 2.712980031967163, 2.662977457046509, 3.411970376968384, 1.8415849208831787, 2.7790608406066895, 2.0501725673675537, 1.8674159049987793, 2.6927433013916016, 2.0078155994415283, 2.153844118118286, 0.9888964295387268, 0.936464786529541, 1.4599248170852661, -0.36216509342193604, 0.7699398994445801, 0.3672355115413666, 0.1948055475950241, 1.0274690389633179, 0.2445647418498993, -0.6432852745056152, 0.603813111782074, 0.2591579854488373, 0.022642090916633606, 1.4472827911376953, 0.13239099085330963, 0.6943336725234985, 0.34932205080986023, 0.5508679747581482, 1.0285664796829224, 0.5004947185516357, 0.9781022071838379, 0.46744638681411743, 1.2641514539718628, 0.0714266374707222, 1.3576151132583618, 0.4581668972969055, 2.2447738647460938, 0.06521478295326233, 1.5395153760910034, 0.6304528117179871, 0.736943244934082, 1.2995142936706543, 0.5425660014152527, 1.7319518327713013, 1.0888615846633911, 1.5317518711090088, -0.08261841535568237, 1.5511006116867065, 0.7138527035713196, 2.2088770866394043, 0.3732278645038605, 0.8254534006118774, 1.2772581577301025, -0.31054073572158813, 0.28510230779647827, -0.08631023019552231, 0.6862544417381287, 0.2367251068353653, -0.3931167721748352, -0.27124714851379395, 0.12605392932891846, 0.47168412804603577, -0.9321174621582031, 1.1217718124389648, 0.02896868996322155, 0.4796788990497589, 0.22980839014053345, 0.5554934144020081, 0.4964940845966339, 1.7350562810897827, -0.6263286471366882, 0.010806366801261902, 0.5652884840965271, -0.9285163879394531, -0.4200478196144104, -0.31520363688468933, -0.8172412514686584, 0.03265567123889923, -1.6145161390304565, -1.646060824394226, 0.10029696673154831, -0.6325066685676575, -0.9519896507263184, 0.2731359899044037, -0.866150438785553, -0.21308539807796478, 0.20299823582172394, -0.6710378527641296, 0.15942755341529846, 0.8387866616249084, -0.5906669497489929, -0.3186124861240387, 0.23551887273788452, -1.008887767791748, 0.032914917916059494, -0.5779321193695068, -0.70946204662323, 0.03488757461309433, -1.1814931631088257, -2.453126907348633, -0.9854125380516052, -1.009846806526184, -1.5447683334350586, 0.029803743585944176, -1.0821187496185303, -0.3320861756801605, -0.08756396919488907, -0.8714939951896667, 0.22255466878414154, -2.8492960929870605, -0.6397022008895874, -0.8649908900260925, -1.7529010772705078, 0.3941742777824402, -0.6659829616546631, 0.09653757512569427, 0.12489469349384308, -0.6675597429275513, 0.958888053894043, 1.264496088027954, -0.1775127649307251, 0.06787657737731934, 0.9970987439155579, -0.7760217785835266, 0.3132205605506897, -0.30041810870170593, 0.2541913092136383, -0.19580695033073425, -0.8169578313827515, -0.9395736455917358, -0.09658490121364594, -0.11204599589109421, -0.963355541229248, 0.4737113118171692, -0.14849020540714264, 0.393002450466156, -0.8980240821838379, 0.5788308382034302, 0.606587290763855, 0.8021994829177856, 0.172813281416893, 0.041027408093214035, 0.9941309690475464, -0.6254748702049255, -0.05802685767412186, -0.6253762245178223, 1.0271440744400024, -0.6262041926383972, -0.01682986505329609, -1.4095669984817505, 0.8920282125473022, 0.030438775196671486, -0.690364420413971, 1.1023845672607422, 0.6675831079483032, 1.1540002822875977, 0.02968224510550499, 0.9055179953575134, 1.3929980993270874, 1.8862314224243164, -0.060418352484703064, 0.6139295697212219, 1.404331922531128, -0.2281293421983719, 0.4555213749408722, 0.013694382272660732, 0.44558238983154297, -0.003980102948844433, -0.6387639045715332, -1.1114094257354736, 1.2367428541183472, 0.5769045948982239, -0.05399009957909584, 1.18852698802948, 0.6898818016052246, 1.0946660041809082, 0.5568946599960327, 0.5081613063812256, 1.5919091701507568, 1.7898856401443481, -0.0913671925663948, 0.5882260203361511, 1.140080451965332, -0.04448126256465912, 1.0244673490524292, 0.04053205996751785, 0.4259399175643921, 0.8254461884498596, -0.09142132848501205, -0.6070494651794434, 0.923117458820343, 0.5734493136405945, -0.21731515228748322, 1.1762425899505615, 0.19792616367340088, 1.1337000131607056, 0.6506463289260864, 0.2775880992412567, 1.4232169389724731, 2.8807568550109863, 0.7780222296714783, 1.0526998043060303, 1.7197169065475464, 0.050663210451602936, 0.7456026673316956, 0.000322753912769258, -0.41038936376571655, 0.6190133690834045, -1.1254334449768066, 5.39563512802124, 2.8123087882995605, 3.6795196533203125, 3.399563789367676, 2.138004779815674, 2.4099864959716797, 2.3235509395599365, 1.2646846771240234, 2.9730136394500732, 0.3997253477573395, -2.2588839530944824, -1.6160985231399536, -1.9605581760406494, -2.2060658931732178, -1.0358704328536987, -1.5503897666931152, -1.3436001539230347, -1.1886500120162964, -1.3476873636245728, -0.8898286819458008, 1.549781322479248, 0.6669831275939941, 1.097238302230835, 1.0593140125274658, 0.23924440145492554, 0.1370624452829361, 0.34314167499542236, 0.11819382011890411, 0.1195925623178482, -0.9302791953086853, -2.005622148513794, -1.6950745582580566, -1.8078452348709106, -1.969106912612915, -1.2010122537612915, -1.0933865308761597, -1.1703038215637207, -1.408086895942688, -1.1782231330871582, -1.0924553871154785, 1.4515618085861206, -1.4676421880722046, 0.4449904263019562, -0.5386267900466919, -0.8634704947471619, -1.5783382654190063, -1.0523735284805298, -1.753174901008606, -0.8383135795593262, -2.8554847240448, -3.4992284774780273, -1.696848750114441, -2.951519250869751, -2.6788346767425537, -2.000640392303467, -2.0999984741210938, -2.0734596252441406, -1.5843702554702759, -2.154428720474243, -1.089315414428711, 0.5834845900535583, -2.2825167179107666, -0.9262270927429199, -1.3957151174545288, -1.7664830684661865, -2.0405352115631104, -1.765300989151001, -2.3435893058776855, -1.2504839897155762, -3.3839468955993652, -3.8783864974975586, -2.8111796379089355, -3.2291910648345947, -3.506342887878418, -2.765537977218628, -3.59228777885437, -3.0873172283172607, -3.008896589279175, -3.561944007873535, -3.140713691711426, -0.23258240520954132, -2.076035737991333, -1.2369804382324219, -1.1838159561157227, -2.0789268016815186, -1.766361951828003, -1.7577110528945923, -2.6055171489715576, -1.2686773538589478, -3.1884069442749023, -8.07467269897461, -4.936851501464844, -6.119366645812988, -5.633322238922119, -4.887792110443115, -4.568315505981445, -4.858584880828857, -2.963170051574707, -5.143917560577393, -2.049917221069336, -8.661840438842773, -5.787076950073242, -7.224213600158691, -6.312796115875244, -5.600002288818359, -4.740842342376709, -5.847087860107422, -3.8280200958251953, -6.009527683258057, -3.0130960941314697, 1.096708059310913, 0.2255161851644516, 1.1247456073760986, 0.7280797958374023, 0.32146430015563965, -0.28465765714645386, 0.5637394785881042, -0.22799614071846008, 0.32210224866867065, -0.41313180327415466, -4.466049671173096, -1.963630199432373, -3.8211798667907715, -2.219841480255127, -2.5775034427642822, -1.1663472652435303, -2.4266512393951416, -1.359055757522583, -2.1625864505767822, -0.05418713763356209, 1.6666444540023804, -0.47585248947143555, 1.1526660919189453, -0.28231528401374817, 0.01232885755598545, -1.140371322631836, 0.008600860834121704, -0.6205735802650452, 0.03304550424218178, -1.0719826221466064, -3.5688283443450928, 0.11135831475257874, -2.5837948322296143, -0.3773954510688782, -1.1658353805541992, 0.32159167528152466, -1.0375757217407227, 0.17331837117671967, -1.4095022678375244, 0.9055072665214539, 1.9790587425231934, -0.38956108689308167, 1.629205584526062, 0.16001014411449432, 0.37314921617507935, -0.14402642846107483, 0.42910563945770264, -0.28137391805648804, 0.7655229568481445, -0.5063152313232422, -2.450028419494629, 0.6708437204360962, -1.3116679191589355, -0.0648440271615982, -0.06000601500272751, 0.2521741986274719, -0.43233662843704224, 0.26040124893188477, -0.916309118270874, 0.8269756436347961, 1.8330254554748535, 1.1022573709487915, 1.9768908023834229, 1.6162902116775513, 1.121292233467102, 1.812247633934021, 1.7851985692977905, 1.6393007040023804, 2.1020352840423584, 2.417912721633911, -1.931589961051941, -0.05240652710199356, -1.4031496047973633, -0.7670625448226929, -0.1415029615163803, -0.10174225270748138, -0.7547312378883362, 0.7868595123291016, -1.1265146732330322, 0.8328783512115479, 6.8637285232543945, 4.561445713043213, 5.908627510070801, 5.26679801940918, 4.570894241333008, 3.9721031188964844, 4.918297290802002, 2.7990212440490723, 4.90288782119751, 2.6755735874176025]))

    def test_3DImg_with_pad(self):
        return_new = fu.filt_gaussinv(IMAGE_3D,sigma= 0.23, pad=True )
        return_old = oldfu.filt_gaussinv(IMAGE_3D,sigma= 0.23, pad=True )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_new.get_3dview().flatten(), [2.371452569961548, 1.4762588739395142, 1.3893446922302246, 1.826465368270874, 1.2581467628479004, 1.0937118530273438, 0.9534513354301453, 2.030275821685791, 0.6147623658180237, 3.321913242340088, 1.5325124263763428, -0.20831696689128876, 0.7564235329627991, 0.33421510457992554, 0.6109774112701416, 1.5808370113372803, 0.7523568868637085, 0.9158710837364197, 0.5694069862365723, 2.466491222381592, 3.304353713989258, 0.5058363676071167, 2.182565450668335, 0.9737032651901245, 1.4962502717971802, 0.7284787893295288, 1.0868339538574219, 2.1197280883789062, 0.6584302186965942, 1.9382606744766235, 1.476586103439331, 1.1342558860778809, 0.8008965849876404, 1.309938669204712, 1.1052160263061523, 2.392822265625, 1.1232023239135742, 1.291383147239685, 0.3991946876049042, 3.5438170433044434, 3.4383435249328613, -0.11278987675905228, 2.4751052856445312, 0.5809665322303772, 1.6057592630386353, 0.2891384959220886, 1.0118509531021118, 1.4165589809417725, 0.8461812138557434, 1.544506311416626, 1.6977888345718384, 0.8902124762535095, 0.33507710695266724, 1.024204969406128, 0.6552513837814331, 1.4981220960617065, 0.7736303210258484, 0.9075824618339539, 0.1503121703863144, 2.5841174125671387, 2.6105215549468994, -0.2476416975259781, 1.6084102392196655, 0.42375868558883667, 0.9463054537773132, -0.08297635614871979, 1.0922443866729736, 1.171862244606018, 0.585303544998169, 1.4290449619293213, 1.2376872301101685, 0.4413612484931946, 0.3797006607055664, 0.5420805215835571, 0.39062848687171936, 1.5021250247955322, -0.48951220512390137, 1.1063696146011353, -0.4936111569404602, 1.6361864805221558, 1.2573046684265137, 0.33753228187561035, 1.1140410900115967, 0.621008574962616, 0.7912676334381104, -0.5585733652114868, 1.3729585409164429, -0.5162530541419983, 1.0438499450683594, -0.37013423442840576, 0.6257323622703552, -0.01326791476458311, -0.28910207748413086, -0.20051319897174835, -0.1079692468047142, 0.6581481695175171, -0.675299346446991, 0.932685375213623, -0.7648559212684631, 0.7491809725761414, -0.3320033848285675, -1.606803297996521, -0.31249117851257324, -1.134723424911499, -0.20744045078754425, -0.17259210348129272, -0.19315896928310394, -0.6799320578575134, -0.60648512840271, -1.2317343950271606, -1.5883334875106812, -0.2116031050682068, -1.3069934844970703, -1.2271231412887573, -1.754987120628357, -2.3503687381744385, -1.8037303686141968, -2.0858681201934814, -1.2656484842300415, -3.499147653579712, -3.102062702178955, -1.0311555862426758, -2.0671470165252686, -0.7379845380783081, -1.128348469734192, -0.7586786150932312, -0.9563981294631958, -1.5298542976379395, -0.7374153137207031, -1.3997951745986938, -1.5865657329559326, -1.5948071479797363, -1.3220289945602417, -2.144535541534424, -1.8231520652770996, -2.662057638168335, -1.8064383268356323, -2.0916690826416016, -1.2263381481170654, -4.138768672943115, -3.6032402515411377, -0.7179813385009766, -2.5701096057891846, -1.0844917297363281, -1.6455703973770142, -1.2131145000457764, -1.3804515600204468, -2.1854093074798584, -1.206254243850708, -2.85847544670105, -3.454414129257202, -1.5019311904907227, -2.0899713039398193, -2.2186989784240723, -2.180459499359131, -2.602234125137329, -2.201751708984375, -2.2663590908050537, -1.3719520568847656, -4.05893087387085, -3.3567516803741455, -0.938414454460144, -2.082453727722168, -1.4609410762786865, -1.6803091764450073, -1.4379150867462158, -1.7098479270935059, -2.943455696105957, -1.30278480052948, -4.490719318389893, -5.312670707702637, -1.8104121685028076, -3.6483752727508545, -2.9449357986450195, -3.1206953525543213, -3.620084762573242, -2.1782469749450684, -3.4890661239624023, -1.3759732246398926, -4.553041458129883, -2.8775856494903564, -1.4911624193191528, -2.1870415210723877, -1.6450376510620117, -1.9656509160995483, -1.020311713218689, -2.285947799682617, -1.234630823135376, -1.8601632118225098, -2.6272358894348145, -5.856768608093262, -1.8281993865966797, -3.3259940147399902, -2.480149984359741, -2.8413047790527344, -2.9891514778137207, -1.9333677291870117, -3.43487811088562, -1.1617112159729004, -3.720125675201416, -4.712245464324951, -0.4801868498325348, -3.383730173110962, -1.604152798652649, -3.29482364654541, -2.226688861846924, -2.996384859085083, -2.26741623878479, -1.5527193546295166, -2.2797720432281494, 0.8976585865020752, -0.5848913192749023, 1.1566367149353027, 0.8018046617507935, 1.6927342414855957, 1.071223497390747, 1.6729570627212524, 0.8361955881118774, 0.8180895447731018, 1.3848605155944824, -0.2804339826107025, -0.06545857340097427, -0.8826642036437988, -0.874518096446991, -1.4089070558547974, -0.3762282729148865, -1.2937743663787842, 0.06605816632509232, -0.8985392451286316, -0.41304871439933777, 0.34838807582855225, 0.23602579534053802, 0.823100209236145, 0.9650732278823853, 1.4859898090362549, 0.7027575969696045, 1.4572296142578125, 0.4862987995147705, 0.5257448554039001, 1.9751307964324951, 1.2495884895324707, -0.15344330668449402, 0.24631406366825104, -0.3153585195541382, -0.9468520879745483, -0.030168047174811363, -0.8831384778022766, 0.23739342391490936, -0.4390033781528473, 0.2543547749519348, 0.8500603437423706, -0.19246593117713928, 0.4723752737045288, 0.33154818415641785, 0.8496963381767273, 0.2875153124332428, 0.9395114183425903, 0.20031040906906128, 0.49680471420288086, 1.247625708580017, 0.6145248413085938, 0.08260008692741394, -0.10372480005025864, 0.1244867593050003, -0.21020647883415222, 0.06466032564640045, -0.08031190931797028, 0.8784680962562561, -0.46282681822776794, 1.479269027709961, 1.9193148612976074, -0.19976851344108582, 1.4331077337265015, 0.7157717347145081, 0.8787651658058167, 1.430359959602356, 0.4908612072467804, 1.291762113571167, 0.25474804639816284, 1.5072780847549438, 0.6099961400032043, 0.44236600399017334, 0.2600903809070587, 0.16439272463321686, 0.5642682313919067, -0.47807008028030396, 0.5719844102859497, -0.37431663274765015, 0.6083508729934692, 0.6148321628570557, 2.4124274253845215, 0.4112696349620819, 1.114331603050232, 0.6906417608261108, 0.7475467920303345, 1.1661747694015503, 0.22839877009391785, 1.6658995151519775, -0.1552286446094513, 1.3959424495697021, 1.7099305391311646, -0.6275562047958374, 1.3528048992156982, -0.23587605357170105, 2.0371270179748535, 0.21260669827461243, 1.2110706567764282, 0.6868715882301331, 0.14329862594604492, 0.794567346572876, -0.8872819542884827, 0.2001572996377945, -1.1084023714065552, -0.6194335222244263, -1.9842092990875244, -0.38891303539276123, -1.526033878326416, -0.498037725687027, -1.2705508470535278, -0.6466487050056458, -0.18733260035514832, -0.9656028151512146, 0.0009921875316649675, -0.21600116789340973, 0.8075445294380188, -0.7513827681541443, 0.3333434462547302, -0.813481867313385, 0.2904658019542694, -0.4585883319377899, -0.2029370367527008, -0.4065279960632324, -0.5115877985954285, -0.6668602824211121, -1.4897551536560059, -0.13272760808467865, -1.3243809938430786, -0.06252788007259369, -0.6970911026000977, -0.8730660676956177, -1.084705114364624, -0.02700827084481716, -0.4276328980922699, -0.28604090213775635, 1.189643144607544, -0.3968946039676666, 0.57527756690979, -0.18668845295906067, -0.0455767847597599, 0.3989221453666687, 0.794139564037323, -0.08705301582813263, 0.3057194948196411, 0.4385288655757904, -0.7115496397018433, 0.5471874475479126, -0.33104372024536133, 0.5055663585662842, -0.33712100982666016, 0.4008558988571167, 0.03577365353703499, 0.014875397086143494, 0.3352121114730835, -0.10287582129240036, 0.9105913639068604, 0.2310713231563568, 0.07932160049676895, 0.1963072270154953, 0.3401629626750946, 0.5747004747390747, 1.4826875925064087, 0.3700709044933319, 0.6166980862617493, 0.7219123244285583, 0.4618147313594818, 0.14650049805641174, 0.8652152419090271, 0.34651219844818115, 0.29855355620384216, 1.4373618364334106, 0.11961521208286285, 0.08939594030380249, -0.0051215519197285175, -0.11075185239315033, -0.19623123109340668, 0.9529846906661987, -0.3466862142086029, 1.243707299232483, -0.7417101860046387, 1.1712197065353394, 3.3155369758605957, 0.26366931200027466, 2.055814027786255, 1.5488154888153076, 1.658760666847229, 1.0193098783493042, 1.8232046365737915, 0.856191873550415, 1.3343857526779175, 2.5642812252044678, 3.7360448837280273, 0.9170010089874268, 1.8061119318008423, 2.0179319381713867, 0.22740662097930908, 1.8999888896942139, 0.557708740234375, 1.651045560836792, 0.7004449963569641, 3.0084900856018066, 0.18051594495773315, -0.09345607459545135, 0.4650830924510956, -0.2750038206577301, 1.5118122100830078, -0.4969019889831543, 0.7904571890830994, 0.018931489437818527, 0.3702360987663269, 0.43217208981513977, 2.3657686710357666, 0.43460410833358765, 0.8893045783042908, 1.1480779647827148, -0.2919541597366333, 1.5413845777511597, 0.310757040977478, 1.4878053665161133, -0.036459941416978836, 1.9392207860946655, 0.0665699765086174, 0.3520207107067108, 0.3084827959537506, 0.24851056933403015, 1.2374775409698486, -0.15225815773010254, 0.8825326561927795, -0.04610126093029976, 0.1842222809791565, 0.7178934216499329, 2.288621425628662, -0.4797458350658417, 0.6465222835540771, 0.16604529321193695, -0.8313269019126892, 0.2956332862377167, -0.7025349736213684, 0.10475769639015198, -0.20766617357730865, 0.011385376565158367, -1.3538602590560913, -0.3395128548145294, -0.5420898795127869, -1.0641840696334839, 0.19046057760715485, -0.918704628944397, -0.11511432379484177, -0.5786383152008057, -0.24248425662517548, -0.2773478627204895, 1.014478325843811, -0.5645052194595337, -0.3830888867378235, -0.06900516152381897, -1.232995867729187, -0.540610134601593, -0.4946623146533966, -1.0458452701568604, -0.5574366450309753, -1.9351001977920532, -3.670508861541748, -0.6296141147613525, -1.8982205390930176, -1.5986766815185547, -1.092637538909912, -1.3441482782363892, -1.5694173574447632, -1.1286362409591675, -1.2123260498046875, -1.8800548315048218, 0.4237827658653259, -1.0429716110229492, -0.28141894936561584, -0.5341342687606812, -0.6375582814216614, -1.2304593324661255, -0.4954526722431183, -1.5342280864715576, -0.03782544285058975, -1.9125616550445557, -5.8572540283203125, -1.5560214519500732, -3.742858648300171, -3.1738502979278564, -3.047645092010498, -3.054142713546753, -2.9920690059661865, -3.2510485649108887, -2.391737699508667, -5.806715965270996, -6.159905433654785, -2.2603039741516113, -3.7626662254333496, -3.369408130645752, -2.4323976039886475, -3.4870734214782715, -2.7356035709381104, -3.7194323539733887, -1.9869014024734497, -5.941866874694824, -1.9321247339248657, -0.8799101710319519, -1.7010701894760132, -1.1346955299377441, -2.2286529541015625, -1.1589702367782593, -1.5813567638397217, -1.743343710899353, -1.263953447341919, -2.916067123413086, -4.971735954284668, -2.0372438430786133, -3.236112356185913, -3.001254081726074, -2.499741792678833, -3.5922653675079346, -2.690062999725342, -4.296246528625488, -1.5321279764175415, -5.459157943725586, -3.8107807636260986, -1.5141849517822266, -2.7640762329101562, -2.135040283203125, -3.0461246967315674, -2.337498188018799, -2.611879587173462, -2.193315029144287, -1.7823612689971924, -3.95646333694458, -5.355611801147461, -1.3513318300247192, -3.027682304382324, -2.1456239223480225, -1.5000196695327759, -1.9354910850524902, -1.231828212738037, -2.309741497039795, -0.8910666704177856, -2.826508045196533, -1.7978951930999756, -0.6907474398612976, -1.6377754211425781, -0.3692435026168823, -1.8372371196746826, -0.8294711112976074, -1.5150851011276245, -1.2287898063659668, -1.2257484197616577, -1.8722387552261353, -2.7739503383636475, -0.5389823317527771, -0.7573330402374268, -1.0718157291412354, 0.07999429851770401, -0.5930301547050476, -0.12840133905410767, -0.05091319605708122, -0.1303427517414093, 0.4662855267524719, 1.4186230897903442, -0.40654778480529785, -0.039698824286460876, 0.31754791736602783, -0.5449326634407043, 0.4087747633457184, -0.34033018350601196, -0.43736177682876587, -0.16407006978988647, 0.0007604370475746691, -1.0948195457458496, -0.06900660693645477, -0.13142752647399902, -0.4353153705596924, -0.02012774720788002, -0.30882611870765686, 0.26738643646240234, 0.3771052956581116, -0.45581331849098206, 0.8507366180419922, 2.487311840057373, 0.34919002652168274, 1.1103837490081787, 1.232358455657959, 0.6284573674201965, 1.0583094358444214, 0.2579108476638794, 0.6676300764083862, 0.2652502655982971, 1.7728073596954346, 2.2062838077545166, 0.14314016699790955, 0.8602198958396912, 0.7312705516815186, -0.2437525987625122, 0.45587754249572754, 0.25919780135154724, 0.5620660781860352, 0.26739561557769775, 1.7392687797546387, 0.23581668734550476, 0.278364360332489, 0.3121124505996704, 0.046076640486717224, 1.1064023971557617, 0.014211182482540607, 0.36779412627220154, 0.11542941629886627, 0.2213633507490158, 0.7744458913803101, 1.1910083293914795, 0.10066257417201996, 0.5169728398323059, 0.7042310237884521, 0.15615256130695343, 1.0821534395217896, 0.3439989686012268, 2.1634488105773926, -0.3981713056564331, 2.3516104221343994, 1.6224501132965088, 0.21111629903316498, 1.3855019807815552, 0.43242958188056946, 1.394532322883606, 0.9317479729652405, 1.1261271238327026, 3.6041263228980824e-05, 0.9336801171302795, 1.2273002862930298, 2.180875062942505, 0.025802109390497208, 0.6118102073669434, 0.9952630996704102, -0.35141658782958984, 0.27371740341186523, -0.3150745928287506, 0.8773545622825623, -0.5405524373054504, 0.951807975769043, 0.44936349987983704, -0.18774546682834625, 0.6326369643211365, -0.9007667303085327, 0.9223386645317078, -0.0012329102028161287, 0.2923562824726105, 0.28726810216903687, 0.32069915533065796, 0.6720257997512817, 0.8961701989173889, -0.5111119151115417, -0.3209497630596161, 0.42127159237861633, -0.9609199166297913, -0.38583046197891235, -0.544127345085144, -0.7513601183891296, -0.465133398771286, -0.9703794121742249, -1.1763051748275757, 0.1375173032283783, -0.4288049638271332, -0.7441473007202148, 0.2186042219400406, -0.8491366505622864, 0.00289840716868639, 0.1485229730606079, -0.2404388189315796, -0.15421877801418304, -0.23406024277210236, -0.6742357611656189, -0.8010870814323425, -0.1596515029668808, -1.0613266229629517, -0.08623413741588593, -0.8908116817474365, -0.7517043352127075, -0.45197129249572754, -1.1723270416259766, -0.8775542378425598, -0.44579967856407166, -0.10541342943906784, -0.643527090549469, 0.29203566908836365, -0.5723820924758911, 0.34466490149497986, 0.26182666420936584, 0.12455510348081589, 0.5689913630485535, -0.5381491780281067, 0.11919466406106949, 0.30223095417022705, -0.4865058660507202, 1.0976545810699463, 0.14937441051006317, 0.6863667368888855, 0.520531952381134, 0.1956561654806137, 1.115680456161499, 0.8899007439613342, -0.44996652007102966, -0.05279909074306488, 0.619675874710083, -0.6752215027809143, 0.36019593477249146, -0.21949021518230438, 0.5346011519432068, -0.4365251660346985, 0.23093613982200623, 0.6424016952514648, 0.016940029338002205, 0.592866063117981, -0.4414244592189789, 0.7769426703453064, 0.23758283257484436, 0.6041287183761597, -0.3755788207054138, 0.7235981822013855, 1.0574616193771362, 1.2452569007873535, 0.07491213083267212, 0.278472900390625, 0.9571937918663025, -0.2546966075897217, 0.2782304584980011, -0.3501880466938019, 1.376466155052185, -0.7796383500099182, 1.3413052558898926, 0.3339386284351349, 0.5801035761833191, 0.7447102665901184, -0.4590339958667755, 1.3283212184906006, 0.7690944075584412, 1.283384084701538, 0.2762058675289154, 1.0846126079559326, 1.5275251865386963, 2.314528703689575, -0.10239163041114807, 0.7407235503196716, 1.3620651960372925, 0.026425691321492195, 0.7346308827400208, 0.11437590420246124, 0.8977962136268616, -0.4587622880935669, 1.0680824518203735, 0.5709808468818665, 0.7381477355957031, 1.083147406578064, 0.07415866106748581, 1.234524130821228, 0.6647114753723145, 1.168714165687561, 0.7452062368392944, 0.508014440536499, 1.8362833261489868, 2.386932134628296, -0.31633394956588745, 0.8182399272918701, 0.9673113822937012, 0.2476697564125061, 1.2973713874816895, -0.03857447952032089, 0.9293201565742493, 0.20592813193798065, 1.522230625152588, 0.920902669429779, 0.4741210639476776, 0.9351404309272766, 0.004969025030732155, 1.0102914571762085, 0.06531131267547607, 1.0801479816436768, 0.5309854745864868, 0.19156743586063385, 1.483420729637146, 2.6920740604400635, 0.6245458722114563, 1.0753995180130005, 1.2512872219085693, 0.5074388980865479, 0.9833868741989136, 0.013671204447746277, 0.3031425178050995, -0.1449054330587387, 0.9103569388389587, 2.054687976837158, 0.055592652410268784, 0.8658882975578308, 0.5118310451507568, -0.3643711507320404, 0.27667513489723206, -0.23927630484104156, -0.1402297466993332, -0.06576988101005554, 0.08891882747411728, -1.267308235168457, -0.5902529358863831, -1.082266926765442, -1.2153226137161255, -0.38598230481147766, -1.1403067111968994, -0.6830844879150391, -1.0221654176712036, -0.5161734223365784, -1.5024443864822388, -0.7267088890075684, -0.04450928047299385, -0.40958765149116516, 0.038381196558475494, -0.8251000642776489, -0.67435222864151, -0.6509923338890076, -0.8072730898857117, -0.8677241206169128, -1.4269248247146606, -2.4202003479003906, -1.3989359140396118, -1.7714502811431885, -1.8666795492172241, -1.3217188119888306, -1.4919575452804565, -1.1738966703414917, -1.8042677640914917, -0.6647442579269409, -2.8197340965270996, -1.4593337774276733, -1.1689473390579224, -1.0739948749542236, -0.9375277757644653, -1.7103123664855957, -1.8727331161499023, -1.713800072669983, -2.265860080718994, -1.4840476512908936, -3.340451240539551, -4.632370471954346, -1.2289143800735474, -2.9954171180725098, -2.564716339111328, -2.0822575092315674, -2.4431393146514893, -1.92186439037323, -2.2336246967315674, -1.1603537797927856, -3.6476168632507324, -2.4957101345062256, -1.646333932876587, -2.204411745071411, -1.6433436870574951, -2.3430635929107666, -2.1975464820861816, -2.2895445823669434, -2.883975028991699, -1.4612717628479004, -4.409292221069336, -6.130023956298828, -1.535796880722046, -3.5752861499786377, -3.0298097133636475, -2.8773958683013916, -3.8696985244750977, -2.5441205501556396, -3.8281075954437256, -1.9899048805236816, -6.147284030914307, -3.4005613327026367, -1.661167860031128, -2.5941126346588135, -1.6585522890090942, -2.6216084957122803, -1.9408882856369019, -2.3083815574645996, -2.8767189979553223, -1.4682674407958984, -4.317892074584961, -9.585294723510742, -3.0238380432128906, -5.706871509552002, -4.504677772521973, -4.560829162597656, -4.504392147064209, -3.724440097808838, -4.064796447753906, -2.1849732398986816, -6.598721027374268, -7.8419389724731445, -2.1766226291656494, -4.9572649002075195, -3.2381060123443604, -3.2701456546783447, -2.872729539871216, -2.962610960006714, -2.7618119716644287, -1.8394758701324463, -4.3196001052856445, 0.5017055869102478, -0.30445846915245056, 0.5231653451919556, 0.19669891893863678, 0.02550581470131874, -0.019815003499388695, 0.2303447425365448, -0.053961701691150665, -0.09442781656980515, 0.4353692829608917, -2.3396339416503906, -0.8272520303726196, -1.8829399347305298, -0.9883807897567749, -1.071760654449463, -0.35387903451919556, -0.8410819172859192, -0.3142651617527008, -0.17460203170776367, -0.46234065294265747, 1.6787514686584473, 0.03540626913309097, 1.0617718696594238, 0.19382505118846893, 0.30873340368270874, 0.011248749680817127, 0.21290476620197296, 0.1581735908985138, -0.3267570734024048, 1.2474256753921509, -0.844375491142273, 0.3978193402290344, -0.5147973299026489, 0.3427808880805969, 0.24788369238376617, 0.6973167657852173, 0.24049675464630127, 0.8405653238296509, 0.20311367511749268, 0.748154878616333, 2.5301754474639893, -0.21980540454387665, 1.4055116176605225, 0.4212825894355774, 0.45374491810798645, 0.5802725553512573, 0.4192153513431549, 0.39091256260871887, 0.11936461180448532, 1.7265002727508545, 0.2728824019432068, 0.8564752340316772, 0.42858511209487915, 0.6675524711608887, 1.0588492155075073, 0.5584390163421631, 0.8322810530662537, 1.0591686964035034, 0.2534373104572296, 1.3676326274871826, 3.3002779483795166, -0.003376159816980362, 1.8679184913635254, 1.106134057044983, 0.9564991593360901, 2.2433736324310303, 0.9155843257904053, 2.2611916065216064, 0.6830251812934875, 4.482504844665527, 1.5466854572296143, 0.7559478878974915, 0.9289355874061584, 0.6255040168762207, 1.4536184072494507, 0.4512653052806854, 1.0667120218276978, 1.3404971361160278, 0.4146660268306732, 1.6272860765457153, 6.538987159729004, 1.5689526796340942, 3.8435983657836914, 2.925205707550049, 2.7603015899658203, 3.087716817855835, 2.370356559753418, 2.8892548084259033, 1.134490966796875, 5.463350772857666]))

    def test_3DImgBlank_without_pad(self):
        return_new = fu.filt_gaussinv(IMAGE_BLANK_3D,sigma= 0.23, pad=False )
        return_old = oldfu.filt_gaussinv(IMAGE_BLANK_3D,sigma= 0.23, pad=False )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview(), IMAGE_BLANK_3D.get_3dview()))

    def test_3DImgBlank_with_pad(self):
        return_new = fu.filt_gaussinv(IMAGE_BLANK_3D,sigma= 0.23, pad=True )
        return_old = oldfu.filt_gaussinv(IMAGE_BLANK_3D,sigma= 0.23, pad=True )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview(), IMAGE_BLANK_3D.get_3dview()))



class Test_filt_gaussh(unittest.TestCase):
    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_gaussh()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_gaussh()
        self.assertEqual(str(cm_new.exception), "filt_gaussh() takes at least 2 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError) as cm_new:
            fu.filt_gaussh(EMData(), sigma=0.23)
        with self.assertRaises(RuntimeError) as cm_old:
            oldfu.filt_gaussh(EMData(), sigma=0.23)
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_NoneType_Img(self):
        return_new =  fu.filt_gaussh(None,sigma= 0.23, pad=False )
        return_old = oldfu.filt_gaussh(None,sigma= 0.23, pad=False )
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_2DImg_without_pad(self):
        return_new = fu.filt_gaussh(IMAGE_2D,sigma= 0.23, pad=False )
        return_old = oldfu.filt_gaussh(IMAGE_2D,sigma= 0.23, pad=False )
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview().flatten(), [0.08204471319913864, 0.10445050150156021, 0.09712372720241547, 0.1104142814874649, 0.10152701288461685, 0.0949157103896141, 0.09084856510162354, 0.09654068946838379, 0.09571190923452377, 0.11032810807228088, 0.012533146888017654, 0.0026232998352497816, 0.0024201555643230677, -0.0093355318531394, -0.012355861254036427, 0.011915230192244053, -0.004723985679447651, -0.0022726168390363455, 0.014992336742579937, 0.012381636537611485, 0.0061269295401871204, 0.002819920191541314, 0.014306287281215191, 0.010194947943091393, 0.010533076710999012, 0.00692181708291173, 0.00926413107663393, 0.03247450664639473, 0.016479775309562683, -0.006669700611382723, 0.009768841788172722, 0.020443839952349663, 0.014847101643681526, 0.0068739899434149265, 0.026823503896594048, 0.04594140499830246, 0.023477019742131233, 0.0050603304989635944, 0.013737019151449203, 0.017050711438059807, 0.02452944405376911, 0.00518955709412694, 0.018186189234256744, 0.006556502543389797, 0.01439571101218462, -0.006922756787389517, -0.005495103541761637, -0.0004374164273031056, 0.00587620260193944, -0.026119215413928032, 0.02661941386759281, 0.00834712479263544, -0.012420513667166233, -0.0003837934054899961, -0.0002471494663041085, -0.0001996362116187811, 0.009089670144021511, -0.005208347458392382, 0.0029658039566129446, -0.010708453133702278, 0.03851841762661934, 0.0020511113107204437, 0.00895988754928112, 0.004720890894532204, -0.0013300215359777212, -0.008104457519948483, 0.01107729785144329, 0.013326935470104218, -0.0006677606725133955, -0.03146636113524437, -0.002979359356686473, -0.01755586639046669, -0.030566465109586716, -0.029739266261458397, -0.019559316337108612, -0.012731936760246754, -0.03722042962908745, -0.021715838462114334, -0.020081689581274986, -0.03097490221261978, 0.008118346333503723, 0.016724927350878716, 0.014619110152125359, 0.019920429214835167, 0.00262941000983119, -0.007211328949779272, 0.009145463816821575, -0.008388095535337925, -0.0014406490372493863, -0.04173339158296585, -0.12414328008890152, -0.12469479441642761, -0.1371006965637207, -0.13435830175876617, -0.11992329359054565, -0.1105622723698616, -0.11337631940841675, -0.100617416203022, -0.11087579280138016, -0.1028645783662796]))

    def test_2DImg_with_pad(self):
        return_new = fu.filt_gaussh(IMAGE_2D,sigma= 0.23, pad=True )
        return_old = oldfu.filt_gaussh(IMAGE_2D,sigma= 0.23, pad=True )
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview().flatten(), [0.05883622542023659, 0.040437791496515274, 0.031039061024785042, 0.04412422701716423, 0.038830798119306564, 0.03470628336071968, 0.032103367149829865, 0.039453987032175064, 0.038077838718891144, 0.0839267149567604, 0.06438437104225159, 0.0029785018414258957, 0.0024185420479625463, -0.010174467228353024, -0.01297291275113821, 0.011198198422789574, -0.005649603437632322, -0.002419897122308612, 0.015109307132661343, 0.06127253919839859, 0.056384190917015076, 0.002632042160257697, 0.013560104183852673, 0.008690833114087582, 0.009487869217991829, 0.006025450304150581, 0.007991485297679901, 0.03205730393528938, 0.016517166048288345, 0.044762853533029556, 0.05429712310433388, 0.02210070751607418, 0.016147641465067863, 0.0075540803372859955, 0.027593258768320084, 0.046684399247169495, 0.023892100900411606, 0.006292290519922972, 0.015270156785845757, 0.06673114001750946, 0.04803100600838661, 0.005132270976901054, 0.017677664756774902, 0.005837989971041679, 0.013749780133366585, -0.007283673156052828, -0.006297060288488865, -0.0005059485556557775, 0.006020830944180489, 0.0119349155575037, 0.02873809076845646, 0.00903761014342308, -0.01187098864465952, 0.0003344217548146844, 0.0001998285879381001, 0.0003962445189245045, 0.009404284879565239, -0.00436606677249074, 0.0037661956157535315, 0.011013532988727093, 0.013670352287590504, 0.0010803710902109742, 0.007956419140100479, 0.004239491652697325, -0.002067271387204528, -0.008516470901668072, 0.010446936823427677, 0.012782310135662556, -0.001358796376734972, -0.03479687124490738, -0.049158673733472824, -0.017600631341338158, -0.030284928157925606, -0.028564488515257835, -0.018893279135227203, -0.012013536877930164, -0.03637898340821266, -0.021183423697948456, -0.019897472113370895, -0.059528104960918427, -0.050661709159612656, 0.016240524128079414, 0.01435314305126667, 0.020672930404543877, 0.0030069395434111357, -0.0065904525108635426, 0.009943162091076374, -0.00834151916205883, -0.0016175827477127314, -0.08892118185758591, -0.12821318209171295, -0.0832773968577385, -0.095046266913414, -0.09062488377094269, -0.07636599242687225, -0.06756897270679474, -0.0694168284535408, -0.05559322237968445, -0.06434161961078644, -0.10235611349344254]))

    def test_2DImgBlank_without_pad(self):
        return_new = fu.filt_gaussh(IMAGE_BLANK_2D,sigma= 0.23, pad=False )
        return_old = oldfu.filt_gaussh(IMAGE_BLANK_2D,sigma= 0.23, pad=False )
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview(), IMAGE_BLANK_2D.get_2dview()))

    def test_2DImgBlank_with_pad(self):
        return_new = fu.filt_gaussh(IMAGE_BLANK_2D,sigma= 0.23, pad=True )
        return_old = oldfu.filt_gaussh(IMAGE_BLANK_2D,sigma= 0.23, pad=True )
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview(), IMAGE_BLANK_2D.get_2dview()))

    def test_3DImg_without_pad(self):
        return_new = fu.filt_gaussh(IMAGE_3D,sigma= 0.23, pad=False )
        return_old = oldfu.filt_gaussh(IMAGE_3D,sigma= 0.23, pad=False )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview().flatten(), [0.32135313749313354, 0.3490642309188843, 0.3351551592350006, 0.34276485443115234, 0.3290508985519409, 0.31886130571365356, 0.31231826543807983, 0.3170567750930786, 0.31513679027557373, 0.3342503011226654, 0.2946719527244568, 0.2865675687789917, 0.2796018719673157, 0.2598874866962433, 0.25406014919281006, 0.27940040826797485, 0.26084664463996887, 0.26343971490859985, 0.28139054775238037, 0.28281864523887634, 0.2642567753791809, 0.26648786664009094, 0.27493080496788025, 0.2647729516029358, 0.2647877633571625, 0.26200300455093384, 0.2607542872428894, 0.28203436732292175, 0.26207807660102844, 0.23929603397846222, 0.24792835116386414, 0.263339102268219, 0.25815606117248535, 0.24978263676166534, 0.2750032842159271, 0.29593923687934875, 0.26746243238449097, 0.2446766048669815, 0.25147414207458496, 0.25272756814956665, 0.24592085182666779, 0.2267487347126007, 0.23848721385002136, 0.2274940460920334, 0.23891423642635345, 0.21743586659431458, 0.21585321426391602, 0.21910329163074493, 0.2252051681280136, 0.19313253462314606, 0.23292331397533417, 0.2116171270608902, 0.18557339906692505, 0.1971287578344345, 0.19680309295654297, 0.19702030718326569, 0.2082875370979309, 0.19353672862052917, 0.20001883804798126, 0.18895311653614044, 0.2140265256166458, 0.17569942772388458, 0.17553366720676422, 0.1679404377937317, 0.15764130651950836, 0.14901359379291534, 0.17005373537540436, 0.17365776002407074, 0.15658868849277496, 0.1298981010913849, 0.13282941281795502, 0.12786982953548431, 0.10940539836883545, 0.10508785396814346, 0.10721796005964279, 0.10595758259296417, 0.07498834282159805, 0.08620630204677582, 0.08198454231023788, 0.07665227353572845, 0.0889904573559761, 0.11079894751310349, 0.10496369749307632, 0.10486774146556854, 0.07963501662015915, 0.06384921073913574, 0.07442876696586609, 0.04995766654610634, 0.04963461309671402, 0.011824878863990307, -0.02682395838201046, -0.020073140040040016, -0.038496747612953186, -0.04025633633136749, -0.029529154300689697, -0.023338736966252327, -0.02844317816197872, -0.018233975395560265, -0.03454233333468437, -0.025054767727851868, 0.013136666268110275, -0.0135200759395957, -0.002425740472972393, -0.011847266927361488, -0.011049042455852032, 0.0014992180513218045, -0.014278711751103401, -0.022661851719021797, -0.037476856261491776, -0.024532010778784752, -0.07208172231912613, -0.07319433242082596, -0.08263138681650162, -0.09511612355709076, -0.12999027967453003, -0.15171490609645844, -0.15676246583461761, -0.16165882349014282, -0.1688365936279297, -0.18550337851047516, -0.1767951101064682, -0.1774429976940155, -0.17716407775878906, -0.14854326844215393, -0.15285038948059082, -0.16031739115715027, -0.1582910567522049, -0.14795954525470734, -0.15033632516860962, -0.15358330309391022, -0.14556728303432465, -0.17856192588806152, -0.17362211644649506, -0.18171517550945282, -0.1852874904870987, -0.2019764631986618, -0.19124576449394226, -0.2010623812675476, -0.21804244816303253, -0.23675477504730225, -0.20492754876613617, -0.22567112743854523, -0.237884983420372, -0.23780255019664764, -0.24962815642356873, -0.25582030415534973, -0.26295194029808044, -0.26797011494636536, -0.26992282271385193, -0.29743632674217224, -0.2619127333164215, -0.271899938583374, -0.2780928313732147, -0.2816455662250519, -0.2819206416606903, -0.2957717478275299, -0.29790616035461426, -0.2973683774471283, -0.30013877153396606, -0.33277207612991333, -0.2953805923461914, -0.29939836263656616, -0.3028390407562256, -0.31053200364112854, -0.316491961479187, -0.3183041214942932, -0.33233392238616943, -0.37000536918640137, -0.3833170235157013, -0.41650545597076416, -0.4091174304485321, -0.42069926857948303, -0.4334172010421753, -0.4398669898509979, -0.43135693669319153, -0.4140765368938446, -0.40650156140327454, -0.40018507838249207, -0.3874495029449463, -0.38619595766067505, -0.39233073592185974, -0.3937457799911499, -0.38800376653671265, -0.3813435137271881, -0.36952489614486694, -0.3624500036239624, -0.36728814244270325, -0.34759947657585144, -0.3477315306663513, -0.3302983343601227, -0.3815981149673462, -0.35279780626296997, -0.33709171414375305, -0.3324372172355652, -0.32012152671813965, -0.3010052740573883, -0.29344484210014343, -0.2862519323825836, -0.2690345048904419, -0.23146583139896393, -0.33447927236557007, -0.30070629715919495, -0.2962423861026764, -0.28910180926322937, -0.28355151414871216, -0.284445196390152, -0.29068809747695923, -0.2697853446006775, -0.23769532144069672, -0.18599846959114075, -0.11573576927185059, -0.09514038264751434, -0.056041818112134933, -0.029892096295952797, -0.024697478860616684, -0.01408227626234293, -0.013453583233058453, -0.0289764367043972, -0.039368968456983566, -0.03473610058426857, -0.06191927567124367, -0.06508761644363403, -0.07361338287591934, -0.066084124147892, -0.05430946871638298, -0.035117488354444504, -0.03410451486706734, -0.017657898366451263, -0.023529794067144394, -0.012566258199512959, -0.01912236586213112, 0.005551933776587248, 0.027184640988707542, 0.029701538383960724, 0.032091252505779266, 0.02089364267885685, 0.03631880134344101, 0.025697072967886925, 0.03161625564098358, 0.0490865632891655, 0.0439956970512867, 0.04103928431868553, 0.028607355430722237, 0.012241318821907043, 0.0003925152122974396, 0.014718507416546345, 0.014567323960363865, 0.01871488243341446, 0.03214450180530548, 0.04528464004397392, 0.04326753318309784, 0.029203180223703384, 0.0361870601773262, 0.04807967692613602, 0.0420660562813282, 0.047256313264369965, 0.06664107739925385, 0.06561236828565598, 0.08391741663217545, 0.09110613167285919, 0.08251908421516418, 0.0887899398803711, 0.09359962493181229, 0.10896564275026321, 0.11954358965158463, 0.12154263257980347, 0.12763170897960663, 0.13875947892665863, 0.12703725695610046, 0.15089993178844452, 0.13341397047042847, 0.12998315691947937, 0.15787477791309357, 0.1554311364889145, 0.15525270998477936, 0.17267552018165588, 0.1672501266002655, 0.17171426117420197, 0.1720663607120514, 0.17689849436283112, 0.17505943775177002, 0.20073513686656952, 0.1814209371805191, 0.1780286282300949, 0.18953409790992737, 0.17508822679519653, 0.17329005897045135, 0.18088003993034363, 0.19522126019001007, 0.19560115039348602, 0.2493378072977066, 0.2523958683013916, 0.237411767244339, 0.2359125167131424, 0.2262878119945526, 0.21823035180568695, 0.21492110192775726, 0.22786523401737213, 0.21172238886356354, 0.20360106229782104, 0.13363157212734222, 0.12435882538557053, 0.13326163589954376, 0.1195884644985199, 0.15306003391742706, 0.13367860019207, 0.13363803923130035, 0.13693274557590485, 0.11694929748773575, 0.13596777617931366, 0.11658361554145813, 0.12826527655124664, 0.11287727952003479, 0.09238708019256592, 0.1021481305360794, 0.11260204762220383, 0.11190062016248703, 0.11373331397771835, 0.09608449786901474, 0.12563559412956238, 0.11615902930498123, 0.08507688343524933, 0.10360772162675858, 0.12348376959562302, 0.11397027224302292, 0.108891561627388, 0.10632701218128204, 0.11250382661819458, 0.12145932763814926, 0.1083204597234726, 0.11439487338066101, 0.12642113864421844, 0.13050152361392975, 0.12428849190473557, 0.13791529834270477, 0.13935978710651398, 0.12317942827939987, 0.1390538513660431, 0.1353013664484024, 0.12315429002046585, 0.12716250121593475, 0.14910875260829926, 0.1402052491903305, 0.14439736306667328, 0.18541854619979858, 0.15733736753463745, 0.15152409672737122, 0.15342159569263458, 0.14783860743045807, 0.15842214226722717, 0.16004864871501923, 0.1650603711605072, 0.17874285578727722, 0.17610439658164978, 0.16901391744613647, 0.18137425184249878, 0.17696216702461243, 0.18223103880882263, 0.17905108630657196, 0.1749083399772644, 0.17986591160297394, 0.1923951357603073, 0.18765714764595032, 0.19543085992336273, 0.2013823688030243, 0.18087138235569, 0.1659199744462967, 0.1772056668996811, 0.19115039706230164, 0.17169825732707977, 0.1765201985836029, 0.20916475355625153, 0.19926683604717255, 0.2073131650686264, 0.21041715145111084, 0.19411025941371918, 0.20755217969417572, 0.20322613418102264, 0.20072655379772186, 0.21358273923397064, 0.21514752507209778, 0.21405649185180664, 0.20197799801826477, 0.190766379237175, 0.19307461380958557, 0.22023749351501465, 0.22196653485298157, 0.22578756511211395, 0.20106454193592072, 0.19799187779426575, 0.2095363587141037, 0.17722849547863007, 0.1930721551179886, 0.204019695520401, 0.19094163179397583, 0.18539151549339294, 0.19332855939865112, 0.17253097891807556, 0.17681458592414856, 0.13912823796272278, 0.2687890827655792, 0.23859219253063202, 0.24926209449768066, 0.2472178190946579, 0.22208622097969055, 0.22502657771110535, 0.2116047590970993, 0.2206045389175415, 0.23126161098480225, 0.2039659470319748, 0.17350143194198608, 0.16731736063957214, 0.15555839240550995, 0.15117689967155457, 0.15672965347766876, 0.13162291049957275, 0.14075987040996552, 0.13357120752334595, 0.13511192798614502, 0.10791128873825073, 0.14444656670093536, 0.11884747445583344, 0.11410655081272125, 0.12941257655620575, 0.09652364253997803, 0.11325852572917938, 0.11738525331020355, 0.09965101629495621, 0.10253411531448364, 0.08976279199123383, 0.08799787610769272, 0.0962357223033905, 0.08292688429355621, 0.09024160355329514, 0.07943553477525711, 0.06424883753061295, 0.07061225920915604, 0.062225569039583206, 0.05601854994893074, 0.04739276319742203, 0.03990988805890083, 0.020093921571969986, 0.008557826280593872, -0.0026830369606614113, -0.0019969067070633173, -0.0015511513920500875, -0.018113143742084503, -0.01004709955304861, 0.004933691583573818, 0.006962297018617392, -0.026363637298345566, -0.021984314545989037, -0.027063416317105293, -0.04476999118924141, -0.04855676740407944, -0.046595748513936996, -0.04249052703380585, -0.04556716978549957, -0.04305404797196388, -0.03786620870232582, -0.057411402463912964, -0.06147221848368645, -0.0825154185295105, -0.08663727343082428, -0.1066608875989914, -0.0987386628985405, -0.09863614290952682, -0.12151473015546799, -0.13361744582653046, -0.15592189133167267, -0.1702958345413208, -0.15525466203689575, -0.16804154217243195, -0.16388368606567383, -0.15298941731452942, -0.16166265308856964, -0.1727147400379181, -0.16771729290485382, -0.16492794454097748, -0.15611889958381653, -0.16174156963825226, -0.20115619897842407, -0.19598782062530518, -0.20905272662639618, -0.22026439011096954, -0.23734158277511597, -0.22767332196235657, -0.2260061651468277, -0.23218399286270142, -0.24832722544670105, -0.2820153832435608, -0.3044206202030182, -0.3137093186378479, -0.32493484020233154, -0.3231644630432129, -0.32600533962249756, -0.3323809504508972, -0.33921748399734497, -0.35836976766586304, -0.3816138803958893, -0.31499388813972473, -0.3364633321762085, -0.33684876561164856, -0.33415165543556213, -0.32698366045951843, -0.33313998579978943, -0.34311768412590027, -0.3377726078033447, -0.33318185806274414, -0.35363057255744934, -0.2973411977291107, -0.3152218461036682, -0.32936540246009827, -0.33266106247901917, -0.32860898971557617, -0.334425687789917, -0.34610307216644287, -0.3630867898464203, -0.3639225959777832, -0.38667479157447815, -0.3675527572631836, -0.39608511328697205, -0.4048457145690918, -0.4207388758659363, -0.43538588285446167, -0.44313663244247437, -0.45294100046157837, -0.448383629322052, -0.4310529828071594, -0.4240933358669281, -0.4243004620075226, -0.4158761501312256, -0.4096237123012543, -0.41911134123802185, -0.4223147928714752, -0.41661328077316284, -0.4106639325618744, -0.4012131989002228, -0.38931307196617126, -0.3838645815849304, -0.4036732017993927, -0.3805275559425354, -0.3693263828754425, -0.33494070172309875, -0.3184886574745178, -0.2994416356086731, -0.29808852076530457, -0.2963167130947113, -0.2827741801738739, -0.2587001323699951, -0.29202890396118164, -0.25013303756713867, -0.23624999821186066, -0.2126438170671463, -0.20180359482765198, -0.198374941945076, -0.20110778510570526, -0.19552373886108398, -0.18940450251102448, -0.14822174608707428, -0.18003059923648834, -0.13961760699748993, -0.10794290155172348, -0.09253188967704773, -0.07581968605518341, -0.07069942355155945, -0.05670298635959625, -0.05466504767537117, -0.03729670122265816, -0.012743729166686535, -0.044410768896341324, -0.046120721846818924, -0.05364887788891792, -0.04138488322496414, -0.041247788816690445, -0.020267946645617485, -0.030897552147507668, -0.042568594217300415, -0.026731790974736214, -0.004341406282037497, -0.009930428117513657, 0.0009689865401014686, 0.018565643578767776, 0.01620757393538952, -0.000567798619158566, 0.008339542895555496, 0.034980736672878265, 0.021791620180010796, 0.019220024347305298, 0.044900886714458466, 0.07834041118621826, 0.08151666074991226, 0.09242523461580276, 0.09998060762882233, 0.09113208204507828, 0.08456408977508545, 0.07794100791215897, 0.08276953548192978, 0.0890728309750557, 0.10224714875221252, 0.022842202335596085, 0.02171439491212368, 0.015258164145052433, 0.0026501885149627924, -0.003426527138799429, -0.00905565544962883, 0.00952729769051075, 0.007704546675086021, 0.03768381476402283, 0.048345912247896194, 0.08866477012634277, 0.10721742361783981, 0.09839241206645966, 0.11669273674488068, 0.13287565112113953, 0.11046762764453888, 0.11355172842741013, 0.12102927267551422, 0.11792246252298355, 0.13163629174232483, 0.09670083969831467, 0.10413208603858948, 0.12267684936523438, 0.12404189258813858, 0.15767976641654968, 0.1742853820323944, 0.17933566868305206, 0.20438383519649506, 0.1775628626346588, 0.20574386417865753, 0.1912875473499298, 0.1939389407634735, 0.2226288914680481, 0.21375040709972382, 0.20328721404075623, 0.21983927488327026, 0.19691327214241028, 0.17876999080181122, 0.1956244856119156, 0.2013271003961563, 0.20015251636505127, 0.19405964016914368, 0.19091466069221497, 0.1913023144006729, 0.17369326949119568, 0.17252467572689056, 0.16811704635620117, 0.1782139539718628, 0.17544429004192352, 0.18221332132816315, 0.17273853719234467, 0.15196755528450012, 0.15615738928318024, 0.13428479433059692, 0.14837177097797394, 0.1426623910665512, 0.13186705112457275, 0.14996908605098724, 0.14107489585876465, 0.1426052302122116, 0.13063880801200867, 0.12725141644477844, 0.133257657289505, 0.142118901014328, 0.11538410931825638, 0.10180123150348663, 0.11605937033891678, 0.10726698487997055, 0.11823651939630508, 0.11086683720350266, 0.10469041764736176, 0.11591517180204391, 0.08933437615633011, 0.10201352089643478, 0.10412188619375229, 0.09589207917451859, 0.11990241706371307, 0.14064805209636688, 0.12785448133945465, 0.11277187615633011, 0.10689372569322586, 0.11306560784578323, 0.11005508899688721, 0.1194821447134018, 0.12119006365537643, 0.13989993929862976, 0.14864622056484222, 0.14395304024219513, 0.13771063089370728, 0.13685037195682526, 0.15541517734527588, 0.16758203506469727, 0.1879306435585022, 0.19836053252220154, 0.20054712891578674, 0.18728432059288025, 0.20311899483203888, 0.1984945833683014, 0.21061395108699799, 0.21380625665187836, 0.20747770369052887, 0.2351139634847641, 0.24057018756866455, 0.224391371011734, 0.24577392637729645, 0.24230323731899261, 0.25506317615509033, 0.25002652406692505, 0.24692091345787048, 0.24766036868095398, 0.18283377587795258, 0.16985298693180084, 0.17315611243247986, 0.19346745312213898, 0.18842396140098572, 0.1950751096010208, 0.2028798758983612, 0.19838571548461914, 0.18366380035877228, 0.1764446496963501, 0.18892113864421844, 0.19576434791088104, 0.1983642578125, 0.18925818800926208, 0.19412198662757874, 0.2090379297733307, 0.20359894633293152, 0.18942378461360931, 0.20899738371372223, 0.22311027348041534, 0.21251340210437775, 0.20986035466194153, 0.21766196191310883, 0.21538084745407104, 0.20023366808891296, 0.19783619046211243, 0.20527324080467224, 0.21974784135818481, 0.20576906204223633, 0.2142714560031891, 0.21449771523475647, 0.22335287928581238, 0.2125205099582672, 0.1805535852909088, 0.20966272056102753, 0.22228699922561646, 0.2192482054233551, 0.19543763995170593, 0.21274727582931519, 0.18772847950458527, 0.22221620380878448, 0.18720760941505432, 0.18784520030021667, 0.18805932998657227, 0.17882828414440155, 0.18295831978321075, 0.18973088264465332, 0.17644639313220978, 0.1540236920118332, 0.1387733519077301, 0.1823735237121582, 0.1780409961938858, 0.18213599920272827, 0.1712758094072342, 0.16211652755737305, 0.1671307235956192, 0.1654881089925766, 0.13797074556350708, 0.138800710439682, 0.11763143539428711, 0.14539559185504913, 0.12092235684394836, 0.12560805678367615, 0.12822504341602325, 0.12710709869861603, 0.13027288019657135, 0.11187746375799179, 0.11373627930879593, 0.1214638501405716, 0.09376581013202667, 0.11726892739534378, 0.11896048486232758, 0.10772015899419785, 0.09818799048662186, 0.08983168751001358, 0.08528760075569153, 0.08774372935295105, 0.05533462390303612, 0.060124725103378296, 0.06265433132648468, -0.005637603811919689, 0.01034441590309143, -0.005147186573594809, -0.006866199895739555, -0.02150859870016575, -0.03401188924908638, -0.05319292098283768, -0.0685734674334526, -0.06016130745410919, -0.046920061111450195, 0.05412814021110535, 0.0525265596807003, 0.04189623147249222, 0.018899040296673775, 0.0066856443881988525, 0.01467304676771164, -0.005594972986727953, 0.0004466133250389248, 0.005949920043349266, 0.008097300305962563, -0.045947689563035965, -0.05080025643110275, -0.06940348446369171, -0.07002077251672745, -0.07813461124897003, -0.09330986440181732, -0.095148965716362, -0.10069485008716583, -0.10944255441427231, -0.12174864113330841, -0.1297726333141327, -0.10919743776321411, -0.11633972078561783, -0.11403975635766983, -0.13602639734745026, -0.1410919427871704, -0.14051835238933563, -0.15795432031154633, -0.15952613949775696, -0.1696229875087738, -0.17792682349681854, -0.2177017331123352, -0.2079971730709076, -0.22093339264392853, -0.23393109440803528, -0.23378834128379822, -0.23103104531764984, -0.2308650016784668, -0.2469182312488556, -0.25977060198783875, -0.23528940975666046, -0.24907590448856354, -0.23370128870010376, -0.24748089909553528, -0.26062941551208496, -0.27631673216819763, -0.28155356645584106, -0.295131117105484, -0.30160078406333923, -0.32276350259780884, -0.2946755886077881, -0.3136536180973053, -0.3281022608280182, -0.3320992588996887, -0.32619571685791016, -0.3349888026714325, -0.32266324758529663, -0.30513155460357666, -0.3078603744506836, -0.3301107585430145, -0.310000479221344, -0.32387611269950867, -0.3327893018722534, -0.33535805344581604, -0.3386552333831787, -0.3618668019771576, -0.3662225008010864, -0.36403489112854004, -0.3659358620643616, -0.3947874903678894, -0.37527766823768616, -0.37795355916023254, -0.36816203594207764, -0.37994205951690674, -0.39855146408081055, -0.41495028138160706, -0.4111761748790741, -0.4142557382583618, -0.42112207412719727, -0.4344463050365448, -0.4427798092365265, -0.44127601385116577, -0.43155696988105774, -0.42277631163597107, -0.43253132700920105, -0.42888954281806946, -0.41787001490592957, -0.41722890734672546, -0.42239126563072205, -0.4262726604938507, -0.4784427583217621, -0.45627936720848083, -0.43422508239746094, -0.4247127175331116, -0.4172806739807129, -0.3976479768753052, -0.3769092559814453, -0.34507566690444946, -0.33542153239250183, -0.3227820098400116, -0.4439353346824646, -0.4121297597885132, -0.40160712599754333, -0.38020411133766174, -0.35073772072792053, -0.3322443962097168, -0.3319059908390045, -0.30338624119758606, -0.2898748219013214, -0.2595629096031189, -0.23639941215515137, -0.2061631828546524, -0.18237322568893433, -0.16251102089881897, -0.14958854019641876, -0.14571331441402435, -0.13564884662628174, -0.13172563910484314, -0.12014295160770416, -0.10216920077800751, -0.13844312727451324, -0.12780870497226715, -0.1273965686559677, -0.10773833096027374, -0.09418915212154388, -0.06473635137081146, -0.059279631823301315, -0.04473289102315903, -0.02751457318663597, -0.016528882086277008, -0.020645439624786377, -0.02289222925901413, -0.021631065756082535, -0.034590575844049454, -0.03705475479364395, -0.030952339991927147, -0.026156557723879814, -0.030026642605662346, -0.01953856460750103, 0.005601189099252224, 0.017097579315304756, 0.03258081153035164, 0.04171622544527054, 0.05490030348300934, 0.052863024175167084, 0.061989787966012955, 0.05834159255027771, 0.06294253468513489, 0.057459086179733276, 0.04823530092835426, 0.07624819129705429, 0.06876273453235626, 0.07204025238752365, 0.06232183799147606, 0.06867577135562897, 0.07293083518743515, 0.07425341755151749, 0.07484757155179977, 0.09509958326816559, 0.09692873060703278, 0.13381612300872803, 0.1580311357975006, 0.16066305339336395, 0.1689956784248352, 0.18178901076316833, 0.17214643955230713, 0.17714428901672363, 0.17916856706142426, 0.17766937613487244, 0.17932270467281342, 0.18542563915252686, 0.1833236664533615, 0.20358377695083618, 0.20039573311805725, 0.22146369516849518, 0.2516169846057892, 0.25066694617271423, 0.2746516764163971, 0.2838258147239685, 0.3093244731426239, 0.3018307089805603, 0.3083631098270416, 0.2986799478530884, 0.3080604076385498, 0.3195505440235138, 0.3003411293029785, 0.31168264150619507, 0.319240927696228, 0.3037497401237488, 0.3059619963169098, 0.36220091581344604, 0.37614038586616516, 0.3742062747478485, 0.3756755590438843, 0.35726162791252136, 0.34662413597106934, 0.3415432274341583, 0.3243165612220764, 0.31690627336502075, 0.3427478075027466]))

    def test_3DImg_with_pad(self):
        return_new = fu.filt_gaussh(IMAGE_3D,sigma= 0.23, pad=True )
        return_old = oldfu.filt_gaussh(IMAGE_3D,sigma= 0.23, pad=True )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal( return_old.get_3dview().flatten(),[0.2415570765733719, 0.22787649929523468, 0.21794480085372925, 0.2317361831665039, 0.22769847512245178, 0.2248971164226532, 0.2243889421224594, 0.23574426770210266, 0.23868322372436523, 0.2799983620643616, 0.2633495032787323, 0.20811079442501068, 0.206039696931839, 0.19239771366119385, 0.19403256475925446, 0.22524918615818024, 0.21158312261104584, 0.21945041418075562, 0.2412583976984024, 0.2759961783885956, 0.27003589272499084, 0.22840525209903717, 0.23905566334724426, 0.23220711946487427, 0.23771320283412933, 0.2405509054660797, 0.24311429262161255, 0.2680978775024414, 0.2514614164829254, 0.2636648416519165, 0.2707938551902771, 0.2547610402107239, 0.2503013610839844, 0.24190713465213776, 0.2685048282146454, 0.29178884625434875, 0.2642733156681061, 0.24252666532993317, 0.2509046196937561, 0.2881337106227875, 0.262481153011322, 0.2317550778388977, 0.2446335256099701, 0.23336710035800934, 0.2444017231464386, 0.2232050597667694, 0.22068673372268677, 0.22374244034290314, 0.23002761602401733, 0.22439514100551605, 0.23657982051372528, 0.22186234593391418, 0.1962646245956421, 0.20740284025669098, 0.20648078620433807, 0.2063101977109909, 0.21685214340686798, 0.2024959772825241, 0.20986168086528778, 0.2100479155778885, 0.2063969224691391, 0.19331061840057373, 0.19454725086688995, 0.18783530592918396, 0.17829187214374542, 0.1700994074344635, 0.19153465330600739, 0.19614680111408234, 0.18004292249679565, 0.1437537670135498, 0.12452681362628937, 0.15530219674110413, 0.13914358615875244, 0.13713093101978302, 0.14177852869033813, 0.14284202456474304, 0.11420062929391861, 0.1275421679019928, 0.12440219521522522, 0.08763918280601501, 0.09521045535802841, 0.15659819543361664, 0.1520877629518509, 0.15429945290088654, 0.13028591871261597, 0.11502488702535629, 0.127625972032547, 0.10386838018894196, 0.10288756340742111, 0.024323945865035057, 0.0014514208305627108, 0.03318442776799202, 0.01719767041504383, 0.01906014233827591, 0.031823351979255676, 0.03887054696679115, 0.03583228588104248, 0.047380585223436356, 0.03242064267396927, 0.006728611420840025, -0.06185395270586014, -0.08597283810377121, -0.07351065427064896, -0.08116760104894638, -0.07697875797748566, -0.060986652970314026, -0.07351445406675339, -0.07896243035793304, -0.09107931703329086, -0.09016070514917374, -0.08388089388608932, -0.07513992488384247, -0.08447639644145966, -0.09672200679779053, -0.13161499798297882, -0.15330170094966888, -0.15825675427913666, -0.1631845086812973, -0.17041437327861786, -0.1950565129518509, -0.18840451538562775, -0.17890341579914093, -0.1785239279270172, -0.14969293773174286, -0.15400351583957672, -0.16135217249393463, -0.15918327867984772, -0.14896753430366516, -0.151437446475029, -0.16416135430335999, -0.16628922522068024, -0.17898957431316376, -0.17398224771022797, -0.18169058859348297, -0.1855825036764145, -0.20221738517284393, -0.1915929913520813, -0.2015962451696396, -0.21886396408081055, -0.24874626100063324, -0.24601005017757416, -0.22766251862049103, -0.2397509515285492, -0.23899219930171967, -0.25136685371398926, -0.2574372887611389, -0.26460736989974976, -0.2698524296283722, -0.2721234858036041, -0.32176241278648376, -0.32262757420539856, -0.27453577518463135, -0.28052398562431335, -0.2830718457698822, -0.2839736044406891, -0.2977279722690582, -0.29976698756217957, -0.29970431327819824, -0.3029171824455261, -0.3763257563114166, -0.37443891167640686, -0.30308035016059875, -0.3061339259147644, -0.3125908374786377, -0.31928128004074097, -0.32102614641189575, -0.33476722240448, -0.37326672673225403, -0.3872048258781433, -0.4814192056655884, -0.49310940504074097, -0.42513370513916016, -0.43722671270370483, -0.4423646628856659, -0.43441662192344666, -0.4171781837940216, -0.4090934693813324, -0.40394848585128784, -0.39188969135284424, -0.4691365659236908, -0.46621736884117126, -0.3983302414417267, -0.3919055461883545, -0.3841899037361145, -0.37276965379714966, -0.3658071756362915, -0.3699862062931061, -0.3515925407409668, -0.35231155157089233, -0.4146878719329834, -0.44139906764030457, -0.37217581272125244, -0.3549835979938507, -0.34864342212677, -0.3352908194065094, -0.3155445158481598, -0.3079080879688263, -0.30125129222869873, -0.28254440426826477, -0.3018169105052948, -0.3291836082935333, -0.28010326623916626, -0.2753260135650635, -0.26747989654541016, -0.26168519258499146, -0.2623571455478668, -0.26715579628944397, -0.24551650881767273, -0.21368110179901123, -0.19256141781806946, -0.1304354965686798, -0.09705352038145065, -0.057708073407411575, -0.03133658692240715, -0.02592037059366703, -0.015306972898542881, -0.014333886094391346, -0.03019706904888153, -0.04061218351125717, -0.05989067256450653, -0.06666428595781326, -0.06574426591396332, -0.07408961653709412, -0.06645678728818893, -0.05458289757370949, -0.03537483513355255, -0.034123919904232025, -0.017850177362561226, -0.023710718378424644, -0.025296833366155624, -0.019655754789710045, 0.004887028131633997, 0.026499055325984955, 0.029018012806773186, 0.03152937814593315, 0.020362142473459244, 0.035874515771865845, 0.025259025394916534, 0.03126607462763786, 0.044695835560560226, 0.0450066402554512, 0.04182202368974686, 0.029480203986167908, 0.013188811019062996, 0.0013903399230912328, 0.015793845057487488, 0.015659119933843613, 0.019793426617980003, 0.033195968717336655, 0.04722576215863228, 0.04558584466576576, 0.029805034399032593, 0.036808643490076065, 0.048728134483098984, 0.04282002151012421, 0.048047225922346115, 0.06739787757396698, 0.0663793683052063, 0.0847591906785965, 0.09246936440467834, 0.09083405137062073, 0.09107384085655212, 0.09599501639604568, 0.11129362881183624, 0.1219930499792099, 0.12400932610034943, 0.1301281452178955, 0.14118486642837524, 0.1294761747121811, 0.15488645434379578, 0.14882776141166687, 0.13147836923599243, 0.15931473672389984, 0.15666086971759796, 0.1568227857351303, 0.17427176237106323, 0.16890785098075867, 0.17350751161575317, 0.17415522038936615, 0.1842796504497528, 0.19887299835681915, 0.20364996790885925, 0.18434368073940277, 0.18064378201961517, 0.19237124919891357, 0.17785818874835968, 0.17601199448108673, 0.18368543684482574, 0.19818714261054993, 0.21281106770038605, 0.2292875498533249, 0.21123509109020233, 0.1984068751335144, 0.19852063059806824, 0.19122222065925598, 0.18306666612625122, 0.179160013794899, 0.19403289258480072, 0.1822957545518875, 0.190956249833107, 0.19759277999401093, 0.16755259037017822, 0.17549867928028107, 0.16092218458652496, 0.19221533834934235, 0.17099778354167938, 0.16954822838306427, 0.17116601765155792, 0.14818769693374634, 0.18931277096271515, 0.1477588713169098, 0.1310931146144867, 0.11540913581848145, 0.09430485963821411, 0.10418730974197388, 0.11454658955335617, 0.1136283129453659, 0.11586128920316696, 0.09836269170045853, 0.15549008548259735, 0.14537127315998077, 0.08701151609420776, 0.10533853620290756, 0.12475048750638962, 0.11531572043895721, 0.11016775667667389, 0.10736699402332306, 0.11388737708330154, 0.12288646399974823, 0.13666902482509613, 0.14570699632167816, 0.12737606465816498, 0.13117465376853943, 0.1244463101029396, 0.13826856017112732, 0.1396719217300415, 0.12328804284334183, 0.1395813226699829, 0.1360522210597992, 0.1516665667295456, 0.16442233324050903, 0.1500023603439331, 0.14080381393432617, 0.1443403661251068, 0.18552781641483307, 0.15736371278762817, 0.1513635367155075, 0.15372371673583984, 0.14838607609272003, 0.19106116890907288, 0.2030622959136963, 0.16551747918128967, 0.1787559539079666, 0.17539013922214508, 0.1685565859079361, 0.18084931373596191, 0.1762225329875946, 0.18215106427669525, 0.17931854724884033, 0.21359671652317047, 0.2268560826778412, 0.19243399798870087, 0.18724068999290466, 0.19420573115348816, 0.2003883421421051, 0.1798272281885147, 0.16465748846530914, 0.1765993982553482, 0.1908748894929886, 0.21561825275421143, 0.2271733283996582, 0.20914272964000702, 0.19882382452487946, 0.20600025355815887, 0.2093990594148636, 0.19291137158870697, 0.20605097711086273, 0.20244266092777252, 0.2004111111164093, 0.26064568758010864, 0.2580636143684387, 0.21386456489562988, 0.2014400213956833, 0.18953295052051544, 0.19204404950141907, 0.21923331916332245, 0.22059254348278046, 0.22519870102405548, 0.20079347491264343, 0.24712571501731873, 0.26065826416015625, 0.2039661705493927, 0.2202490270137787, 0.23120209574699402, 0.21860679984092712, 0.21113985776901245, 0.21683862805366516, 0.19692933559417725, 0.2025155872106552, 0.20336532592773438, 0.24192097783088684, 0.21298405528068542, 0.22237902879714966, 0.2188441902399063, 0.19081327319145203, 0.19125980138778687, 0.17513525485992432, 0.18191657960414886, 0.18972815573215485, 0.17972153425216675, 0.16003242135047913, 0.16567730903625488, 0.1538921296596527, 0.14980731904506683, 0.15509198606014252, 0.13017642498016357, 0.13917335867881775, 0.1321692019701004, 0.13357196748256683, 0.11099619418382645, 0.11610627174377441, 0.11676588654518127, 0.11214755475521088, 0.12797707319259644, 0.09483638405799866, 0.11165866255760193, 0.11574207246303558, 0.09785395115613937, 0.10056234896183014, 0.07321044057607651, 0.05719730630517006, 0.09520518779754639, 0.08210383355617523, 0.08994055539369583, 0.07893471419811249, 0.06381471455097198, 0.0704055204987526, 0.06166207417845726, 0.05527331680059433, 0.018777979537844658, 0.01584327220916748, 0.018865210935473442, 0.007569518405944109, -0.003295385744422674, -0.002635553013533354, -0.002228708937764168, -0.018555039539933205, -0.01102643646299839, 0.003719495376572013, -0.02429407648742199, -0.04024052619934082, -0.02206972986459732, -0.02694890648126602, -0.044421907514333725, -0.048228196799755096, -0.046315569430589676, -0.04203476756811142, -0.045522212982177734, -0.0431227833032608, -0.05994885414838791, -0.06775641441345215, -0.06168442219495773, -0.08260780572891235, -0.08653061091899872, -0.10650912672281265, -0.09857954829931259, -0.09836353361606598, -0.12153857946395874, -0.13367627561092377, -0.1695709526538849, -0.17912748456001282, -0.15440665185451508, -0.16706424951553345, -0.16273508965969086, -0.1518670618534088, -0.16053049266338348, -0.17149367928504944, -0.16669079661369324, -0.16385787725448608, -0.16617481410503387, -0.182957723736763, -0.20037968456745148, -0.19512076675891876, -0.2078131139278412, -0.2192351520061493, -0.23625974357128143, -0.2266622632741928, -0.22515755891799927, -0.23154623806476593, -0.26012542843818665, -0.2903258800506592, -0.28263694047927856, -0.2925874590873718, -0.30477073788642883, -0.30642765760421753, -0.31275343894958496, -0.3225233852863312, -0.3299870789051056, -0.3492816686630249, -0.38364630937576294, -0.3644023835659027, -0.3370336592197418, -0.3356286883354187, -0.3320126533508301, -0.3275775909423828, -0.3363169729709625, -0.3474193811416626, -0.3426434397697449, -0.33755335211753845, -0.39430031180381775, -0.370474249124527, -0.3153221011161804, -0.32893434166908264, -0.3309822380542755, -0.3276073634624481, -0.3332759141921997, -0.344635009765625, -0.3624577522277832, -0.363875150680542, -0.4464171230792999, -0.4497874081134796, -0.39616331458091736, -0.4042867124080658, -0.4188437759876251, -0.4340616762638092, -0.44180378317832947, -0.4512612521648407, -0.4479057490825653, -0.4313056766986847, -0.5006082057952881, -0.5015836358070374, -0.41636180877685547, -0.40944424271583557, -0.4177582561969757, -0.42141827940940857, -0.4157388508319855, -0.40919867157936096, -0.40114590525627136, -0.38993456959724426, -0.46824368834495544, -0.4606749415397644, -0.3805762529373169, -0.3688361346721649, -0.3337099552154541, -0.31750810146331787, -0.2987107038497925, -0.29677820205688477, -0.29635828733444214, -0.28331702947616577, -0.3348817825317383, -0.3255065977573395, -0.25060299038887024, -0.23637467622756958, -0.21244129538536072, -0.20169085264205933, -0.1984899640083313, -0.20063184201717377, -0.19603687524795532, -0.19019854068756104, -0.20443275570869446, -0.19326496124267578, -0.13933365046977997, -0.10753826797008514, -0.09204269200563431, -0.07530467212200165, -0.07040130347013474, -0.05605141818523407, -0.054665375500917435, -0.037489697337150574, -0.045197002589702606, -0.04899602755904198, -0.047019969671964645, -0.05448153242468834, -0.042284365743398666, -0.042193710803985596, -0.02140403911471367, -0.031848032027482986, -0.04379606246948242, -0.02797858603298664, -0.02011910453438759, -0.012233700603246689, -0.0003398676053620875, 0.01725156605243683, 0.014822212047874928, -0.001979467226192355, 0.006750460714101791, 0.03335512802004814, 0.020016400143504143, 0.01736479252576828, 0.037863656878471375, 0.027426430955529213, 0.03241836652159691, 0.04179931804537773, 0.04786444082856178, 0.03635865077376366, 0.02670888602733612, 0.017965441569685936, 0.023631924763321877, 0.031827930361032486, 0.04569564387202263, 0.05432363972067833, 0.05250042304396629, 0.04890991002321243, 0.03756674379110336, 0.030009957030415535, 0.02219078503549099, 0.040450647473335266, 0.03914489224553108, 0.07132524251937866, 0.08085720241069794, 0.09247113019227982, 0.10603635013103485, 0.09727147966623306, 0.11545979976654053, 0.13168200850486755, 0.10924570262432098, 0.11239879578351974, 0.11980105936527252, 0.1167168840765953, 0.13062281906604767, 0.10841258615255356, 0.10303837805986404, 0.12162476778030396, 0.12273172289133072, 0.15650084614753723, 0.17288616299629211, 0.17794932425022125, 0.2030467689037323, 0.17635269463062286, 0.20746269822120667, 0.2084527164697647, 0.19225002825260162, 0.2208218276500702, 0.21157053112983704, 0.20128574967384338, 0.2178136110305786, 0.19493509829044342, 0.17698846757411957, 0.1939447671175003, 0.21086663007736206, 0.22255416214466095, 0.1932974010705948, 0.1900467574596405, 0.19010303914546967, 0.17271555960178375, 0.17148742079734802, 0.16697031259536743, 0.17735907435417175, 0.1747191846370697, 0.20030581951141357, 0.1971205472946167, 0.15117131173610687, 0.15524205565452576, 0.1329755336046219, 0.14727239310741425, 0.141607403755188, 0.13066376745700836, 0.14913423359394073, 0.1404048055410385, 0.16495907306671143, 0.15733756124973297, 0.12730495631694794, 0.13314282894134521, 0.14167222380638123, 0.1151534914970398, 0.1015542671084404, 0.11557529121637344, 0.10712391883134842, 0.11827791482210159, 0.13537827134132385, 0.13240885734558105, 0.11582327634096146, 0.08901724219322205, 0.10123258084058762, 0.10359304398298264, 0.09544236958026886, 0.11940997838973999, 0.14056697487831116, 0.128155916929245, 0.13806921243667603, 0.13879886269569397, 0.11382249742746353, 0.11059349775314331, 0.1195434182882309, 0.12152305245399475, 0.14015287160873413, 0.14875489473342896, 0.14444005489349365, 0.13852344453334808, 0.1639920175075531, 0.18079212307929993, 0.16460773348808289, 0.18377692997455597, 0.19223694503307343, 0.1936575025320053, 0.1796722263097763, 0.19647690653800964, 0.19433079659938812, 0.21012930572032928, 0.23583576083183289, 0.2087244987487793, 0.20269300043582916, 0.20957614481449127, 0.19325517117977142, 0.21379855275154114, 0.20921625196933746, 0.22184760868549347, 0.21832172572612762, 0.21792253851890564, 0.24817152321338654, 0.23307569324970245, 0.17273569107055664, 0.1756848394870758, 0.19519394636154175, 0.19048826396465302, 0.19718635082244873, 0.20475278794765472, 0.20091214776039124, 0.186613991856575, 0.22278913855552673, 0.24386996030807495, 0.1987612396478653, 0.20104025304317474, 0.1911005973815918, 0.19637882709503174, 0.21127334237098694, 0.20558258891105652, 0.19219212234020233, 0.21213804185390472, 0.27351245284080505, 0.2618415355682373, 0.21380886435508728, 0.22124341130256653, 0.21820002794265747, 0.20336595177650452, 0.20107536017894745, 0.20810557901859283, 0.22328601777553558, 0.20962241291999817, 0.26698026061058044, 0.24560843408107758, 0.2259865254163742, 0.2147858440876007, 0.18246978521347046, 0.21158066391944885, 0.22430674731731415, 0.22084522247314453, 0.19783496856689453, 0.2153734266757965, 0.23185110092163086, 0.23230844736099243, 0.18973654508590698, 0.1900561898946762, 0.1901971399784088, 0.1808130145072937, 0.18517740070819855, 0.19165998697280884, 0.17894446849822998, 0.156606525182724, 0.16737030446529388, 0.17021669447422028, 0.1789689064025879, 0.18291567265987396, 0.1724315881729126, 0.16294333338737488, 0.16809919476509094, 0.16631098091602325, 0.13905920088291168, 0.13973087072372437, 0.12355230003595352, 0.11867180466651917, 0.12222348898649216, 0.1269422024488449, 0.13000208139419556, 0.12852060794830322, 0.13179489970207214, 0.11336719989776611, 0.11505736410617828, 0.12258478999137878, 0.07943101972341537, 0.08456689119338989, 0.11959893256425858, 0.10853849351406097, 0.09960310906171799, 0.0909145399928093, 0.08630724251270294, 0.08892741799354553, 0.05608497932553291, 0.060523103922605515, 0.03348582610487938, 0.008883384987711906, 0.04862602427601814, 0.03310674428939819, 0.030205300077795982, 0.01601860113441944, 0.004717857576906681, -0.0123682152479887, -0.02641671895980835, -0.016477758064866066, -0.03222508355975151, -0.04488465189933777, -0.03722979873418808, -0.04460205137729645, -0.06553790718317032, -0.07655808329582214, -0.06649995595216751, -0.08302921801805496, -0.07375968992710114, -0.06574848294258118, -0.08663145452737808, -0.0603044293820858, -0.052889078855514526, -0.07143844664096832, -0.07188646495342255, -0.08010846376419067, -0.09533984959125519, -0.0970580205321312, -0.10292766243219376, -0.11183208227157593, -0.14107586443424225, -0.14416027069091797, -0.1112455502152443, -0.11828000098466873, -0.11573433130979538, -0.13782113790512085, -0.14290250837802887, -0.14218799769878387, -0.15972881019115448, -0.1613292247056961, -0.1846136897802353, -0.20435093343257904, -0.21844877302646637, -0.20863938331604004, -0.22110480070114136, -0.23434016108512878, -0.23414698243141174, -0.231469988822937, -0.23156654834747314, -0.24794797599315643, -0.2771015763282776, -0.2822287082672119, -0.2513819932937622, -0.23576590418815613, -0.2486625611782074, -0.26221105456352234, -0.2777608036994934, -0.28299370408058167, -0.2969484329223633, -0.3038545846939087, -0.35413461923599243, -0.35961851477622986, -0.3159714639186859, -0.3300454318523407, -0.3329298496246338, -0.32757070660591125, -0.3362494111061096, -0.3238948583602905, -0.30712923407554626, -0.31042858958244324, -0.379131555557251, -0.3923994302749634, -0.3271566331386566, -0.335582971572876, -0.3367803394794464, -0.3407372534275055, -0.3638278841972351, -0.36796122789382935, -0.3667966425418854, -0.36937227845191956, -0.4624422788619995, -0.4678993225097656, -0.3820499777793884, -0.37166833877563477, -0.38199740648269653, -0.4011642038822174, -0.41737380623817444, -0.41315510869026184, -0.41748178005218506, -0.42499038577079773, -0.5192685723304749, -0.533075213432312, -0.4457111358642578, -0.43529409170150757, -0.42509040236473083, -0.43527066707611084, -0.4315379858016968, -0.41979238390922546, -0.4205326735973358, -0.42635416984558105, -0.5202823281288147, -0.5651051998138428, -0.4873751699924469, -0.4646666944026947, -0.4543892443180084, -0.4449065625667572, -0.4225280284881592, -0.39922580122947693, -0.36563512682914734, -0.35411304235458374, -0.4152369201183319, -0.4248708188533783, -0.36083871126174927, -0.34863734245300293, -0.3252858519554138, -0.2946048080921173, -0.27448397874832153, -0.2711068391799927, -0.2408517301082611, -0.2252575010061264, -0.25283005833625793, -0.18046891689300537, -0.12186801433563232, -0.09825894981622696, -0.07867944985628128, -0.06500044465065002, -0.059262797236442566, -0.047971513122320175, -0.04325442761182785, -0.030842119827866554, -0.06591986119747162, -0.06595274806022644, -0.038790684193372726, -0.037678543478250504, -0.017819328233599663, -0.002362351631745696, 0.029041601344943047, 0.03473389521241188, 0.04890007898211479, 0.06425879150629044, 0.042227476835250854, 0.04847750812768936, 0.06446869671344757, 0.06637915223836899, 0.05380982160568237, 0.05369763821363449, 0.060591354966163635, 0.06236909329891205, 0.05508511886000633, 0.063240185379982, 0.0697859674692154, 0.06945380568504333, 0.10699999332427979, 0.11511335521936417, 0.12773694097995758, 0.12547196447849274, 0.13292062282562256, 0.12614469230175018, 0.1279553323984146, 0.12068304419517517, 0.09687981009483337, 0.10630393028259277, 0.12216769903898239, 0.12206660956144333, 0.11108569800853729, 0.11553428322076797, 0.11815941333770752, 0.11865855753421783, 0.11715810000896454, 0.13500922918319702, 0.12060052901506424, 0.14265181124210358, 0.18729975819587708, 0.18623052537441254, 0.19242031872272491, 0.20291660726070404, 0.19208753108978271, 0.19704657793045044, 0.19769230484962463, 0.19298706948757172, 0.1766926646232605, 0.1750159114599228, 0.18762058019638062, 0.20537015795707703, 0.20035214722156525, 0.21991708874702454, 0.24856775999069214, 0.2462981790304184, 0.26924633979797363, 0.2761027216911316, 0.2830449342727661, 0.28192049264907837, 0.29741501808166504, 0.2867642939090729, 0.2952323853969574, 0.30555468797683716, 0.28552478551864624, 0.2966875731945038, 0.3031079173088074, 0.2852826416492462, 0.2739609479904175, 0.2884334325790405, 0.29621100425720215, 0.29570144414901733, 0.30082765221595764, 0.2887086868286133, 0.28309714794158936, 0.2826400399208069, 0.27056995034217834, 0.2660115659236908, 0.2791249454021454] ))

    def test_3DImgBlank_without_pad(self):
        return_new = fu.filt_gaussh(IMAGE_BLANK_3D,sigma= 0.23, pad=False )
        return_old = oldfu.filt_gaussh(IMAGE_BLANK_3D,sigma= 0.23, pad=False )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview(), IMAGE_BLANK_3D.get_3dview()))

    def test_3DImgBlank_with_pad(self):
        return_new = fu.filt_gaussh(IMAGE_BLANK_3D,sigma= 0.23, pad=True )
        return_old = oldfu.filt_gaussh(IMAGE_BLANK_3D,sigma= 0.23, pad=True )
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview(), IMAGE_BLANK_3D.get_3dview()))



class Test_filt_btwl(unittest.TestCase):

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_btwl()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_btwl()
        self.assertEqual(str(cm_new.exception), "filt_btwl() takes at least 3 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError) as cm_new:
            fu.filt_btwl(EMData(), freql=0.25, freqh=0.35)
        with self.assertRaises(RuntimeError) as cm_old:
            oldfu.filt_btwl(EMData(), freql=0.25, freqh=0.35)
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_NoneType_Img(self):
        return_new =  fu.filt_btwl(None,  freql=0.25, freqh=0.35, pad=False )
        return_old = oldfu.filt_btwl(None,  freql=0.25, freqh=0.35, pad=False )
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_2DImg_without_pad(self):
        return_new = fu.filt_btwl(IMAGE_2D, freql=0.25, freqh=0.35, pad=False)
        return_old = oldfu.filt_btwl(IMAGE_2D, freql=0.25, freqh=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview().flatten(),[-0.07504992187023163, -0.08603660762310028, -0.09136059880256653, -0.09139658510684967, -0.08717329055070877, -0.0809982493519783, -0.07124587893486023, -0.0577787347137928, -0.05127313360571861, -0.05966832861304283, 0.0971849113702774, 0.08685988932847977, 0.08162995427846909, 0.08100190758705139, 0.08645650744438171, 0.094615638256073, 0.10389554500579834, 0.11608454585075378, 0.12154355645179749, 0.1122218668460846, 0.09626360982656479, 0.09801000356674194, 0.09913663566112518, 0.10285501182079315, 0.11306262761354446, 0.12128811329603195, 0.12160741537809372, 0.11830968409776688, 0.11025598645210266, 0.09983482211828232, 0.043056078255176544, 0.05748694762587547, 0.060629088431596756, 0.06444347649812698, 0.07483186572790146, 0.07809076458215714, 0.06594899296760559, 0.046439673751592636, 0.029517358168959618, 0.02738555148243904, -0.010716120712459087, 0.007479444146156311, 0.0006693291361443698, -0.006320240441709757, -0.004207384306937456, -0.006106553133577108, -0.020361073315143585, -0.04218437895178795, -0.05732657387852669, -0.04516030102968216, -0.08199984580278397, -0.06655863672494888, -0.08710207790136337, -0.10756398737430573, -0.11383286118507385, -0.1147523745894432, -0.12052162736654282, -0.13608390092849731, -0.1479072868824005, -0.1267903745174408, -0.19483579695224762, -0.178532674908638, -0.20191331207752228, -0.22737044095993042, -0.23722562193870544, -0.23668141663074493, -0.237070232629776, -0.24917958676815033, -0.2623066008090973, -0.24195058643817902, -0.34672781825065613, -0.3253237009048462, -0.33851519227027893, -0.35765042901039124, -0.36657658219337463, -0.36798012256622314, -0.37041738629341125, -0.3834787905216217, -0.4000598192214966, -0.3880919814109802, -0.4493255019187927, -0.4311024248600006, -0.43340396881103516, -0.4410686790943146, -0.44465765357017517, -0.44526156783103943, -0.44690656661987305, -0.4568049907684326, -0.47293055057525635, -0.47313621640205383, -0.3467840552330017, -0.3445681929588318, -0.345713347196579, -0.34574487805366516, -0.3429153859615326, -0.3392355144023895, -0.33453822135925293, -0.33237218856811523, -0.33820703625679016, -0.3461339771747589] ))

    def test_2DImg_with_pad(self):
        return_new = fu.filt_btwl(IMAGE_2D, freql=0.25, freqh=0.35, pad=True)
        return_old = oldfu.filt_btwl(IMAGE_2D, freql=0.25, freqh=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview().flatten(), [-0.05060963332653046, -0.006589336320757866, -0.015198984183371067, -0.025402292609214783, -0.02055746503174305, -0.018414607271552086, -0.01808733493089676, 3.482818647171371e-05, 0.01464084628969431, -0.03330744802951813, 0.01373490784317255, 0.08154470473527908, 0.07105790823698044, 0.055916108191013336, 0.06497696042060852, 0.07394633442163467, 0.07863999903202057, 0.1014246791601181, 0.11154595017433167, 0.03276102617383003, 0.027804182842373848, 0.10497672855854034, 0.09680335968732834, 0.08487437665462494, 0.09997926652431488, 0.10990769416093826, 0.10723480582237244, 0.11923793703317642, 0.11938129365444183, 0.03278109431266785, 0.010562019422650337, 0.08316224813461304, 0.07689599692821503, 0.068028025329113, 0.08230666816234589, 0.08502316474914551, 0.06919074058532715, 0.06531123071908951, 0.05881165713071823, -0.011866835877299309, -0.02888665534555912, 0.022346219047904015, 0.010662421584129333, -0.0028591917362064123, 0.0009663295350037515, -0.0033897971734404564, -0.0204408448189497, -0.029630474746227264, -0.037567272782325745, -0.07983811944723129, -0.09131082147359848, -0.07317982614040375, -0.0920293778181076, -0.11077222228050232, -0.11730023473501205, -0.12134658545255661, -0.1277662068605423, -0.13645045459270477, -0.14757193624973297, -0.15911269187927246, -0.17893058061599731, -0.1967933028936386, -0.21449464559555054, -0.2295597940683365, -0.2403998076915741, -0.24317558109760284, -0.24335713684558868, -0.25657936930656433, -0.2735765278339386, -0.25220903754234314, -0.2824108898639679, -0.33340418338775635, -0.3435385823249817, -0.34705355763435364, -0.3565574586391449, -0.3604845404624939, -0.36262792348861694, -0.38357871770858765, -0.40252119302749634, -0.3476358652114868, -0.35641464591026306, -0.4281788468360901, -0.432278037071228, -0.42506709694862366, -0.4290293753147125, -0.42978423833847046, -0.42972299456596375, -0.45057234168052673, -0.4658486545085907, -0.3936866819858551, -0.3330516815185547, -0.394421249628067, -0.3938653767108917, -0.3831389844417572, -0.38178327679634094, -0.37652644515037537, -0.369404137134552, -0.3807641267776489, -0.3917229473590851, -0.336283415555954]))

    def test_2DImgBlank_without_pad(self):
        return_new = fu.filt_btwl(IMAGE_BLANK_2D, freql=0.25, freqh=0.35, pad=False)
        return_old = oldfu.filt_btwl(IMAGE_BLANK_2D, freql=0.25, freqh=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview(), IMAGE_BLANK_2D.get_2dview()))

    def test_2DImgBlank_with_pad(self):
        return_new = fu.filt_btwl(IMAGE_BLANK_2D, freql=0.25, freqh=0.35, pad=True)
        return_old = oldfu.filt_btwl(IMAGE_BLANK_2D, freql=0.25, freqh=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview(), IMAGE_BLANK_2D.get_2dview()))

    def test_3DImg_without_pad(self):
        return_new = fu.filt_btwl(IMAGE_3D, freql=0.25, freqh=0.35, pad=False)
        return_old = oldfu.filt_btwl(IMAGE_3D, freql=0.25, freqh=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview().flatten(), [-0.4030480980873108, -0.4238395392894745, -0.4166428744792938, -0.40136733651161194, -0.3922419250011444, -0.3877246081829071, -0.3777849078178406, -0.35850659012794495, -0.3462834656238556, -0.364291787147522, -0.3265821039676666, -0.3426152169704437, -0.33414945006370544, -0.3187229335308075, -0.3084774613380432, -0.3025023937225342, -0.2939481735229492, -0.280058890581131, -0.274156779050827, -0.29327282309532166, -0.2796611785888672, -0.2847301661968231, -0.2772330641746521, -0.26603132486343384, -0.2565120458602905, -0.24996495246887207, -0.24584852159023285, -0.24353790283203125, -0.2479223608970642, -0.26285573840141296, -0.2754918038845062, -0.26611071825027466, -0.26366645097732544, -0.2636730670928955, -0.2614506781101227, -0.2598830461502075, -0.2642853558063507, -0.2745463252067566, -0.284705251455307, -0.28548362851142883, -0.31843653321266174, -0.2994158864021301, -0.3044570982456207, -0.31683486700057983, -0.32370948791503906, -0.3277246952056885, -0.3371470868587494, -0.3532392084598541, -0.3638830780982971, -0.3506752550601959, -0.3927972614765167, -0.373867005109787, -0.3841286897659302, -0.40139099955558777, -0.41034287214279175, -0.4134429395198822, -0.4204452335834503, -0.43554067611694336, -0.4460740089416504, -0.4298282265663147, -0.472241073846817, -0.46046075224876404, -0.46997708082199097, -0.48275622725486755, -0.4866187274456024, -0.48439469933509827, -0.485330194234848, -0.4950670897960663, -0.505395770072937, -0.4971122741699219, -0.52553391456604, -0.5241550803184509, -0.5286242961883545, -0.5320227146148682, -0.5294466614723206, -0.5231510996818542, -0.5181107521057129, -0.5188160538673401, -0.5252960324287415, -0.5289158225059509, -0.5283990502357483, -0.5369111895561218, -0.5354709625244141, -0.5297470688819885, -0.523636519908905, -0.5171698331832886, -0.5082786083221436, -0.49931570887565613, -0.4987197518348694, -0.5113214254379272, -0.4817526638507843, -0.4991436302661896, -0.49392107129096985, -0.48173990845680237, -0.4737015962600708, -0.4685359299182892, -0.4581981897354126, -0.4413423240184784, -0.4324205815792084, -0.4490148723125458, -0.4548894762992859, -0.46956634521484375, -0.4627697169780731, -0.44987568259239197, -0.4429781138896942, -0.44167885184288025, -0.43774524331092834, -0.425979346036911, -0.4167608320713043, -0.4278745949268341, -0.38482367992401123, -0.3920336365699768, -0.38051125407218933, -0.3649669885635376, -0.35761016607284546, -0.35756558179855347, -0.35732710361480713, -0.3527293801307678, -0.3515457212924957, -0.3644898533821106, -0.3460265100002289, -0.3456503748893738, -0.33411848545074463, -0.32031527161598206, -0.3125684857368469, -0.311572402715683, -0.3135416805744171, -0.31668397784233093, -0.3239194452762604, -0.3359416723251343, -0.3488175570964813, -0.3388868570327759, -0.3335902988910675, -0.33069610595703125, -0.32998114824295044, -0.33303362131118774, -0.3401847779750824, -0.350248247385025, -0.35921019315719604, -0.35909560322761536, -0.40279409289360046, -0.3858692944049835, -0.3888169825077057, -0.39852479100227356, -0.40684542059898376, -0.41493356227874756, -0.42592671513557434, -0.43901944160461426, -0.4454743266105652, -0.4317885935306549, -0.4924953579902649, -0.47579556703567505, -0.4824346601963043, -0.49528104066848755, -0.5039414167404175, -0.5101525187492371, -0.5193049311637878, -0.5324149131774902, -0.5395010113716125, -0.5243105888366699, -0.5807226896286011, -0.5718461871147156, -0.5778573751449585, -0.585119903087616, -0.5859077572822571, -0.5838640332221985, -0.586159884929657, -0.5954512357711792, -0.604468047618866, -0.599053144454956, -0.6254825592041016, -0.6297018527984619, -0.6346256732940674, -0.6346656084060669, -0.6272903084754944, -0.6172269582748413, -0.6103354096412659, -0.6095541715621948, -0.6148855686187744, -0.6214847564697266, -0.6055946350097656, -0.6202186346054077, -0.6230652928352356, -0.6176043152809143, -0.6073410511016846, -0.5957865118980408, -0.5837554931640625, -0.5728174448013306, -0.5705005526542664, -0.5836714506149292, -0.538817822933197, -0.5571691989898682, -0.555915892124176, -0.546334981918335, -0.537316620349884, -0.5302911996841431, -0.5203455090522766, -0.5053556561470032, -0.4962742030620575, -0.5092439651489258, -0.35572561621665955, -0.36259180307388306, -0.3566158413887024, -0.34655627608299255, -0.3405458927154541, -0.340449720621109, -0.3415348529815674, -0.33917349576950073, -0.33624905347824097, -0.3416885733604431, -0.34096580743789673, -0.34491240978240967, -0.33319419622421265, -0.3170201778411865, -0.3075311481952667, -0.3067886233329773, -0.3098304867744446, -0.3122900724411011, -0.31586742401123047, -0.32620295882225037, -0.30621036887168884, -0.3081735372543335, -0.2964496612548828, -0.28024280071258545, -0.2701292634010315, -0.26835355162620544, -0.2707329988479614, -0.27465131878852844, -0.2817804217338562, -0.29377007484436035, -0.28340327739715576, -0.28150904178619385, -0.2752615213394165, -0.2678286135196686, -0.26433923840522766, -0.2664952576160431, -0.270576536655426, -0.27405962347984314, -0.2776118814945221, -0.28128674626350403, -0.2886030375957489, -0.2833986282348633, -0.2833014726638794, -0.285359263420105, -0.28925392031669617, -0.295683354139328, -0.30179157853126526, -0.3045543432235718, -0.3032037019729614, -0.29719704389572144, -0.314765065908432, -0.3090944290161133, -0.30948540568351746, -0.312093049287796, -0.31558236479759216, -0.32065317034721375, -0.3259340226650238, -0.3293917179107666, -0.32941722869873047, -0.32397186756134033, -0.33785131573677063, -0.3355104625225067, -0.33402708172798157, -0.33179065585136414, -0.32865774631500244, -0.3270379602909088, -0.32796284556388855, -0.331268846988678, -0.3359156548976898, -0.3387563228607178, -0.3408395051956177, -0.3456467390060425, -0.34611889719963074, -0.34221765398979187, -0.33406248688697815, -0.32530391216278076, -0.31914466619491577, -0.31748270988464355, -0.32189613580703735, -0.33130118250846863, -0.33088865876197815, -0.3403624892234802, -0.343612939119339, -0.34107208251953125, -0.3334544003009796, -0.32389506697654724, -0.31464192271232605, -0.3079061508178711, -0.3079582452774048, -0.3172113001346588, -0.33839166164398193, -0.3478439450263977, -0.34872567653656006, -0.34460148215293884, -0.3393678665161133, -0.335011750459671, -0.3299657702445984, -0.3232276141643524, -0.31936559081077576, -0.3250167965888977, -0.2149982899427414, -0.2062404453754425, -0.20491020381450653, -0.20701076090335846, -0.21168479323387146, -0.2202325463294983, -0.23106230795383453, -0.24006180465221405, -0.2412412017583847, -0.23041728138923645, -0.23405669629573822, -0.2290874868631363, -0.22503891587257385, -0.22104515135288239, -0.22066271305084229, -0.22650405764579773, -0.23614796996116638, -0.24468354880809784, -0.2471572309732437, -0.2417224645614624, -0.24223266541957855, -0.24289776384830475, -0.2382396012544632, -0.2304869145154953, -0.22694508731365204, -0.22985391318798065, -0.23525311052799225, -0.23884247243404388, -0.24005897343158722, -0.2406526803970337, -0.23807503283023834, -0.24318115413188934, -0.24003610014915466, -0.23258429765701294, -0.22901810705661774, -0.23185057938098907, -0.23445287346839905, -0.2315087914466858, -0.227501779794693, -0.2299400120973587, -0.21792753040790558, -0.2254422903060913, -0.22330763936042786, -0.21668177843093872, -0.21363328397274017, -0.2167646586894989, -0.2180573046207428, -0.21121880412101746, -0.20336677134037018, -0.2061491459608078, -0.18610970675945282, -0.19209353625774384, -0.18712113797664642, -0.17860649526119232, -0.1746286004781723, -0.17654664814472198, -0.17724807560443878, -0.1716412454843521, -0.16671013832092285, -0.1728876233100891, -0.1541743129491806, -0.15646280348300934, -0.14928394556045532, -0.13974536955356598, -0.13427789509296417, -0.1338772475719452, -0.13393864035606384, -0.1320616751909256, -0.13322678208351135, -0.14270465075969696, -0.1365722268819809, -0.13632746040821075, -0.13287018239498138, -0.12864653766155243, -0.12485260516405106, -0.1221776232123375, -0.12024110555648804, -0.12028144299983978, -0.12420794367790222, -0.1312306523323059, -0.14544010162353516, -0.14117303490638733, -0.1430945247411728, -0.1471540778875351, -0.14923131465911865, -0.1487235128879547, -0.1481124609708786, -0.15035761892795563, -0.1539313644170761, -0.15245842933654785, -0.17995001375675201, -0.1713634878396988, -0.17348544299602509, -0.1799209862947464, -0.18639792501926422, -0.19212718307971954, -0.19805501401424408, -0.20424696803092957, -0.20617568492889404, -0.19660407304763794, -0.3731862008571625, -0.3538549840450287, -0.3576998710632324, -0.3719145953655243, -0.38910573720932007, -0.4074796140193939, -0.42555201053619385, -0.4386492967605591, -0.43695786595344543, -0.41087257862091064, -0.4399718940258026, -0.42644059658050537, -0.4314778447151184, -0.442757785320282, -0.45638471841812134, -0.4726842939853668, -0.48918938636779785, -0.4996262788772583, -0.49538087844848633, -0.4711441993713379, -0.5174679160118103, -0.5153218507766724, -0.5197710394859314, -0.5246873497962952, -0.5320612788200378, -0.5423585176467896, -0.5515505075454712, -0.5536614060401917, -0.5459015965461731, -0.5308703780174255, -0.5533970594406128, -0.5637221932411194, -0.5653655529022217, -0.5611633658409119, -0.559866726398468, -0.5634473562240601, -0.5647186636924744, -0.5569401383399963, -0.5456491708755493, -0.5437408685684204, -0.5225700736045837, -0.5412586331367493, -0.5383971333503723, -0.5249413847923279, -0.5151730179786682, -0.5129217505455017, -0.5089645385742188, -0.4956505298614502, -0.48411187529563904, -0.4943554103374481, -0.4440828859806061, -0.4615957736968994, -0.45322951674461365, -0.4346538186073303, -0.42146211862564087, -0.41645848751068115, -0.4109671711921692, -0.3991859257221222, -0.392819344997406, -0.4105569124221802, -0.3639329671859741, -0.3740495443344116, -0.36414048075675964, -0.34780353307724, -0.3367769122123718, -0.3318807780742645, -0.32731884717941284, -0.32089629769325256, -0.3208753168582916, -0.33834561705589294, -0.31853094696998596, -0.3205496668815613, -0.3156207501888275, -0.3094964027404785, -0.30565521121025085, -0.30285781621932983, -0.2997722029685974, -0.2982472777366638, -0.30095288157463074, -0.30932706594467163, -0.3156457543373108, -0.3075605034828186, -0.30842751264572144, -0.3148666024208069, -0.32193630933761597, -0.3256710469722748, -0.3277199864387512, -0.33192896842956543, -0.33490151166915894, -0.3287487328052521, -0.3376482427120209, -0.3203982710838318, -0.32337984442710876, -0.3367869555950165, -0.3522636890411377, -0.36548545956611633, -0.3771129250526428, -0.3874998986721039, -0.38872072100639343, -0.36922651529312134, -0.487932026386261, -0.47597551345825195, -0.48070228099823, -0.49323779344558716, -0.5087645649909973, -0.5246359705924988, -0.5374316573143005, -0.5430260896682739, -0.5362541675567627, -0.514400064945221, -0.6018847227096558, -0.5944112539291382, -0.6020007133483887, -0.613479495048523, -0.6258558630943298, -0.6398864388465881, -0.6525305509567261, -0.657311737537384, -0.6485597491264343, -0.6259548664093018, -0.6898012161254883, -0.6928836107254028, -0.7000022530555725, -0.7059245109558105, -0.7117070555686951, -0.7188538312911987, -0.7247277498245239, -0.7229867577552795, -0.7117277383804321, -0.6974023580551147, -0.7078633904457092, -0.7225200533866882, -0.7252836227416992, -0.7211411595344543, -0.7176091074943542, -0.7167537808418274, -0.714534342288971, -0.704809844493866, -0.6922025680541992, -0.6921855211257935, -0.6466642022132874, -0.6687458753585815, -0.6652460098266602, -0.6498904228210449, -0.6368208527565002, -0.6295341849327087, -0.6219956278800964, -0.6082391738891602, -0.5980149507522583, -0.6120730042457581, -0.5390212535858154, -0.5599234700202942, -0.5505370497703552, -0.5293582677841187, -0.5125448107719421, -0.5027408003807068, -0.49338299036026, -0.48091256618499756, -0.47641587257385254, -0.498670369386673, -0.4343136250972748, -0.4488767087459564, -0.4384188950061798, -0.4198346436023712, -0.40577244758605957, -0.39616018533706665, -0.38659411668777466, -0.3777957260608673, -0.3785471022129059, -0.40074974298477173, -0.36841580271720886, -0.37622639536857605, -0.3706596791744232, -0.3616201877593994, -0.3546689748764038, -0.3470532298088074, -0.33820074796676636, -0.33280640840530396, -0.33528876304626465, -0.3493725657463074, -0.3528691232204437, -0.35207366943359375, -0.3509254455566406, -0.3527195155620575, -0.35612282156944275, -0.35547110438346863, -0.351539671421051, -0.3501048684120178, -0.35104209184646606, -0.35208484530448914, -0.39386242628097534, -0.3848043382167816, -0.3861711323261261, -0.3953668475151062, -0.407833456993103, -0.4176357388496399, -0.42319607734680176, -0.42594730854034424, -0.42280691862106323, -0.41017866134643555, -0.3007678687572479, -0.3027985990047455, -0.30354243516921997, -0.3053455352783203, -0.30992037057876587, -0.31499412655830383, -0.31587642431259155, -0.3110978603363037, -0.30336248874664307, -0.29926565289497375, -0.32586216926574707, -0.3307511508464813, -0.3333951532840729, -0.3331797122955322, -0.33290553092956543, -0.3347393572330475, -0.3361770510673523, -0.3336535692214966, -0.3274295926094055, -0.3234083950519562, -0.340187668800354, -0.34797292947769165, -0.3503277003765106, -0.34877023100852966, -0.3455686867237091, -0.34354057908058167, -0.3431425392627716, -0.34051644802093506, -0.334809273481369, -0.3331097662448883, -0.3279028534889221, -0.33585086464881897, -0.3366478979587555, -0.33475932478904724, -0.3317701518535614, -0.3287121057510376, -0.3270869553089142, -0.3234744369983673, -0.31765463948249817, -0.31818318367004395, -0.29757755994796753, -0.3035343587398529, -0.3020523488521576, -0.29856154322624207, -0.29531601071357727, -0.2926666736602783, -0.29103708267211914, -0.28796812891960144, -0.2845737934112549, -0.28777408599853516, -0.2706502079963684, -0.2726227045059204, -0.2676243782043457, -0.26233041286468506, -0.25961729884147644, -0.2581295371055603, -0.25674086809158325, -0.25547778606414795, -0.25648361444473267, -0.2625595033168793, -0.2608582675457001, -0.25927120447158813, -0.2520599663257599, -0.24673952162265778, -0.24577011168003082, -0.244747593998909, -0.24213944375514984, -0.24172860383987427, -0.2461242377758026, -0.25448134541511536, -0.2669984996318817, -0.26545295119285583, -0.2596803307533264, -0.256424218416214, -0.256686806678772, -0.25442248582839966, -0.24917396903038025, -0.24753311276435852, -0.2522927522659302, -0.26095840334892273, -0.2747550308704376, -0.27428504824638367, -0.27010422945022583, -0.2693626880645752, -0.2721639573574066, -0.2713052034378052, -0.2659270167350769, -0.26239416003227234, -0.26346027851104736, -0.26899951696395874, -0.2822049856185913, -0.2825886607170105, -0.28012529015541077, -0.281408429145813, -0.2870940864086151, -0.29073312878608704, -0.2885546088218689, -0.28319236636161804, -0.27814677357673645, -0.2781795561313629, -0.27644532918930054, -0.2875128388404846, -0.28319793939590454, -0.27565768361091614, -0.2714814841747284, -0.2679485082626343, -0.25976788997650146, -0.2476809173822403, -0.24160483479499817, -0.253651887178421, -0.1623101830482483, -0.17343488335609436, -0.17028877139091492, -0.16113929450511932, -0.1526075154542923, -0.14567707479000092, -0.13875705003738403, -0.13179728388786316, -0.13014359772205353, -0.14201581478118896, -0.11634495854377747, -0.12100730836391449, -0.11874588578939438, -0.11426809430122375, -0.10875291377305984, -0.1028834730386734, -0.09969991445541382, -0.09931517392396927, -0.1007334291934967, -0.1067393496632576, -0.1227540597319603, -0.11612991243600845, -0.11611387878656387, -0.12171300500631332, -0.1256885677576065, -0.1259405016899109, -0.12844674289226532, -0.13405144214630127, -0.13656209409236908, -0.1317882388830185, -0.1732873022556305, -0.15630264580249786, -0.15861599147319794, -0.17238788306713104, -0.18428216874599457, -0.19066807627677917, -0.19821830093860626, -0.20875118672847748, -0.21303251385688782, -0.19956086575984955, -0.2601924538612366, -0.2373085469007492, -0.23884516954421997, -0.25470441579818726, -0.2706436812877655, -0.28102484345436096, -0.29072022438049316, -0.3034317195415497, -0.31021785736083984, -0.2944485545158386, -0.36695921421051025, -0.3429606854915619, -0.3403957784175873, -0.3530449867248535, -0.3694216012954712, -0.38119223713874817, -0.3901679515838623, -0.40168496966362, -0.40987080335617065, -0.39821547269821167, -0.46218574047088623, -0.44410794973373413, -0.4378822147846222, -0.44437703490257263, -0.4568983018398285, -0.4658656716346741, -0.4705355763435364, -0.4769211709499359, -0.48385077714920044, -0.4802694022655487, -0.494442880153656, -0.4873761832714081, -0.47958558797836304, -0.47971484065055847, -0.48680368065834045, -0.4913586676120758, -0.4900822341442108, -0.48833614587783813, -0.49010801315307617, -0.4942915737628937, -0.4208516776561737, -0.42512068152427673, -0.4183291494846344, -0.41391411423683167, -0.41572943329811096, -0.41647568345069885, -0.4103890061378479, -0.4003514349460602, -0.39541783928871155, -0.40479394793510437, -0.48597028851509094, -0.5059935450553894, -0.4984413683414459, -0.4834494888782501, -0.47263380885124207, -0.4632396399974823, -0.4483107030391693, -0.42881813645362854, -0.42154011130332947, -0.4452182948589325, -0.3635290861129761, -0.3812204897403717, -0.37527796626091003, -0.36060383915901184, -0.3472096025943756, -0.3350568115711212, -0.32156649231910706, -0.3081541955471039, -0.3061979413032532, -0.3286740183830261, -0.30947980284690857, -0.3148993253707886, -0.31116703152656555, -0.30499574542045593, -0.29783961176872253, -0.28902667760849, -0.28204020857810974, -0.279588907957077, -0.2833081781864166, -0.29530206322669983, -0.32199713587760925, -0.3105058968067169, -0.3109434247016907, -0.3191448450088501, -0.3246006369590759, -0.32442334294319153, -0.3267117142677307, -0.33520057797431946, -0.34225478768348694, -0.33738163113594055, -0.3840237855911255, -0.3598128855228424, -0.3647315204143524, -0.38451576232910156, -0.400048166513443, -0.4072694480419159, -0.4160265028476715, -0.43113064765930176, -0.43988874554634094, -0.4222601056098938, -0.4738275408744812, -0.4456079304218292, -0.45219963788986206, -0.47551408410072327, -0.4948139488697052, -0.5052094459533691, -0.5150454640388489, -0.5306270718574524, -0.5399484038352966, -0.5191506743431091, -0.5733600854873657, -0.5467287302017212, -0.5488865971565247, -0.5672954320907593, -0.5854588747024536, -0.59662926197052, -0.6051133871078491, -0.6176950931549072, -0.6269373893737793, -0.6116544604301453, -0.6606115698814392, -0.6415587067604065, -0.6364082098007202, -0.6445829272270203, -0.6574870347976685, -0.6664006114006042, -0.6708333492279053, -0.6770566701889038, -0.6843612194061279, -0.6802372932434082, -0.6918131709098816, -0.6865108013153076, -0.676591157913208, -0.6738271117210388, -0.6789782643318176, -0.6827895641326904, -0.680050790309906, -0.6759443283081055, -0.6777662038803101, -0.686079204082489, -0.6252990961074829, -0.6358705759048462, -0.6258358955383301, -0.6150645017623901, -0.6116835474967957, -0.6086719036102295, -0.5980579257011414, -0.5826601386070251, -0.5771556496620178, -0.5955337882041931, -0.487222284078598, -0.512621283531189, -0.5041037201881409, -0.4854481816291809, -0.4719129800796509, -0.4616685211658478, -0.4453551173210144, -0.4219444990158081, -0.41115105152130127, -0.43767645955085754, -0.418751060962677, -0.4419701099395752, -0.43464863300323486, -0.41660258173942566, -0.400643914937973, -0.3869478404521942, -0.3707428276538849, -0.3520805835723877, -0.346472829580307, -0.3733654022216797, -0.3634932041168213, -0.37372341752052307, -0.36894840002059937, -0.3588157296180725, -0.3472279906272888, -0.33519408106803894, -0.3251856863498688, -0.3191041648387909, -0.3220556974411011, -0.33989399671554565, -0.34895357489585876, -0.3414108157157898, -0.3413068354129791, -0.3448145389556885, -0.3440127968788147, -0.33961695432662964, -0.3398773670196533, -0.34754982590675354, -0.35626015067100525, -0.3570283055305481, -0.37359559535980225, -0.3541432321071625, -0.3598773181438446, -0.37541675567626953, -0.3843299448490143, -0.3866341710090637, -0.3929860591888428, -0.4075530171394348, -0.41805899143218994, -0.40523308515548706, -0.41969379782676697, -0.3989763557910919, -0.4087412357330322, -0.4287998676300049, -0.4406098425388336, -0.4438878297805786, -0.44901683926582336, -0.462481826543808, -0.47260862588882446, -0.45669254660606384, -0.47169095277786255, -0.45547446608543396, -0.4624777138233185, -0.4777933359146118, -0.48681962490081787, -0.488393098115921, -0.48988500237464905, -0.4986312687397003, -0.508026123046875, -0.4986984133720398, -0.5178799033164978, -0.5092330574989319, -0.5085510015487671, -0.5134338140487671, -0.5173801183700562, -0.5173377990722656, -0.5152076482772827, -0.517078697681427, -0.5239258408546448, -0.5258152484893799, -0.5400007367134094, -0.5418004989624023, -0.5345103740692139, -0.5285953283309937, -0.5274550914764404, -0.5261394381523132, -0.5197703242301941, -0.5125748515129089, -0.5138422250747681, -0.5263879895210266, -0.5300046801567078, -0.5456039309501648, -0.536206841468811, -0.5220860838890076, -0.5147867798805237, -0.5098501443862915, -0.49795767664909363, -0.4802543818950653, -0.47335946559906006, -0.4942760467529297]))

    def test_3DImg_with_pad(self):
        return_new = fu.filt_btwl(IMAGE_3D, freql=0.25, freqh=0.35, pad=True)
        return_old = oldfu.filt_btwl(IMAGE_3D, freql=0.25, freqh=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview().flatten(), [-0.2709195613861084, -0.24660003185272217, -0.24362951517105103, -0.24602583050727844, -0.24721209704875946, -0.2487715631723404, -0.2491162121295929, -0.24442793428897858, -0.24434764683246613, -0.2695002555847168, -0.24071191251277924, -0.20386391878128052, -0.19802631437778473, -0.20072604715824127, -0.20122423768043518, -0.20094682276248932, -0.19930829107761383, -0.1941685825586319, -0.19988799095153809, -0.24071061611175537, -0.23783794045448303, -0.19748401641845703, -0.19053559005260468, -0.192414328455925, -0.1912412792444229, -0.18995746970176697, -0.1894153207540512, -0.18846215307712555, -0.20034357905387878, -0.24500983953475952, -0.257315993309021, -0.22474896907806396, -0.22204671800136566, -0.22684504091739655, -0.22832877933979034, -0.2305472493171692, -0.23565177619457245, -0.24186743795871735, -0.2550434470176697, -0.28557485342025757, -0.300392210483551, -0.28838807344436646, -0.29439759254455566, -0.30412256717681885, -0.3111785650253296, -0.3185398578643799, -0.3287343680858612, -0.3408108949661255, -0.3509744107723236, -0.354263573884964, -0.36845332384109497, -0.3866743743419647, -0.4008468985557556, -0.41075173020362854, -0.4186817705631256, -0.42660102248191833, -0.4382100999355316, -0.4549231231212616, -0.46186739206314087, -0.4343626797199249, -0.45417824387550354, -0.5060224533081055, -0.5252940654754639, -0.5297358632087708, -0.5325276255607605, -0.5363616943359375, -0.5461499094963074, -0.5641875267028809, -0.5661641359329224, -0.5100798010826111, -0.5305973291397095, -0.6083816885948181, -0.629203736782074, -0.6262761354446411, -0.622077465057373, -0.6202231645584106, -0.6249052882194519, -0.6376733779907227, -0.630948543548584, -0.5558210611343384, -0.5531964898109436, -0.634738564491272, -0.6515859961509705, -0.6430478096008301, -0.6343445777893066, -0.6279689073562622, -0.6260815262794495, -0.6307128667831421, -0.618291437625885, -0.5446630716323853, -0.49831604957580566, -0.5565119385719299, -0.5646030306816101, -0.5549086332321167, -0.5465070009231567, -0.5395340919494629, -0.5344895720481873, -0.5342708826065063, -0.5244912505149841, -0.474790096282959, -0.38749903440475464, -0.3996538817882538, -0.4052579402923584, -0.4048933982849121, -0.40303245186805725, -0.4032614827156067, -0.40247780084609985, -0.39386501908302307, -0.37942934036254883, -0.36891379952430725, -0.3780624568462372, -0.38303178548812866, -0.38524681329727173, -0.3827972710132599, -0.3790894150733948, -0.3771917223930359, -0.3742329180240631, -0.36584487557411194, -0.3574296236038208, -0.3581475615501404, -0.3645738363265991, -0.3632202744483948, -0.3637654483318329, -0.3612436056137085, -0.35709354281425476, -0.354550838470459, -0.3518381714820862, -0.3472525179386139, -0.3466604948043823, -0.35481950640678406, -0.36514827609062195, -0.36725348234176636, -0.37365931272506714, -0.3786429762840271, -0.3812219500541687, -0.3841468393802643, -0.38689297437667847, -0.388238787651062, -0.38893431425094604, -0.3860107958316803, -0.3969586491584778, -0.4168638586997986, -0.43406426906585693, -0.44783076643943787, -0.45861637592315674, -0.46806004643440247, -0.47665107250213623, -0.48310384154319763, -0.4795745611190796, -0.45048534870147705, -0.46093061566352844, -0.5084910988807678, -0.5330498218536377, -0.5461357831954956, -0.5559040307998657, -0.5647305846214294, -0.5749046802520752, -0.5859551429748535, -0.5794329643249512, -0.5227169394493103, -0.5378625988960266, -0.6144353747367859, -0.6413487195968628, -0.6456058621406555, -0.6455416083335876, -0.6462625861167908, -0.6525642275810242, -0.664491593837738, -0.6550525426864624, -0.5772131085395813, -0.5930203795433044, -0.688666820526123, -0.7147765159606934, -0.7098056077957153, -0.6991903185844421, -0.689875602722168, -0.6872768998146057, -0.6918718814849854, -0.6760423183441162, -0.5895029306411743, -0.5857212543487549, -0.6763975024223328, -0.6963891386985779, -0.6860092282295227, -0.6708619594573975, -0.6564199924468994, -0.6462050676345825, -0.6421477794647217, -0.6234334111213684, -0.5477028489112854, -0.5074893236160278, -0.5676729083061218, -0.5767630934715271, -0.5660210251808167, -0.5537355542182922, -0.5415997505187988, -0.5308626294136047, -0.5247107148170471, -0.5117763876914978, -0.4645770490169525, -0.3948465585708618, -0.40652140974998474, -0.4038159251213074, -0.39571431279182434, -0.38996174931526184, -0.38923379778862, -0.38937875628471375, -0.38469943404197693, -0.3748317062854767, -0.36353108286857605, -0.37717902660369873, -0.37992754578590393, -0.36982089281082153, -0.3557415008544922, -0.3462586998939514, -0.3431251645088196, -0.34227585792541504, -0.34058108925819397, -0.3397560119628906, -0.3418140113353729, -0.3428551256656647, -0.33430615067481995, -0.31979095935821533, -0.30448296666145325, -0.29477065801620483, -0.2909514009952545, -0.28927138447761536, -0.2900122106075287, -0.2980644404888153, -0.31431156396865845, -0.3138236701488495, -0.29866212606430054, -0.2866659462451935, -0.27869459986686707, -0.27593308687210083, -0.2767333388328552, -0.27729111909866333, -0.2792966663837433, -0.2886955440044403, -0.30642667412757874, -0.3041524589061737, -0.2902315557003021, -0.2840493321418762, -0.2844776511192322, -0.28915834426879883, -0.2946213483810425, -0.2977227568626404, -0.3005760908126831, -0.3076433837413788, -0.3182273805141449, -0.31393513083457947, -0.30493056774139404, -0.29932358860969543, -0.2989376485347748, -0.3027535676956177, -0.30695393681526184, -0.3099130392074585, -0.31503957509994507, -0.32373476028442383, -0.33020997047424316, -0.3286307454109192, -0.32390111684799194, -0.31495463848114014, -0.3077513575553894, -0.3040224611759186, -0.301509827375412, -0.301012247800827, -0.30760377645492554, -0.320342093706131, -0.32845690846443176, -0.333601713180542, -0.33145567774772644, -0.32167866826057434, -0.31110939383506775, -0.3015581965446472, -0.2917797267436981, -0.28488823771476746, -0.28803741931915283, -0.3011906147003174, -0.3132706582546234, -0.32310304045677185, -0.31915733218193054, -0.3107146918773651, -0.3019735813140869, -0.29306113719940186, -0.28198039531707764, -0.27181535959243774, -0.27111807465553284, -0.2827529311180115, -0.298595666885376, -0.3127762973308563, -0.3050275444984436, -0.2971244156360626, -0.29137861728668213, -0.28694117069244385, -0.28039121627807617, -0.27305686473846436, -0.2724182903766632, -0.28258419036865234, -0.298635870218277, -0.28660741448402405, -0.26676490902900696, -0.2519367039203644, -0.24345846474170685, -0.24283643066883087, -0.24871602654457092, -0.25674670934677124, -0.26481199264526367, -0.2739945948123932, -0.2876174747943878, -0.2713221609592438, -0.247793048620224, -0.22739246487617493, -0.21346130967140198, -0.21045872569084167, -0.2164515107870102, -0.22678497433662415, -0.24017341434955597, -0.256422758102417, -0.27576372027397156, -0.27051228284835815, -0.24872037768363953, -0.22591561079025269, -0.20802026987075806, -0.20242631435394287, -0.20647045969963074, -0.21498362720012665, -0.22793598473072052, -0.24645575881004333, -0.26936617493629456, -0.26865354180336, -0.2467089742422104, -0.2246943712234497, -0.20777808129787445, -0.2021285444498062, -0.20531870424747467, -0.21087545156478882, -0.2185652107000351, -0.23348626494407654, -0.2585389316082001, -0.25486475229263306, -0.22688955068588257, -0.20563127100467682, -0.19208617508411407, -0.1879662275314331, -0.19032041728496552, -0.19243761897087097, -0.19449320435523987, -0.20640632510185242, -0.23798547685146332, -0.2296755015850067, -0.18875019252300262, -0.16414417326450348, -0.15208914875984192, -0.14895935356616974, -0.14940530061721802, -0.14810962975025177, -0.14801102876663208, -0.16356681287288666, -0.20951467752456665, -0.20189079642295837, -0.1471216231584549, -0.11947400122880936, -0.10906194150447845, -0.1064998209476471, -0.10491038113832474, -0.10101554542779922, -0.10135321319103241, -0.1235310435295105, -0.18413132429122925, -0.18495944142341614, -0.12518008053302765, -0.10173851251602173, -0.09817823767662048, -0.09899960458278656, -0.0964902713894844, -0.09043559432029724, -0.09083863347768784, -0.11568401008844376, -0.18033817410469055, -0.19295310974121094, -0.1405700445175171, -0.1268802434206009, -0.13250871002674103, -0.13964685797691345, -0.14008742570877075, -0.13572578132152557, -0.1375572681427002, -0.16039036214351654, -0.21449892222881317, -0.2373565137386322, -0.20242968201637268, -0.19674213230609894, -0.20536503195762634, -0.21523389220237732, -0.21969328820705414, -0.22001640498638153, -0.22400076687335968, -0.24039557576179504, -0.2734559178352356, -0.3302709460258484, -0.33268478512763977, -0.3332628309726715, -0.3365935683250427, -0.3465729057788849, -0.3610539734363556, -0.3755713701248169, -0.38687291741371155, -0.3890269696712494, -0.37366029620170593, -0.37806394696235657, -0.4023222029209137, -0.4095596671104431, -0.4125998616218567, -0.4232259690761566, -0.4408078193664551, -0.4600272476673126, -0.47531330585479736, -0.4726969599723816, -0.4343791902065277, -0.44843652844429016, -0.4990350008010864, -0.5113061666488647, -0.5093327164649963, -0.5142459273338318, -0.527127742767334, -0.5425145030021667, -0.5533687472343445, -0.5414490103721619, -0.48355674743652344, -0.4943486750125885, -0.5576267242431641, -0.5695793628692627, -0.560520350933075, -0.5564740896224976, -0.5612078905105591, -0.56816565990448, -0.5688471794128418, -0.548138439655304, -0.48690328001976013, -0.4875287711620331, -0.5417007207870483, -0.5478360652923584, -0.5337364673614502, -0.5229286551475525, -0.5202131867408752, -0.5186588764190674, -0.5101145505905151, -0.48770231008529663, -0.4432299733161926, -0.4356484115123749, -0.46328046917915344, -0.46087703108787537, -0.4472223222255707, -0.4365602731704712, -0.43038755655288696, -0.42291322350502014, -0.41036880016326904, -0.39538654685020447, -0.3802093267440796, -0.372898668050766, -0.3731992244720459, -0.36696353554725647, -0.3604302704334259, -0.3558708131313324, -0.3504473865032196, -0.3404989242553711, -0.3279588222503662, -0.3224866986274719, -0.33228522539138794, -0.33185291290283203, -0.31902945041656494, -0.31803181767463684, -0.32423847913742065, -0.3295634388923645, -0.32799339294433594, -0.3185559809207916, -0.3075993061065674, -0.3065081834793091, -0.32335370779037476, -0.3245184123516083, -0.31375688314437866, -0.32134389877319336, -0.3388582766056061, -0.35407957434654236, -0.359170526266098, -0.3547264039516449, -0.3483046591281891, -0.3475797474384308, -0.35463353991508484, -0.342472642660141, -0.3404121398925781, -0.3515844941139221, -0.3697739541530609, -0.3863430917263031, -0.3954927623271942, -0.3973958492279053, -0.39614176750183105, -0.3938162326812744, -0.38763105869293213, -0.43710365891456604, -0.4758606553077698, -0.4940371513366699, -0.5046095848083496, -0.5163041949272156, -0.5289215445518494, -0.5383555889129639, -0.5403437614440918, -0.5248197913169861, -0.47507336735725403, -0.5155479907989502, -0.5860884189605713, -0.6152018308639526, -0.6266894936561584, -0.6383476853370667, -0.652776300907135, -0.6655536890029907, -0.6690369844436646, -0.643520176410675, -0.5610130429267883, -0.589289128780365, -0.6859211921691895, -0.7194758057594299, -0.7257757186889648, -0.7307966947555542, -0.7390321493148804, -0.7472407817840576, -0.7460906505584717, -0.7104922533035278, -0.6076145768165588, -0.619904100894928, -0.7227827310562134, -0.7512534260749817, -0.7478951811790466, -0.7428633570671082, -0.741765558719635, -0.7416094541549683, -0.7327365875244141, -0.692396879196167, -0.5923622250556946, -0.5889739990234375, -0.6744025945663452, -0.6908357739448547, -0.6780622601509094, -0.6645128130912781, -0.6557891368865967, -0.648308515548706, -0.6341173648834229, -0.5988230109214783, -0.5245682597160339, -0.5128024220466614, -0.5646935105323792, -0.5675194263458252, -0.5516257882118225, -0.5369652509689331, -0.5255215167999268, -0.5136116147041321, -0.4984738826751709, -0.4759557545185089, -0.4383949041366577, -0.4297013580799103, -0.4492100775241852, -0.44450077414512634, -0.43338996171951294, -0.4243837594985962, -0.41407230496406555, -0.4001542329788208, -0.3864642083644867, -0.37656575441360474, -0.36959317326545715, -0.37172356247901917, -0.3729361891746521, -0.36957085132598877, -0.36838486790657043, -0.36820393800735474, -0.36155110597610474, -0.34830334782600403, -0.3368595242500305, -0.333455353975296, -0.3392355144023895, -0.3463001549243927, -0.34133222699165344, -0.34100669622421265, -0.34786108136177063, -0.3563483953475952, -0.3565618097782135, -0.34850502014160156, -0.3411291241645813, -0.3390285074710846, -0.34235039353370667, -0.34381261467933655, -0.33933258056640625, -0.33965757489204407, -0.3471733033657074, -0.35784903168678284, -0.3634182810783386, -0.3622424602508545, -0.3592902719974518, -0.35658854246139526, -0.353772908449173, -0.3461386561393738, -0.3487572968006134, -0.3505657911300659, -0.3539656102657318, -0.3585801124572754, -0.3612932562828064, -0.35962948203086853, -0.35585305094718933, -0.3524070084095001, -0.34821468591690063, -0.3515368402004242, -0.3571389615535736, -0.3572988510131836, -0.3570723533630371, -0.3584805428981781, -0.35927265882492065, -0.3577728867530823, -0.3561168909072876, -0.354310005903244, -0.34860578179359436, -0.35389286279678345, -0.35916876792907715, -0.355436772108078, -0.3519243597984314, -0.3503747582435608, -0.34751176834106445, -0.34425148367881775, -0.34317848086357117, -0.34239497780799866, -0.3378715515136719, -0.34242820739746094, -0.34174636006355286, -0.3331621587276459, -0.32798799872398376, -0.32607877254486084, -0.32167133688926697, -0.3172106146812439, -0.31634727120399475, -0.3175165057182312, -0.3185384273529053, -0.3184528052806854, -0.3082953691482544, -0.2943965494632721, -0.28692564368247986, -0.2845996618270874, -0.2803697884082794, -0.2761614918708801, -0.27741435170173645, -0.2847244143486023, -0.2959936261177063, -0.2927415668964386, -0.27254724502563477, -0.252494752407074, -0.24246948957443237, -0.2407696694135666, -0.23808588087558746, -0.23486940562725067, -0.23970191180706024, -0.25540781021118164, -0.2775208055973053, -0.27925509214401245, -0.2537749111652374, -0.2300979048013687, -0.21899722516536713, -0.21896454691886902, -0.21751490235328674, -0.21422629058361053, -0.22129635512828827, -0.2423280030488968, -0.2700192630290985, -0.2842772901058197, -0.2614246904850006, -0.23926480114459991, -0.22908560931682587, -0.22983017563819885, -0.2279101014137268, -0.22323164343833923, -0.22963227331638336, -0.24989071488380432, -0.2748733460903168, -0.2965569794178009, -0.277576744556427, -0.2573184370994568, -0.2483695149421692, -0.25044509768486023, -0.24987047910690308, -0.2458333969116211, -0.2505292296409607, -0.2653031647205353, -0.28316769003868103, -0.3050433099269867, -0.28801262378692627, -0.2694881856441498, -0.26152893900871277, -0.2646854519844055, -0.2671295702457428, -0.26588180661201477, -0.2688996195793152, -0.2779279053211212, -0.29057592153549194, -0.2610476016998291, -0.232057586312294, -0.21693509817123413, -0.21151939034461975, -0.2090451717376709, -0.2038530558347702, -0.19527487456798553, -0.1906883716583252, -0.20231615006923676, -0.23961175978183746, -0.21048729121685028, -0.1624341607093811, -0.13727717101573944, -0.12704868614673615, -0.12149088829755783, -0.11295032501220703, -0.10258013755083084, -0.10116712749004364, -0.12379301339387894, -0.18264804780483246, -0.1698780208826065, -0.10543225705623627, -0.07457767426967621, -0.06732826679944992, -0.06627257168292999, -0.0595601387321949, -0.05123085156083107, -0.05473405867815018, -0.0848364308476448, -0.15401853621006012, -0.15973219275474548, -0.09159303456544876, -0.06361439824104309, -0.06601257622241974, -0.07543158531188965, -0.07585205137729645, -0.0731080025434494, -0.08206543326377869, -0.1139637753367424, -0.1759178340435028, -0.18995094299316406, -0.13501222431659698, -0.11506552994251251, -0.12450840324163437, -0.14128242433071136, -0.14876526594161987, -0.15278403460979462, -0.16803818941116333, -0.1988312005996704, -0.24002137780189514, -0.2530182898044586, -0.22333689033985138, -0.2099698930978775, -0.21881113946437836, -0.23740729689598083, -0.24953128397464752, -0.2588065564632416, -0.2793545126914978, -0.30723440647125244, -0.32121965289115906, -0.3361915051937103, -0.33675289154052734, -0.3271888792514801, -0.3299466371536255, -0.34578797221183777, -0.3589661717414856, -0.3702148497104645, -0.39239928126335144, -0.4138706922531128, -0.39969250559806824, -0.4205104410648346, -0.44996166229248047, -0.4439655542373657, -0.4393259584903717, -0.4483831524848938, -0.4572421610355377, -0.46500247716903687, -0.48275065422058105, -0.49383068084716797, -0.45641833543777466, -0.46693670749664307, -0.5100398659706116, -0.5051659941673279, -0.4951864778995514, -0.49786415696144104, -0.5011405348777771, -0.5029717087745667, -0.5125118494033813, -0.5131228566169739, -0.46679115295410156, -0.44253379106521606, -0.4748484790325165, -0.4673677384853363, -0.45637714862823486, -0.45669931173324585, -0.457804799079895, -0.4563084840774536, -0.4590340256690979, -0.4559195935726166, -0.42226240038871765, -0.3992983102798462, -0.4186652600765228, -0.41626808047294617, -0.406520813703537, -0.3967114984989166, -0.38611653447151184, -0.3741918206214905, -0.36397019028663635, -0.35896727442741394, -0.35586878657341003, -0.37992334365844727, -0.39006248116493225, -0.3827063739299774, -0.3707049787044525, -0.35900184512138367, -0.34501758217811584, -0.3301028907299042, -0.32094094157218933, -0.3224845826625824, -0.331313818693161, -0.3359379470348358, -0.32858824729919434, -0.319233238697052, -0.3157903850078583, -0.3137824535369873, -0.3052735924720764, -0.2943776249885559, -0.2913661003112793, -0.30032840371131897, -0.31660929322242737, -0.3262692391872406, -0.3154231905937195, -0.31247273087501526, -0.32390260696411133, -0.3372795581817627, -0.3398379385471344, -0.33738699555397034, -0.3418038487434387, -0.352202832698822, -0.3558165729045868, -0.37063077092170715, -0.3771951198577881, -0.3846644163131714, -0.4051867723464966, -0.4278704524040222, -0.4391966760158539, -0.44470757246017456, -0.4555789530277252, -0.4622134566307068, -0.4372653067111969, -0.4477768540382385, -0.4846498668193817, -0.4996497929096222, -0.5183728933334351, -0.5411232709884644, -0.5559424161911011, -0.5659494400024414, -0.580754280090332, -0.5815109014511108, -0.524204432964325, -0.5331692695617676, -0.6015864610671997, -0.6182845830917358, -0.6274273991584778, -0.6442667245864868, -0.6582325100898743, -0.6692632436752319, -0.6851340532302856, -0.6794275045394897, -0.5946826934814453, -0.6062633395195007, -0.6995572447776794, -0.7153197526931763, -0.7133216857910156, -0.7210168838500977, -0.7290297150611877, -0.7354016304016113, -0.7468880414962769, -0.7336464524269104, -0.6326512694358826, -0.6258382201194763, -0.7237098813056946, -0.7362552285194397, -0.7267418503761292, -0.7265353798866272, -0.7271203994750977, -0.7255408763885498, -0.7285585403442383, -0.709848940372467, -0.6128154397010803, -0.5538502335548401, -0.6250246167182922, -0.6302778720855713, -0.6196744441986084, -0.6171525120735168, -0.6145177483558655, -0.6085190773010254, -0.6055639386177063, -0.5895899534225464, -0.5225903391838074, -0.5265637636184692, -0.5909715890884399, -0.5998318195343018, -0.5850960612297058, -0.5691194534301758, -0.5564354658126831, -0.5452265739440918, -0.5327546000480652, -0.5111386179924011, -0.4651521146297455, -0.5392758250236511, -0.6065122485160828, -0.6153233647346497, -0.5988510847091675, -0.5801652073860168, -0.5635907649993896, -0.5488954782485962, -0.5352340936660767, -0.5139694213867188, -0.46856096386909485, -0.4857243597507477, -0.5335909128189087, -0.5409749746322632, -0.5328952670097351, -0.5230252146720886, -0.5113232731819153, -0.5001846551895142, -0.4920380711555481, -0.47835710644721985, -0.4435840845108032, -0.4449275732040405, -0.4779896140098572, -0.4872822165489197, -0.4916639029979706, -0.49521711468696594, -0.4930865466594696, -0.4892015755176544, -0.48834097385406494, -0.48005324602127075, -0.44544717669487, -0.4455176889896393, -0.4786069095134735, -0.49051326513290405, -0.500806987285614, -0.5115799903869629, -0.5158178210258484, -0.5171625018119812, -0.5213385224342346, -0.5145670771598816, -0.4705381989479065, -0.4652775526046753, -0.5067586898803711, -0.5179435014724731, -0.5248647928237915, -0.5344028472900391, -0.5394242405891418, -0.5418750643730164, -0.5481922626495361, -0.5419237613677979, -0.4889752268791199, -0.48189181089401245, -0.5304451584815979, -0.5359023809432983, -0.533614993095398, -0.537538468837738, -0.5401191711425781, -0.5411573052406311, -0.5481247305870056, -0.543742835521698, -0.4887350797653198, -0.4888932704925537, -0.5401305556297302, -0.5392633676528931, -0.5283364653587341, -0.526347815990448, -0.5248398780822754, -0.5222167372703552, -0.5272809863090515, -0.5244089365005493, -0.47409725189208984, -0.47305890917778015, -0.5180924534797668, -0.5133397579193115, -0.4991172254085541, -0.49460500478744507, -0.4905632734298706, -0.48425430059432983, -0.4856075048446655, -0.4834348261356354, -0.4443757236003876, -0.4251101315021515, -0.4526730477809906, -0.4457448422908783, -0.4343503713607788, -0.431538462638855, -0.42803755402565, -0.4211251437664032, -0.4199080467224121, -0.4191654324531555, -0.397491455078125]))

    def test_3DImgBlank_without_pad(self):
        return_new = fu.filt_btwl(IMAGE_BLANK_3D, freql=0.25, freqh=0.35, pad=False)
        return_old = oldfu.filt_btwl(IMAGE_BLANK_3D, freql=0.25, freqh=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview(), IMAGE_BLANK_3D.get_3dview()))

    def test_3DImgBlank_with_pad(self):
        return_new = fu.filt_btwl(IMAGE_BLANK_3D, freql=0.25, freqh=0.35, pad=True)
        return_old = oldfu.filt_btwl(IMAGE_BLANK_3D, freql=0.25, freqh=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview(), IMAGE_BLANK_3D.get_3dview()))



class Test_filt_tanl(unittest.TestCase):

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_tanl()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_tanl()
        self.assertEqual(str(cm_new.exception), "filt_tanl() takes at least 3 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError) as cm_new:
            fu.filt_tanl(EMData(), freq=0.25, fall_off=0.35)
        with self.assertRaises(RuntimeError) as cm_old:
            oldfu.filt_tanl(EMData(), freq=0.25, fall_off=0.35)
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_NoneType_Img(self):
        return_new =  fu.filt_tanl(None,  freq=0.25, fall_off=0.35, pad=False )
        return_old = oldfu.filt_tanl(None,  freq=0.25, fall_off=0.35, pad=False )
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_2DImg_without_pad(self):
        return_new = fu.filt_tanl(IMAGE_2D, freq=0.25, fall_off=0.35, pad=False)
        return_old = oldfu.filt_tanl(IMAGE_2D, freq=0.25, fall_off=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview().flatten(), [-0.08797279745340347, -0.0976797565817833, -0.10316647589206696, -0.10364574939012527, -0.09922359138727188, -0.09146364778280258, -0.08090479671955109, -0.07041557878255844, -0.06769547611474991, -0.07575622200965881, 0.08511902391910553, 0.07538199424743652, 0.07039467990398407, 0.07107865810394287, 0.07751233130693436, 0.0865790843963623, 0.09635214507579803, 0.10521212220191956, 0.10683507472276688, 0.09796269237995148, 0.10384714603424072, 0.10440977662801743, 0.10526970773935318, 0.10941297560930252, 0.11834532767534256, 0.1257779747247696, 0.12682732939720154, 0.12254318594932556, 0.11458564549684525, 0.10673058032989502, 0.0493176206946373, 0.061573922634124756, 0.06503047049045563, 0.06814344227313995, 0.07536409795284271, 0.07784807682037354, 0.06842629611492157, 0.050960175693035126, 0.03626830130815506, 0.035878121852874756, -0.012058647349476814, 0.005305641330778599, 0.0019221615511924028, -0.004945690743625164, -0.0051041170954704285, -0.006935400888323784, -0.01946261152625084, -0.03989744186401367, -0.05265699326992035, -0.040892623364925385, -0.08817404508590698, -0.07122939079999924, -0.08480876684188843, -0.10390477627515793, -0.11174383014440536, -0.11400364339351654, -0.12192372232675552, -0.13783882558345795, -0.14605936408042908, -0.12573949992656708, -0.20622658729553223, -0.18854263424873352, -0.20452149212360382, -0.22814086079597473, -0.2394450306892395, -0.24108724296092987, -0.24503116309642792, -0.25793343782424927, -0.2659672200679779, -0.24549320340156555, -0.3557070791721344, -0.3361279368400574, -0.34494855999946594, -0.36284926533699036, -0.3724839687347412, -0.3743733763694763, -0.37813901901245117, -0.39106208086013794, -0.40245139598846436, -0.3893217444419861, -0.4373001456260681, -0.42254576086997986, -0.42403024435043335, -0.4319038391113281, -0.435820072889328, -0.4358465075492859, -0.4376242756843567, -0.44692155718803406, -0.45868024230003357, -0.45623916387557983, -0.33029723167419434, -0.3286866545677185, -0.33023273944854736, -0.3317294120788574, -0.32993072271347046, -0.3256362974643707, -0.3209419846534729, -0.3199268877506256, -0.32503584027290344, -0.3304584324359894]))

    def test_2DImg_with_pad(self):
        return_new = fu.filt_tanl(IMAGE_2D, freq=0.25, fall_off=0.35, pad=True)
        return_old = oldfu.filt_tanl(IMAGE_2D, freq=0.25, fall_off=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview().flatten(),[-0.05885997787117958, -0.015424375422298908, -0.01638980768620968, -0.02685406059026718, -0.026612434536218643, -0.023540453985333443, -0.01712620258331299, 0.00037547110696323216, 0.004848499316722155, -0.04306509718298912, 0.0019175385823473334, 0.06959318369626999, 0.07189387828111649, 0.05872708186507225, 0.06145351752638817, 0.06964872032403946, 0.08039723336696625, 0.10038956254720688, 0.09663236141204834, 0.019775910302996635, 0.020010022446513176, 0.09803063422441483, 0.10350048542022705, 0.09218910336494446, 0.09803403913974762, 0.10634694993495941, 0.11157840490341187, 0.12293499708175659, 0.11014441400766373, 0.024733390659093857, 0.00422715675085783, 0.07695917040109634, 0.08218390494585037, 0.0720008835196495, 0.07620668411254883, 0.07847842574119568, 0.07305604964494705, 0.07186535745859146, 0.05468309298157692, -0.017008228227496147, -0.034540269523859024, 0.017258595675230026, 0.01523046474903822, 0.0012647341936826706, -0.0012109755771234632, -0.004686946980655193, -0.014639425091445446, -0.022614754736423492, -0.038159094750881195, -0.08219838887453079, -0.0963442400097847, -0.0772232711315155, -0.08925832808017731, -0.10679560154676437, -0.11501749604940414, -0.11953207850456238, -0.1267111599445343, -0.13710732758045197, -0.14943459630012512, -0.1604057252407074, -0.18258219957351685, -0.20071016252040863, -0.2182423174381256, -0.2321869283914566, -0.24109651148319244, -0.24495381116867065, -0.25058940052986145, -0.2656988203525543, -0.2757002115249634, -0.25128084421157837, -0.28003132343292236, -0.3324384093284607, -0.35033026337623596, -0.35447707772254944, -0.35933616757392883, -0.3625295162200928, -0.36970824003219604, -0.39016982913017273, -0.3963650166988373, -0.3393038511276245, -0.3423374891281128, -0.41316553950309753, -0.4284692406654358, -0.4231140911579132, -0.42159560322761536, -0.4212954342365265, -0.42649099230766296, -0.4459223747253418, -0.4473094046115875, -0.37585699558258057, -0.31827110052108765, -0.37738901376724243, -0.38558340072631836, -0.37596389651298523, -0.3705291748046875, -0.36575621366500854, -0.3649119436740875, -0.37720683217048645, -0.37823763489723206, -0.3234032392501831] ))

    def test_2DImgBlank_without_pad(self):
        return_new = fu.filt_tanl(IMAGE_BLANK_2D, freq=0.25, fall_off=0.35, pad=False)
        return_old = oldfu.filt_tanl(IMAGE_BLANK_2D, freq=0.25, fall_off=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview(), IMAGE_BLANK_2D.get_2dview()))

    def test_2DImgBlank_with_pad(self):
        return_new = fu.filt_tanl(IMAGE_BLANK_2D, freq=0.25, fall_off=0.35, pad=True)
        return_old = oldfu.filt_tanl(IMAGE_BLANK_2D, freq=0.25, fall_off=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview(), IMAGE_BLANK_2D.get_2dview()))

    def test_3DImg_without_pad(self):
        return_new = fu.filt_tanl(IMAGE_3D, freq=0.25, fall_off=0.35, pad=False)
        return_old = oldfu.filt_tanl(IMAGE_3D, freq=0.25, fall_off=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview().flatten(), [-0.43888184428215027, -0.4592759907245636, -0.4555935561656952, -0.4410835802555084, -0.4291604161262512, -0.4201638400554657, -0.40735650062561035, -0.3908037543296814, -0.38519179821014404, -0.4048531651496887, -0.3635462820529938, -0.37934553623199463, -0.37371009588241577, -0.3585740029811859, -0.34587863087654114, -0.3368121385574341, -0.3266720771789551, -0.3156002461910248, -0.31473901867866516, -0.3342114984989166, -0.3154251277446747, -0.32036396861076355, -0.3142555356025696, -0.3035663962364197, -0.294143408536911, -0.2876831293106079, -0.2836478352546692, -0.2825465500354767, -0.28788596391677856, -0.30119699239730835, -0.31329718232154846, -0.30496084690093994, -0.3014216721057892, -0.3008551299571991, -0.3001188337802887, -0.3002464771270752, -0.3044634759426117, -0.3130291700363159, -0.32085084915161133, -0.32106176018714905, -0.35835355520248413, -0.34083542227745056, -0.3419082462787628, -0.3520728349685669, -0.36028361320495605, -0.3663824796676636, -0.37604087591171265, -0.38965824246406555, -0.39646902680397034, -0.3841094374656677, -0.4333503246307373, -0.4150539040565491, -0.41956546902656555, -0.4340916872024536, -0.4446840286254883, -0.4508622884750366, -0.4596374034881592, -0.47274500131607056, -0.47866272926330566, -0.4631507098674774, -0.5097706317901611, -0.4981251657009125, -0.502799391746521, -0.5135635137557983, -0.5194522738456726, -0.5205443501472473, -0.523531436920166, -0.5317922234535217, -0.5377070307731628, -0.5292380452156067, -0.5577703714370728, -0.5566012263298035, -0.5590741634368896, -0.5617852210998535, -0.5606264472007751, -0.5560078024864197, -0.551855742931366, -0.5522276163101196, -0.5566049218177795, -0.559310257434845, -0.5584424734115601, -0.5680684447288513, -0.5680344104766846, -0.5628149509429932, -0.5562098622322083, -0.5483657121658325, -0.5385785698890686, -0.5300613641738892, -0.5301394462585449, -0.5420926809310913, -0.5129110217094421, -0.5307105183601379, -0.5288242697715759, -0.5178006887435913, -0.5079469084739685, -0.4992152154445648, -0.4865303635597229, -0.4712633490562439, -0.4665377140045166, -0.48375725746154785, -0.4269882142543793, -0.44113078713417053, -0.4370388090610504, -0.42475059628486633, -0.41562244296073914, -0.4107273519039154, -0.4041019082069397, -0.39387384057044983, -0.3897920548915863, -0.40305787324905396, -0.36404168605804443, -0.3726522922515869, -0.36430442333221436, -0.3494800329208374, -0.33946841955184937, -0.3357223868370056, -0.3329140841960907, -0.3287626802921295, -0.33006927371025085, -0.34417852759361267, -0.32222849130630493, -0.3230157494544983, -0.31375178694725037, -0.3013788163661957, -0.29316720366477966, -0.2909288704395294, -0.2921654284000397, -0.29516059160232544, -0.30165451765060425, -0.3124828636646271, -0.3211602568626404, -0.3131204843521118, -0.3072846531867981, -0.3038424849510193, -0.3028796315193176, -0.3054981529712677, -0.3118954598903656, -0.32040879130363464, -0.32717299461364746, -0.3275243937969208, -0.36665183305740356, -0.35241612792015076, -0.3516829013824463, -0.3580808937549591, -0.3649517297744751, -0.3723006546497345, -0.3822641968727112, -0.39328622817993164, -0.3975425660610199, -0.3870120346546173, -0.442281574010849, -0.4281938374042511, -0.4305535852909088, -0.4402061998844147, -0.4480706453323364, -0.454327791929245, -0.4628796875476837, -0.4733879268169403, -0.4772416651248932, -0.4649142622947693, -0.5146231651306152, -0.5074930787086487, -0.5105657577514648, -0.516352117061615, -0.5181436538696289, -0.5175411701202393, -0.5196483135223389, -0.526157796382904, -0.5313289165496826, -0.5267675518989563, -0.5505708456039429, -0.5540059804916382, -0.5572606325149536, -0.5571608543395996, -0.5518859624862671, -0.5440545678138733, -0.5380440950393677, -0.5370886325836182, -0.5411872267723083, -0.5466387867927551, -0.5382542610168457, -0.550592839717865, -0.5534268021583557, -0.5487036108970642, -0.5399733781814575, -0.5295806527137756, -0.5186573266983032, -0.5100411772727966, -0.5097652673721313, -0.5211569666862488, -0.49069151282310486, -0.5066761374473572, -0.5070631504058838, -0.49857741594314575, -0.4895543158054352, -0.4814760088920593, -0.471103698015213, -0.4588712155818939, -0.4544117748737335, -0.46722087264060974, -0.33093899488449097, -0.3354843854904175, -0.33142563700675964, -0.3237113058567047, -0.3191380202770233, -0.31910523772239685, -0.3198327124118805, -0.31831473112106323, -0.31733277440071106, -0.32205092906951904, -0.31042587757110596, -0.312470406293869, -0.3040800988674164, -0.29196637868881226, -0.2848835587501526, -0.284983366727829, -0.2881128191947937, -0.2905397415161133, -0.2938183844089508, -0.3013595640659332, -0.2859993875026703, -0.28592538833618164, -0.2769855856895447, -0.2649720311164856, -0.25765612721443176, -0.2574322819709778, -0.2610822021961212, -0.2655046880245209, -0.27117007970809937, -0.2790584862232208, -0.27526140213012695, -0.2725876569747925, -0.26703283190727234, -0.2609490156173706, -0.258301705121994, -0.2605850100517273, -0.26528167724609375, -0.2695687711238861, -0.27285850048065186, -0.275046169757843, -0.28687989711761475, -0.2818852365016937, -0.28016045689582825, -0.28058576583862305, -0.2831721305847168, -0.2883263826370239, -0.2941146194934845, -0.2977982759475708, -0.29779309034347534, -0.2935255765914917, -0.3134588599205017, -0.3083365559577942, -0.30769631266593933, -0.3093242943286896, -0.3118150234222412, -0.3156915605068207, -0.3203886151313782, -0.32412368059158325, -0.3248271048069, -0.32071083784103394, -0.3378394544124603, -0.33609357476234436, -0.33535099029541016, -0.3341670632362366, -0.3318885266780853, -0.3301944434642792, -0.3305816948413849, -0.33328965306282043, -0.33703500032424927, -0.3389511704444885, -0.347099632024765, -0.3509196937084198, -0.351747989654541, -0.3489408791065216, -0.3428245782852173, -0.3357779085636139, -0.33062347769737244, -0.3296099901199341, -0.3336265981197357, -0.3406733274459839, -0.34419938921928406, -0.351703017950058, -0.35413625836372375, -0.3516872823238373, -0.34573495388031006, -0.3382076919078827, -0.33092859387397766, -0.3261868357658386, -0.32698336243629456, -0.3341965973377228, -0.3396070599555969, -0.34677213430404663, -0.3474956452846527, -0.343936562538147, -0.33975860476493835, -0.33622175455093384, -0.33212676644325256, -0.32724645733833313, -0.32517895102500916, -0.3299886882305145, -0.2610265910625458, -0.2524309754371643, -0.2500647008419037, -0.2522428035736084, -0.25824710726737976, -0.26762357354164124, -0.2779480814933777, -0.2848797142505646, -0.2838402986526489, -0.2739505469799042, -0.287592351436615, -0.28134751319885254, -0.27700138092041016, -0.27466174960136414, -0.27686774730682373, -0.2846113443374634, -0.2946324348449707, -0.30167198181152344, -0.30193787813186646, -0.29573965072631836, -0.3027310371398926, -0.30157434940338135, -0.2974274158477783, -0.29207441210746765, -0.290592223405838, -0.29479560256004333, -0.3009474575519562, -0.3044593334197998, -0.3044455051422119, -0.3032401204109192, -0.30223947763442993, -0.30613943934440613, -0.30373284220695496, -0.29790088534355164, -0.2950502336025238, -0.2970147430896759, -0.2991889417171478, -0.29758304357528687, -0.29486334323883057, -0.29643672704696655, -0.28273606300354004, -0.28935182094573975, -0.2876843810081482, -0.2816011607646942, -0.278106153011322, -0.27883556485176086, -0.2786443531513214, -0.27392563223838806, -0.26962190866470337, -0.2730782628059387, -0.24924339354038239, -0.25543639063835144, -0.25213104486465454, -0.2443511039018631, -0.23914508521556854, -0.23810361325740814, -0.2368762046098709, -0.23285982012748718, -0.23111772537231445, -0.23776191473007202, -0.21520671248435974, -0.2193564921617508, -0.2148565798997879, -0.20659500360488892, -0.200074702501297, -0.19677665829658508, -0.1946192979812622, -0.1929331123828888, -0.19534043967723846, -0.20443563163280487, -0.19574998319149017, -0.19743755459785461, -0.19495953619480133, -0.19061587750911713, -0.18619655072689056, -0.18241065740585327, -0.17969930171966553, -0.1793600171804428, -0.18296027183532715, -0.18974089622497559, -0.2007436901330948, -0.1985529661178589, -0.1988222599029541, -0.2005288153886795, -0.20165672898292542, -0.20157459378242493, -0.20142537355422974, -0.20251525938510895, -0.20399363338947296, -0.20347030460834503, -0.22761741280555725, -0.22090287506580353, -0.22102633118629456, -0.2255079746246338, -0.23141278326511383, -0.23746125400066376, -0.24318376183509827, -0.2472352236509323, -0.24636082351207733, -0.23849470913410187, -0.3754008412361145, -0.35918092727661133, -0.35970795154571533, -0.37099334597587585, -0.3868306577205658, -0.4041430950164795, -0.42012789845466614, -0.42954957485198975, -0.4246940314769745, -0.4028970003128052, -0.4508928656578064, -0.43946027755737305, -0.4406689405441284, -0.4491136074066162, -0.4615517854690552, -0.4767991900444031, -0.49132198095321655, -0.49864184856414795, -0.4924171268939972, -0.4728398621082306, -0.5157849788665771, -0.5142390131950378, -0.516197144985199, -0.5192801356315613, -0.5249415636062622, -0.5337162613868713, -0.5414316654205322, -0.5423404574394226, -0.5348815321922302, -0.5236620306968689, -0.5362308025360107, -0.5454362630844116, -0.547013521194458, -0.5432031154632568, -0.5410072207450867, -0.5424267053604126, -0.5422007441520691, -0.5357027053833008, -0.5274913907051086, -0.527174711227417, -0.49649253487586975, -0.5124551653862, -0.5115812420845032, -0.5007330775260925, -0.49153685569763184, -0.4871029555797577, -0.48142585158348083, -0.4708823561668396, -0.46436312794685364, -0.4742247760295868, -0.41544827818870544, -0.4313576817512512, -0.4267631471157074, -0.41144517064094543, -0.3984973430633545, -0.39107170701026917, -0.38370680809020996, -0.37420234084129333, -0.3722136616706848, -0.38855043053627014, -0.3331812620162964, -0.3438514471054077, -0.33762481808662415, -0.3236583173274994, -0.3120453357696533, -0.3046869933605194, -0.2982284724712372, -0.2925441563129425, -0.2948771119117737, -0.3112143874168396, -0.2838797867298126, -0.2869311571121216, -0.28291159868240356, -0.2766660451889038, -0.27175936102867126, -0.2678676247596741, -0.26422828435897827, -0.2625117003917694, -0.26575419306755066, -0.27455586194992065, -0.2796486020088196, -0.2736862003803253, -0.2727661430835724, -0.2763631343841553, -0.28136810660362244, -0.2850196361541748, -0.287477046251297, -0.2900209128856659, -0.290925532579422, -0.2870962619781494, -0.31405797600746155, -0.30022743344306946, -0.3005191385746002, -0.31059858202934265, -0.3239053785800934, -0.33650290966033936, -0.34723323583602905, -0.3542799651622772, -0.3518669009208679, -0.3359758257865906, -0.44171130657196045, -0.4307655096054077, -0.4329109787940979, -0.4437482953071594, -0.4583986699581146, -0.4732402265071869, -0.48475632071495056, -0.48885202407836914, -0.4813128113746643, -0.4624860882759094, -0.5335955619812012, -0.5268810987472534, -0.5308661460876465, -0.5402843952178955, -0.5520920157432556, -0.5649864077568054, -0.575585126876831, -0.5783167481422424, -0.5691853761672974, -0.5508573651313782, -0.6059514880180359, -0.6080681085586548, -0.6128734350204468, -0.6174056529998779, -0.6224965453147888, -0.6288608312606812, -0.6334291696548462, -0.6312434673309326, -0.621664822101593, -0.6108381152153015, -0.6201213598251343, -0.6316334009170532, -0.6350842118263245, -0.6321927905082703, -0.6290161609649658, -0.6278030276298523, -0.6251084804534912, -0.6172800064086914, -0.6086552739143372, -0.6090756058692932, -0.567547082901001, -0.5845085382461548, -0.584319531917572, -0.5736075043678284, -0.5630674958229065, -0.5559739470481873, -0.5483747124671936, -0.5379252433776855, -0.5326856374740601, -0.5439776182174683, -0.47635340690612793, -0.4925866723060608, -0.4881652593612671, -0.4728264808654785, -0.45882049202919006, -0.44914108514785767, -0.4400733411312103, -0.43095266819000244, -0.4307151436805725, -0.4486188292503357, -0.3895241916179657, -0.40077683329582214, -0.39465686678886414, -0.3806988000869751, -0.3685136139392853, -0.35938045382499695, -0.350986510515213, -0.3448775112628937, -0.3483559787273407, -0.36630183458328247, -0.33810922503471375, -0.3428811728954315, -0.33860158920288086, -0.33152738213539124, -0.3257707357406616, -0.32013463973999023, -0.3139950633049011, -0.3105950355529785, -0.3142279386520386, -0.325565367937088, -0.33164194226264954, -0.32910725474357605, -0.3276101052761078, -0.32921770215034485, -0.33260396122932434, -0.3341253995895386, -0.3332272469997406, -0.3325393497943878, -0.33297544717788696, -0.33306917548179626, -0.36819472908973694, -0.35924068093299866, -0.35964998602867126, -0.36784273386001587, -0.37937691807746887, -0.3895127773284912, -0.396010160446167, -0.39829251170158386, -0.39421072602272034, -0.38255518674850464, -0.3299686908721924, -0.33066678047180176, -0.3313932418823242, -0.3338392674922943, -0.3388621509075165, -0.34386682510375977, -0.3450948894023895, -0.341225266456604, -0.3348773717880249, -0.3305986523628235, -0.3449525833129883, -0.34793752431869507, -0.35022708773612976, -0.35163208842277527, -0.3536665737628937, -0.3564532697200775, -0.3577245771884918, -0.35487645864486694, -0.3488612174987793, -0.34453296661376953, -0.3618256449699402, -0.36705341935157776, -0.36997610330581665, -0.37017256021499634, -0.36945635080337524, -0.36925435066223145, -0.36891406774520874, -0.36603212356567383, -0.3609878718852997, -0.3586473762989044, -0.36105868220329285, -0.3670043349266052, -0.36923229694366455, -0.36841881275177, -0.3664993345737457, -0.36470699310302734, -0.36293286085128784, -0.3595474064350128, -0.35549992322921753, -0.35554513335227966, -0.341244101524353, -0.34561070799827576, -0.34548476338386536, -0.3431198298931122, -0.3406903147697449, -0.33868372440338135, -0.33674436807632446, -0.33414211869239807, -0.33241328597068787, -0.3350202143192291, -0.31930509209632874, -0.3203434944152832, -0.31692054867744446, -0.31295502185821533, -0.3105992078781128, -0.3090934157371521, -0.3076995015144348, -0.30702534317970276, -0.3088117837905884, -0.3139190077781677, -0.31169024109840393, -0.30982449650764465, -0.30425623059272766, -0.30005934834480286, -0.2986295819282532, -0.2975212335586548, -0.29597386717796326, -0.2964463531970978, -0.3008742332458496, -0.30757296085357666, -0.31913381814956665, -0.3165602684020996, -0.31128883361816406, -0.3086482882499695, -0.3089461028575897, -0.3081793487071991, -0.30562514066696167, -0.30520308017730713, -0.30939781665802, -0.3158006966114044, -0.32742393016815186, -0.32558050751686096, -0.32207751274108887, -0.3219148516654968, -0.3248859643936157, -0.325965940952301, -0.3234226703643799, -0.32084935903549194, -0.32158294320106506, -0.32508233189582825, -0.32770195603370667, -0.3268890678882599, -0.3255172073841095, -0.3274494409561157, -0.3328114151954651, -0.33685821294784546, -0.3361680507659912, -0.33204367756843567, -0.3281658887863159, -0.3271242082118988, -0.31629064679145813, -0.3270692229270935, -0.3249181807041168, -0.3182159662246704, -0.3135218918323517, -0.3090836703777313, -0.3008476793766022, -0.2902500629425049, -0.28647351264953613, -0.29743173718452454, -0.22517499327659607, -0.23596371710300446, -0.23488973081111908, -0.22770315408706665, -0.22032836079597473, -0.2136625498533249, -0.20630419254302979, -0.19891992211341858, -0.19741807878017426, -0.20786507427692413, -0.1825442761182785, -0.18755070865154266, -0.18708571791648865, -0.18353678286075592, -0.1787921041250229, -0.1739090234041214, -0.1702364981174469, -0.16823086142539978, -0.16892512142658234, -0.1743558943271637, -0.18671710789203644, -0.1825011968612671, -0.18271417915821075, -0.1861153542995453, -0.18864062428474426, -0.18932685256004333, -0.19105075299739838, -0.19428817927837372, -0.19555015861988068, -0.19244198501110077, -0.22755345702171326, -0.21456170082092285, -0.21476438641548157, -0.22414489090442657, -0.23376266658306122, -0.2402951866388321, -0.24688249826431274, -0.2542906403541565, -0.2560690641403198, -0.24574172496795654, -0.2972346544265747, -0.2788836658000946, -0.27742016315460205, -0.28861331939697266, -0.3017811179161072, -0.311688095331192, -0.32066383957862854, -0.33026793599128723, -0.33351945877075195, -0.3211689889431, -0.3828515410423279, -0.36400726437568665, -0.3597216308116913, -0.3685463070869446, -0.3813178241252899, -0.39139243960380554, -0.39953136444091797, -0.4084252417087555, -0.4131629467010498, -0.4042166471481323, -0.4567340910434723, -0.44289955496788025, -0.43656450510025024, -0.44071903824806213, -0.45008885860443115, -0.4574567377567291, -0.4616730511188507, -0.46634867787361145, -0.47076115012168884, -0.4683990478515625, -0.47733521461486816, -0.4726061224937439, -0.46637266874313354, -0.4657823443412781, -0.47053399682044983, -0.4739072024822235, -0.4726364016532898, -0.4703737795352936, -0.4716585576534271, -0.475867360830307, -0.42072007060050964, -0.42555299401283264, -0.42128023505210876, -0.41708144545555115, -0.4170956313610077, -0.4164598882198334, -0.41044923663139343, -0.40175214409828186, -0.39904627203941345, -0.40774402022361755, -0.4440678656101227, -0.4629340171813965, -0.4591878354549408, -0.4459429979324341, -0.4343019127845764, -0.42332640290260315, -0.4082500636577606, -0.3920357823371887, -0.3890936076641083, -0.4106593728065491, -0.33025678992271423, -0.34754669666290283, -0.34473904967308044, -0.33188509941101074, -0.3183594048023224, -0.30541956424713135, -0.29152795672416687, -0.27946141362190247, -0.2796836793422699, -0.30025190114974976, -0.2713402807712555, -0.2777029871940613, -0.2755665183067322, -0.2693215012550354, -0.26148244738578796, -0.2529616951942444, -0.2459321767091751, -0.24290774762630463, -0.2466268539428711, -0.25805360078811646, -0.2769263684749603, -0.2683032155036926, -0.26777398586273193, -0.27273520827293396, -0.2762404978275299, -0.27678465843200684, -0.27915263175964355, -0.2854481339454651, -0.29034262895584106, -0.28716614842414856, -0.3332520127296448, -0.3127787709236145, -0.3142182528972626, -0.32915911078453064, -0.343014657497406, -0.35170724987983704, -0.36112672090530396, -0.37341728806495667, -0.3780726194381714, -0.3626248240470886, -0.42056047916412354, -0.39528048038482666, -0.39696913957595825, -0.415560781955719, -0.4339108169078827, -0.4462091624736786, -0.45779696106910706, -0.47153329849243164, -0.47621873021125793, -0.45687609910964966, -0.5184080004692078, -0.4950133264064789, -0.49396899342536926, -0.5088931322097778, -0.5255993604660034, -0.5372656583786011, -0.5469554662704468, -0.5582888722419739, -0.5634594559669495, -0.5489333868026733, -0.5991567373275757, -0.5834935307502747, -0.5785362720489502, -0.5851429104804993, -0.5959613919258118, -0.6038984656333923, -0.608612596988678, -0.6140439510345459, -0.6186783313751221, -0.6143679022789001, -0.6229574680328369, -0.619858980178833, -0.6130181550979614, -0.6106453537940979, -0.6135897636413574, -0.6155834794044495, -0.6128866672515869, -0.6092920899391174, -0.6109727621078491, -0.6180443167686462, -0.5631307363510132, -0.5736708641052246, -0.5679489374160767, -0.5586462020874023, -0.5535241961479187, -0.5485406517982483, -0.5380680561065674, -0.5254608988761902, -0.5233070850372314, -0.5396581292152405, -0.47327756881713867, -0.49618208408355713, -0.4924115836620331, -0.4766472280025482, -0.46253567934036255, -0.44996246695518494, -0.4330401122570038, -0.41410669684410095, -0.40980514883995056, -0.434167742729187, -0.38974234461784363, -0.40998944640159607, -0.40643709897994995, -0.39111438393592834, -0.37565481662750244, -0.3615555167198181, -0.34599390625953674, -0.33151867985725403, -0.3309793174266815, -0.3546264171600342, -0.3370024561882019, -0.34516000747680664, -0.3419271409511566, -0.33300089836120605, -0.3227149248123169, -0.3126356303691864, -0.3043108284473419, -0.30031758546829224, -0.30494195222854614, -0.31978192925453186, -0.33260858058929443, -0.3249720633029938, -0.32373273372650146, -0.32618266344070435, -0.32665207982063293, -0.32517680525779724, -0.3268562853336334, -0.333803653717041, -0.34086889028549194, -0.3405844569206238, -0.3717838227748871, -0.35277897119522095, -0.3549520969390869, -0.3682836592197418, -0.37885427474975586, -0.3848401606082916, -0.39332854747772217, -0.4065123498439789, -0.41323500871658325, -0.399741530418396, -0.4370313882827759, -0.4152941107749939, -0.4196648895740509, -0.43739646673202515, -0.45170241594314575, -0.4596790373325348, -0.46874743700027466, -0.4821731746196747, -0.4881536066532135, -0.47076040506362915, -0.5086756348609924, -0.49126777052879333, -0.49419111013412476, -0.5081374049186707, -0.5195503830909729, -0.525104820728302, -0.5304679870605469, -0.5399506688117981, -0.545748770236969, -0.5341758728027344, -0.5658438801765442, -0.5572515726089478, -0.5561419725418091, -0.5611270666122437, -0.5661396384239197, -0.567636251449585, -0.567494809627533, -0.57016521692276, -0.5748869180679321, -0.5743279457092285, -0.5846592783927917, -0.5880022048950195, -0.5837646126747131, -0.5791552066802979, -0.5769806504249573, -0.573913037776947, -0.5673054456710815, -0.5608996152877808, -0.5621697306632996, -0.5729082822799683, -0.5501736998558044, -0.5658867359161377, -0.5612744092941284, -0.5494091510772705, -0.5404923558235168, -0.5324133038520813, -0.5193644165992737, -0.50412917137146, -0.5010133981704712, -0.5204765796661377]))

    def test_3DImg_with_pad(self):
        return_new = fu.filt_tanl(IMAGE_3D, freq=0.25, fall_off=0.35, pad=True)
        return_old = oldfu.filt_tanl(IMAGE_3D, freq=0.25, fall_off=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview().flatten(), [-0.2943558096885681, -0.2760741710662842, -0.2717200517654419, -0.2731570303440094, -0.27426788210868835, -0.27464333176612854, -0.2728683054447174, -0.26843875646591187, -0.27034616470336914, -0.28995105624198914, -0.26938679814338684, -0.2401391714811325, -0.23153339326381683, -0.23206543922424316, -0.23226332664489746, -0.23119431734085083, -0.22820572555065155, -0.22464852035045624, -0.23278899490833282, -0.26522940397262573, -0.26179787516593933, -0.22839033603668213, -0.21838925778865814, -0.2187817096710205, -0.21876643598079681, -0.217826247215271, -0.21653792262077332, -0.21695229411125183, -0.2301858365535736, -0.2661403715610504, -0.2761605978012085, -0.249503955245018, -0.24387416243553162, -0.24743185937404633, -0.2505013346672058, -0.25315892696380615, -0.25682899355888367, -0.2626121938228607, -0.2757681608200073, -0.3001731038093567, -0.31420961022377014, -0.305975079536438, -0.3096032738685608, -0.31775566935539246, -0.32496780157089233, -0.3320081830024719, -0.3409428298473358, -0.3514246642589569, -0.3596380352973938, -0.36038702726364136, -0.37571385502815247, -0.39466729760169983, -0.4084485173225403, -0.4176977574825287, -0.4249325096607208, -0.4326982796192169, -0.4440443217754364, -0.457408607006073, -0.4586253762245178, -0.431455135345459, -0.4505328834056854, -0.49897000193595886, -0.5206773281097412, -0.526152491569519, -0.5281640291213989, -0.5320574045181274, -0.5417230725288391, -0.5544753670692444, -0.5475170016288757, -0.4952150285243988, -0.5119422078132629, -0.581731379032135, -0.6070733070373535, -0.6067143082618713, -0.6017965078353882, -0.5997141599655151, -0.604193925857544, -0.6119313836097717, -0.5967988967895508, -0.5294976234436035, -0.5247542858123779, -0.5963067412376404, -0.6186008453369141, -0.6134134531021118, -0.6040427684783936, -0.5974568724632263, -0.596257746219635, -0.5978299975395203, -0.5794414281845093, -0.5149787664413452, -0.4766392409801483, -0.5280417799949646, -0.5409610867500305, -0.5338488221168518, -0.524841845035553, -0.5179614424705505, -0.5143709778785706, -0.513245701789856, -0.49986591935157776, -0.45595496892929077, -0.3648586571216583, -0.36801818013191223, -0.36983248591423035, -0.368802011013031, -0.36675962805747986, -0.3657926917076111, -0.36340972781181335, -0.3562188148498535, -0.34804102778434753, -0.34686246514320374, -0.35018107295036316, -0.3450377583503723, -0.34230732917785645, -0.33880800008773804, -0.3347522020339966, -0.3319743871688843, -0.3285457193851471, -0.32279863953590393, -0.32082194089889526, -0.3303844630718231, -0.334728479385376, -0.3233862817287445, -0.3184843063354492, -0.3151811957359314, -0.3117038607597351, -0.30951327085494995, -0.30777794122695923, -0.30630531907081604, -0.31080400943756104, -0.3261566758155823, -0.3351117670536041, -0.32722213864326477, -0.3270812928676605, -0.3295021653175354, -0.3316648006439209, -0.3344438672065735, -0.33768388628959656, -0.34098368883132935, -0.3458395302295685, -0.35231199860572815, -0.3632383346557617, -0.37110912799835205, -0.381060928106308, -0.39053505659103394, -0.39884769916534424, -0.4070132374763489, -0.4154907166957855, -0.4225774109363556, -0.4221387505531311, -0.4069660007953644, -0.4188214838504791, -0.45105910301208496, -0.47066450119018555, -0.4813532829284668, -0.4891231954097748, -0.4971470236778259, -0.5072585940361023, -0.5165005326271057, -0.5095623135566711, -0.4698808193206787, -0.48501116037368774, -0.5425481796264648, -0.5681485533714294, -0.5735065937042236, -0.5736029744148254, -0.5750669240951538, -0.5814590454101562, -0.5892603397369385, -0.5760277509689331, -0.5172697901725769, -0.5310080051422119, -0.6045212745666504, -0.6316672563552856, -0.63017737865448, -0.6215030550956726, -0.6144293546676636, -0.6133388876914978, -0.615327775478363, -0.5964837670326233, -0.5298659801483154, -0.5266762375831604, -0.5970798134803772, -0.6196988224983215, -0.6136503219604492, -0.600753664970398, -0.5888375639915466, -0.58158940076828, -0.5777672529220581, -0.5580615997314453, -0.49926838278770447, -0.4696686565876007, -0.5177995562553406, -0.5303606986999512, -0.523003339767456, -0.5119134783744812, -0.5014309883117676, -0.4935360848903656, -0.48873043060302734, -0.4754120409488678, -0.43780988454818726, -0.3661118447780609, -0.3691733479499817, -0.3657216429710388, -0.3590896725654602, -0.35462528467178345, -0.3541451692581177, -0.3544903099536896, -0.3519342541694641, -0.347214937210083, -0.34442993998527527, -0.350834459066391, -0.34656473994255066, -0.33699530363082886, -0.3257456421852112, -0.31835705041885376, -0.31644752621650696, -0.3169453740119934, -0.3174016773700714, -0.3196684420108795, -0.3265538811683655, -0.32821664214134216, -0.31655600666999817, -0.3031841516494751, -0.29076629877090454, -0.28323113918304443, -0.28124701976776123, -0.28227028250694275, -0.2857905626296997, -0.2947349548339844, -0.3101145923137665, -0.31155991554260254, -0.29735156893730164, -0.28573372960090637, -0.27790650725364685, -0.2750934958457947, -0.2763085961341858, -0.27914783358573914, -0.2841329872608185, -0.2942678928375244, -0.3094157874584198, -0.30964237451553345, -0.2985299229621887, -0.29154571890830994, -0.28946453332901, -0.2918582856655121, -0.2965010106563568, -0.3012656271457672, -0.3069891333580017, -0.31509095430374146, -0.32362762093544006, -0.32224398851394653, -0.3171265125274658, -0.31261733174324036, -0.3110881447792053, -0.3131169378757477, -0.3168213963508606, -0.32136890292167664, -0.32818570733070374, -0.33590421080589294, -0.3389558494091034, -0.34029698371887207, -0.34142568707466125, -0.33693927526474, -0.3315649926662445, -0.3282032907009125, -0.32638415694236755, -0.32738763093948364, -0.3340131342411041, -0.3427695333957672, -0.3443310856819153, -0.3513198494911194, -0.3567981719970703, -0.3527030944824219, -0.3447685241699219, -0.33686861395835876, -0.3292732834815979, -0.3249771296977997, -0.3286758065223694, -0.3370717465877533, -0.33944448828697205, -0.34842994809150696, -0.3537779450416565, -0.35040464997291565, -0.34336015582084656, -0.33551034331321716, -0.32644784450531006, -0.319341242313385, -0.32005128264427185, -0.3271407186985016, -0.3312230706214905, -0.33731627464294434, -0.3383181691169739, -0.33456796407699585, -0.32975873351097107, -0.3251030147075653, -0.3190572261810303, -0.31354233622550964, -0.31379860639572144, -0.3200993537902832, -0.325940877199173, -0.31659987568855286, -0.30789077281951904, -0.29789116978645325, -0.29086804389953613, -0.29057860374450684, -0.29625362157821655, -0.30428457260131836, -0.3117679953575134, -0.3171723783016205, -0.32038575410842896, -0.3147648572921753, -0.3066467344760895, -0.29376333951950073, -0.2828722894191742, -0.2806253135204315, -0.2867565453052521, -0.2971324920654297, -0.3083868622779846, -0.317205548286438, -0.32084009051322937, -0.3195880651473999, -0.3144172728061676, -0.30080482363700867, -0.2872380316257477, -0.282446950674057, -0.2865760624408722, -0.29544350504875183, -0.3062622547149658, -0.31578564643859863, -0.319924533367157, -0.32024824619293213, -0.3158532679080963, -0.30268362164497375, -0.2891578674316406, -0.28358542919158936, -0.2856222987174988, -0.2908479869365692, -0.29748621582984924, -0.3049657344818115, -0.3110705614089966, -0.30719003081321716, -0.29698729515075684, -0.2824229598045349, -0.27000245451927185, -0.2648841142654419, -0.2652827501296997, -0.26681721210479736, -0.2694395184516907, -0.2768767178058624, -0.2903834283351898, -0.2815829813480377, -0.25920405983924866, -0.24007077515125275, -0.22774507105350494, -0.2225956916809082, -0.22097811102867126, -0.21953943371772766, -0.2210971713066101, -0.2336837351322174, -0.2609148621559143, -0.25372594594955444, -0.21900902688503265, -0.19609211385250092, -0.18482773005962372, -0.18009427189826965, -0.1764684021472931, -0.1726042628288269, -0.17481309175491333, -0.19425171613693237, -0.23504756391048431, -0.23672214150428772, -0.19684217870235443, -0.17592957615852356, -0.16984495520591736, -0.1684444695711136, -0.16485688090324402, -0.15979811549186707, -0.16230124235153198, -0.18457140028476715, -0.22995474934577942, -0.24123945832252502, -0.2056608647108078, -0.1917160451412201, -0.19292965531349182, -0.19700175523757935, -0.19658344984054565, -0.19322113692760468, -0.19611968100070953, -0.2157101184129715, -0.2537500560283661, -0.269283264875412, -0.24463962018489838, -0.23782292008399963, -0.24301762878894806, -0.25010666251182556, -0.25309813022613525, -0.2530178725719452, -0.2563963532447815, -0.2697918117046356, -0.2934408187866211, -0.3505023717880249, -0.3590059280395508, -0.36192235350608826, -0.36467060446739197, -0.37256112694740295, -0.38491418957710266, -0.39787691831588745, -0.40676191449165344, -0.4041363596916199, -0.3846823275089264, -0.393647164106369, -0.4207494854927063, -0.43059468269348145, -0.43346428871154785, -0.44130739569664, -0.45569929480552673, -0.47194981575012207, -0.48227328062057495, -0.4730784595012665, -0.4346373975276947, -0.4475609064102173, -0.4942651093006134, -0.5098578333854675, -0.5096045136451721, -0.5123082995414734, -0.5223197937011719, -0.5348337888717651, -0.5404868125915527, -0.5227731466293335, -0.4700123369693756, -0.4781765639781952, -0.5327338576316833, -0.548346757888794, -0.5428175926208496, -0.5382850766181946, -0.540630042552948, -0.5449732542037964, -0.5423449873924255, -0.5190004706382751, -0.4660240411758423, -0.46331116557121277, -0.507011353969574, -0.515447199344635, -0.5048822164535522, -0.494905024766922, -0.49049630761146545, -0.48691731691360474, -0.4778738021850586, -0.4570154547691345, -0.4212678074836731, -0.4103547930717468, -0.4291391968727112, -0.42672431468963623, -0.4142288267612457, -0.40329229831695557, -0.3955420255661011, -0.38708826899528503, -0.3763485848903656, -0.36579635739326477, -0.35787004232406616, -0.3481014668941498, -0.3414119780063629, -0.33176785707473755, -0.3231172263622284, -0.3165924847126007, -0.30942678451538086, -0.2993936240673065, -0.29014500975608826, -0.2909450829029083, -0.3072976768016815, -0.3055991530418396, -0.2850068211555481, -0.2764517366886139, -0.277165025472641, -0.27924931049346924, -0.27633950114250183, -0.26794663071632385, -0.2611983120441437, -0.26771223545074463, -0.2931636869907379, -0.29650574922561646, -0.2759983539581299, -0.27384382486343384, -0.28391408920288086, -0.29451948404312134, -0.29794755578041077, -0.2943379878997803, -0.29078277945518494, -0.296561598777771, -0.315397173166275, -0.3150486350059509, -0.3030260503292084, -0.30619919300079346, -0.3190753161907196, -0.3321837782859802, -0.3394179940223694, -0.34055274724960327, -0.33976224064826965, -0.34171155095100403, -0.347830206155777, -0.40295061469078064, -0.42944419384002686, -0.44442829489707947, -0.45360758900642395, -0.4635263681411743, -0.4744538962841034, -0.48322007060050964, -0.48505449295043945, -0.47116315364837646, -0.4351101815700531, -0.4610498249530792, -0.5108839273452759, -0.5356350541114807, -0.5460862517356873, -0.5558120608329773, -0.5678422451019287, -0.5785943269729614, -0.5799023509025574, -0.55610591173172, -0.4964263141155243, -0.518326997756958, -0.5879989862442017, -0.6182071566581726, -0.6251357793807983, -0.6291584372520447, -0.6361578702926636, -0.6429008841514587, -0.6395277380943298, -0.6067807674407959, -0.5319263935089111, -0.5423069000244141, -0.6167654991149902, -0.6441753506660461, -0.6439542174339294, -0.6397752165794373, -0.6388164162635803, -0.6381534934043884, -0.6285655498504639, -0.5928812026977539, -0.5203480124473572, -0.5170031189918518, -0.5770891308784485, -0.593812882900238, -0.586016058921814, -0.5753322243690491, -0.5678064227104187, -0.5607064366340637, -0.5478017330169678, -0.5185953974723816, -0.466665118932724, -0.45559531450271606, -0.48894327878952026, -0.49224549531936646, -0.4804290533065796, -0.4682130813598633, -0.45803889632225037, -0.44761931896209717, -0.4355601370334625, -0.41953715682029724, -0.39715608954429626, -0.3893953263759613, -0.3971214294433594, -0.391463965177536, -0.3817172348499298, -0.37348082661628723, -0.36453482508659363, -0.35353854298591614, -0.34420448541641235, -0.3405981659889221, -0.34257784485816956, -0.3448483347892761, -0.33804208040237427, -0.3311251103878021, -0.3282853662967682, -0.32749465107917786, -0.3227643370628357, -0.3136378526687622, -0.3069496750831604, -0.3093213438987732, -0.3211367130279541, -0.32879653573036194, -0.31864210963249207, -0.3146856725215912, -0.318560391664505, -0.32488512992858887, -0.3260316550731659, -0.3213445842266083, -0.31736838817596436, -0.31968581676483154, -0.3284401297569275, -0.33219778537750244, -0.32465946674346924, -0.32320544123649597, -0.32910212874412537, -0.33784011006355286, -0.34282976388931274, -0.34262216091156006, -0.34108516573905945, -0.34128639101982117, -0.3432367742061615, -0.3448559641838074, -0.348000168800354, -0.34955352544784546, -0.3518916368484497, -0.355598509311676, -0.3582943379878998, -0.35840925574302673, -0.3569626212120056, -0.35450252890586853, -0.3497297167778015, -0.3532163202762604, -0.3602856695652008, -0.3616727888584137, -0.3619324266910553, -0.36372900009155273, -0.3653120994567871, -0.36562463641166687, -0.3653727173805237, -0.36285898089408875, -0.35490795969963074, -0.3600686490535736, -0.36885562539100647, -0.3685818910598755, -0.36622926592826843, -0.36560511589050293, -0.36495181918144226, -0.36409780383110046, -0.3640916347503662, -0.361788809299469, -0.3528560400009155, -0.3574671745300293, -0.3637773096561432, -0.36029019951820374, -0.3557625114917755, -0.35376623272895813, -0.35159242153167725, -0.34954747557640076, -0.3496559262275696, -0.3489484190940857, -0.34274396300315857, -0.34360480308532715, -0.3434833586215973, -0.33513209223747253, -0.3282705843448639, -0.32568374276161194, -0.3233118951320648, -0.3214064836502075, -0.3234255611896515, -0.3274691104888916, -0.32802802324295044, -0.3265516757965088, -0.31922805309295654, -0.30568960309028625, -0.2965973913669586, -0.2941243350505829, -0.292553573846817, -0.2917817533016205, -0.29708781838417053, -0.30753666162490845, -0.3156556785106659, -0.3193342089653015, -0.30907389521598816, -0.29308271408081055, -0.2832300066947937, -0.28156647086143494, -0.28080907464027405, -0.2806057929992676, -0.28793641924858093, -0.30205976963043213, -0.31319883465766907, -0.3267204761505127, -0.3193189799785614, -0.3047594130039215, -0.2959657311439514, -0.2954505681991577, -0.2951383888721466, -0.29446256160736084, -0.3009808361530304, -0.3134515583515167, -0.3211085796356201, -0.3373778760433197, -0.3336001932621002, -0.3215269446372986, -0.3143528997898102, -0.3151811957359314, -0.3159555494785309, -0.31525740027427673, -0.3194931149482727, -0.32725977897644043, -0.32941102981567383, -0.3380235433578491, -0.33406946063041687, -0.3234119415283203, -0.31750768423080444, -0.31919705867767334, -0.3213372528553009, -0.32151225209236145, -0.3240414261817932, -0.3284226655960083, -0.3290560841560364, -0.2970157563686371, -0.28148362040519714, -0.26944318413734436, -0.2625074088573456, -0.25832056999206543, -0.2529154121875763, -0.2460787445306778, -0.24346581101417542, -0.2527247965335846, -0.27582770586013794, -0.2633800208568573, -0.235218808054924, -0.21518458425998688, -0.20433759689331055, -0.1977841556072235, -0.1900731921195984, -0.18225926160812378, -0.18253253400325775, -0.20029498636722565, -0.23740598559379578, -0.23021626472473145, -0.18957248330116272, -0.16447623074054718, -0.15508830547332764, -0.1519576460123062, -0.14670990407466888, -0.14153426885604858, -0.14659564197063446, -0.17124509811401367, -0.21631622314453125, -0.21997575461864471, -0.1761302947998047, -0.1526045799255371, -0.14965161681175232, -0.1544073522090912, -0.15565918385982513, -0.15600824356079102, -0.16610600054264069, -0.1923779845237732, -0.23244640231132507, -0.2429935187101364, -0.20892170071601868, -0.19178102910518646, -0.19459913671016693, -0.20593278110027313, -0.21377994120121002, -0.22037436068058014, -0.23519091308116913, -0.2587340474128723, -0.2823697328567505, -0.29423269629478455, -0.2799663245677948, -0.27006280422210693, -0.2739199995994568, -0.2870143949985504, -0.2985793352127075, -0.30976155400276184, -0.3278765380382538, -0.3460121154785156, -0.3475174307823181, -0.3624321520328522, -0.3728523254394531, -0.36946332454681396, -0.3701879680156708, -0.3803834021091461, -0.39159566164016724, -0.40363767743110657, -0.4215002655982971, -0.4315558075904846, -0.4102424383163452, -0.4280637502670288, -0.4606674015522003, -0.4624894857406616, -0.4586174190044403, -0.46322259306907654, -0.4704006016254425, -0.4789222776889801, -0.4918754994869232, -0.49196186661720276, -0.45288655161857605, -0.4586307406425476, -0.49991124868392944, -0.5030868649482727, -0.4955293536186218, -0.4951769709587097, -0.49770963191986084, -0.5009775757789612, -0.5069359540939331, -0.4995916485786438, -0.455861359834671, -0.43414387106895447, -0.4652644693851471, -0.4649476110935211, -0.45627912878990173, -0.4541875720024109, -0.4545254707336426, -0.45450925827026367, -0.4559129476547241, -0.44848865270614624, -0.4167642295360565, -0.38773736357688904, -0.4030952751636505, -0.40159785747528076, -0.39180830121040344, -0.38114920258522034, -0.3702489137649536, -0.3591766655445099, -0.35071268677711487, -0.3468770980834961, -0.3457769453525543, -0.36952608823776245, -0.3767046332359314, -0.37024983763694763, -0.3581528961658478, -0.3455597460269928, -0.3319196403026581, -0.3188088536262512, -0.31156685948371887, -0.3136045038700104, -0.32249146699905396, -0.3295697271823883, -0.32189318537712097, -0.31208479404449463, -0.30546367168426514, -0.30030032992362976, -0.2920967936515808, -0.2835705280303955, -0.2823186218738556, -0.29163649678230286, -0.3077775239944458, -0.31415894627571106, -0.3018898367881775, -0.296024888753891, -0.3004600703716278, -0.3079649806022644, -0.31022050976753235, -0.3102646768093109, -0.31601330637931824, -0.3268030881881714, -0.33478233218193054, -0.345552921295166, -0.3464508056640625, -0.3500092327594757, -0.3629958927631378, -0.3796098530292511, -0.39066392183303833, -0.3987194299697876, -0.40982183814048767, -0.4155336618423462, -0.40044930577278137, -0.41079673171043396, -0.436995267868042, -0.44967761635780334, -0.46342164278030396, -0.48117581009864807, -0.49570032954216003, -0.508320152759552, -0.5220993757247925, -0.519569993019104, -0.476291298866272, -0.48669078946113586, -0.5406855344772339, -0.5591632723808289, -0.5670205354690552, -0.5793057084083557, -0.5918727517127991, -0.6044670343399048, -0.6173644065856934, -0.6058678030967712, -0.5382704734802246, -0.5477598309516907, -0.6223459243774414, -0.6430633068084717, -0.6429274082183838, -0.6468656063079834, -0.653516411781311, -0.6614262461662292, -0.6693190336227417, -0.6497658491134644, -0.5686713457107544, -0.559804379940033, -0.6366003155708313, -0.6547029614448547, -0.6485949754714966, -0.6458834409713745, -0.6462953686714172, -0.6476902961730957, -0.6489332914352417, -0.6261093020439148, -0.5493676662445068, -0.5047211050987244, -0.5609009265899658, -0.5710547566413879, -0.5630980730056763, -0.5586259961128235, -0.5563496947288513, -0.5538954734802246, -0.5515592694282532, -0.5339792966842651, -0.4806573987007141, -0.4809155762195587, -0.5294287204742432, -0.5403581261634827, -0.529695987701416, -0.5156195163726807, -0.5036173462867737, -0.49312469363212585, -0.48188516497612, -0.46319082379341125, -0.43003353476524353, -0.48963484168052673, -0.5397299528121948, -0.5505431294441223, -0.5386643409729004, -0.5223904848098755, -0.5073536038398743, -0.4942600727081299, -0.482119083404541, -0.46392807364463806, -0.43146851658821106, -0.450801283121109, -0.4867852032184601, -0.4948999881744385, -0.4884771704673767, -0.4791121780872345, -0.4689372479915619, -0.45972421765327454, -0.45262399315834045, -0.4409888982772827, -0.4158317744731903, -0.4176672697067261, -0.44232073426246643, -0.45083585381507874, -0.45360055565834045, -0.45533958077430725, -0.45411422848701477, -0.45209693908691406, -0.4516260027885437, -0.4444189667701721, -0.4191337525844574, -0.41885972023010254, -0.44477635622024536, -0.45639726519584656, -0.46489498019218445, -0.47369179129600525, -0.47898826003074646, -0.4826987385749817, -0.48697590827941895, -0.47963249683380127, -0.4447011947631836, -0.4421316087245941, -0.47756871581077576, -0.4907526969909668, -0.4976731836795807, -0.5062275528907776, -0.5128742456436157, -0.5187094211578369, -0.525242805480957, -0.5161596536636353, -0.4701025187969208, -0.46729013323783875, -0.5126152634620667, -0.5240453481674194, -0.5241166353225708, -0.5274857878684998, -0.5315359830856323, -0.5362603068351746, -0.5429161787033081, -0.5328478217124939, -0.4807755947113037, -0.4812256693840027, -0.531379759311676, -0.5393283367156982, -0.5322014093399048, -0.5295428037643433, -0.5293483138084412, -0.5306963324546814, -0.5352644324302673, -0.5250331163406372, -0.4741840362548828, -0.4697342813014984, -0.5149383544921875, -0.5188614130020142, -0.5081554651260376, -0.5022417902946472, -0.49889010190963745, -0.49662044644355774, -0.4979730546474457, -0.4889356195926666, -0.447549432516098, -0.4266258180141449, -0.4560002088546753, -0.45557448267936707, -0.44593584537506104, -0.44096627831459045, -0.43749144673347473, -0.4338580369949341, -0.43335288763046265, -0.4281182587146759, -0.4033485949039459]))

    def test_3DImgBlank_without_pad(self):
        return_new = fu.filt_tanl(IMAGE_BLANK_3D, freq=0.25, fall_off=0.35, pad=False)
        return_old = oldfu.filt_tanl(IMAGE_BLANK_3D, freq=0.25, fall_off=0.35, pad=False)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview(), IMAGE_BLANK_3D.get_3dview()))

    def test_3DImgBlank_with_pad(self):
        return_new = fu.filt_tanl(IMAGE_BLANK_3D, freq=0.25, fall_off=0.35, pad=True)
        return_old = oldfu.filt_tanl(IMAGE_BLANK_3D, freq=0.25, fall_off=0.35, pad=True)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview(), IMAGE_BLANK_3D.get_3dview()))



class Test_filt_table(unittest.TestCase):
    table = [entry for entry in linspace(0, 0.5).tolist()]

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_table()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_table()
        self.assertEqual(str(cm_new.exception), "filt_table() takes exactly 2 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_empty_input_image(self):
        with self.assertRaises(RuntimeError) as cm_new:
            fu.filt_table(EMData(), self.table)
        with self.assertRaises(RuntimeError) as cm_old:
            oldfu.filt_table(EMData(), self.table)
        msg = str(cm_new.exception).split("'")
        msg_old = str(cm_old.exception).split("'")
        self.assertEqual(msg[0].split(" ")[0], "InvalidValueException")
        self.assertEqual(msg[3], 'x size <= 0')
        self.assertEqual(msg[0].split(" ")[0], msg_old[0].split(" ")[0])
        self.assertEqual(msg[3], msg_old[3])

    def test_NoneType_Img(self):
        return_new =  fu.filt_table(None,  self.table )
        return_old = oldfu.filt_table(None,  self.table)
        self.assertEqual(return_new,return_old)
        self.assertEqual(return_new,None)

    def test_2DImg(self):
        return_new = fu.filt_table(IMAGE_2D, self.table)
        return_old = oldfu.filt_table(IMAGE_2D, self.table)
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview().flatten(), [0.004537484142929316, 0.00577711034566164, 0.005284929648041725, 0.006083904765546322, 0.005551035050302744, 0.005202386062592268, 0.005103022325783968, 0.005491855554282665, 0.005371409934014082, 0.006110592745244503, 0.0017173021333292127, 0.0011058824602514505, 0.0010726818582043052, 0.0004334177647251636, 0.0003373814979568124, 0.001775685464963317, 0.0008658304577693343, 0.0009943469194695354, 0.0019719016272574663, 0.0017949260072782636, 0.0017567069735378027, 0.0015279455110430717, 0.0022043995559215546, 0.0019994492176920176, 0.0020679347217082977, 0.0017962412675842643, 0.002005414105951786, 0.003249653149396181, 0.002311699790880084, 0.000986945116892457, 0.0014057114021852612, 0.002147964434698224, 0.001751869567669928, 0.0013983394019305706, 0.002454927656799555, 0.0035838682670146227, 0.002287253038957715, 0.0011977156391367316, 0.0016035918379202485, 0.001911002560518682, 0.002175272675231099, 0.0010479649063199759, 0.0019351266091689467, 0.0011564140440896153, 0.0016492126742377877, 0.000331083225319162, 0.00048135718679986894, 0.0006215186440385878, 0.0009345902944914997, -0.0008830402512103319, 0.0014430367155000567, 0.0006846105097793043, -0.000576281629037112, 1.5016944416856859e-05, -1.3497638974513393e-05, 3.098867819062434e-05, 0.00041677398257888854, -0.00047985868877731264, -1.64624689205084e-05, -0.0005399649380706251, 0.0017280315514653921, -0.0002621468738652766, 0.0002311010757694021, -0.00022319634445011616, -0.0005480923573486507, -0.001089233672246337, 4.339635415817611e-05, 1.7632972230785526e-05, -0.0006725027924403548, -0.0023752236738801003, -0.0015498549910262227, -0.002135777147486806, -0.0029276679269969463, -0.002967230277135968, -0.0024614327121526003, -0.0020180433057248592, -0.003480820218101144, -0.002639039186760783, -0.0026691558305174112, -0.0030049458146095276, -0.0010297324042767286, -0.0006122427876107395, -0.0006440550787374377, -0.000419652002165094, -0.0013622106052935123, -0.0020238757133483887, -0.0009676340268924832, -0.002098869066685438, -0.0016270463820546865, -0.00394710898399353, -0.007658934220671654, -0.007652705069631338, -0.00835066195577383, -0.008238104172050953, -0.007430971600115299, -0.006811320781707764, -0.0070913308300077915, -0.006311005912721157, -0.006959202699363232, -0.006404730025678873]))

    def test_2DImgBlank(self):
        return_new = fu.filt_table(IMAGE_BLANK_2D, self.table)
        return_old = oldfu.filt_table(IMAGE_BLANK_2D, self.table)
        self.assertTrue(array_equal(return_new.get_2dview(), return_old.get_2dview()))
        self.assertTrue(array_equal(return_old.get_2dview(), IMAGE_BLANK_2D.get_2dview()))

    def test_3DImg(self):
        return_new = fu.filt_table(IMAGE_3D, self.table)
        return_old = oldfu.filt_table(IMAGE_3D, self.table)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview().flatten(), [0.017490774393081665, 0.019071416929364204, 0.018211407586932182, 0.018842117860913277, 0.01789993606507778, 0.017267802730202675, 0.017071008682250977, 0.0174106415361166, 0.017323631793260574, 0.01820208691060543, 0.015559691935777664, 0.014849159866571426, 0.014554893597960472, 0.013563418760895729, 0.01343208085745573, 0.015103016048669815, 0.013998589478433132, 0.014136729761958122, 0.015243453904986382, 0.015164966695010662, 0.014908888377249241, 0.01485442090779543, 0.01547565869987011, 0.014861433766782284, 0.014872433617711067, 0.014543873257935047, 0.014615077525377274, 0.015856808051466942, 0.014573447406291962, 0.013090576976537704, 0.013335742056369781, 0.014428175054490566, 0.014029799029231071, 0.013681231997907162, 0.015064200386404991, 0.01640133373439312, 0.014697355218231678, 0.01333800982683897, 0.013767078518867493, 0.013997852802276611, 0.013502601534128189, 0.012250948697328568, 0.013190473429858685, 0.012276005931198597, 0.012911162339150906, 0.01142921019345522, 0.011497977189719677, 0.01161049772053957, 0.011983171105384827, 0.010112692601978779, 0.01187580544501543, 0.010934408754110336, 0.009359952993690968, 0.010040869005024433, 0.00996897742152214, 0.010021109133958817, 0.010555458255112171, 0.009549597278237343, 0.009962793439626694, 0.009557854384183884, 0.010752451606094837, 0.008363468572497368, 0.008639667183160782, 0.00804504007101059, 0.007472550496459007, 0.0068392641842365265, 0.008188633248209953, 0.00836943555623293, 0.007515220437198877, 0.005894424393773079, 0.005824222229421139, 0.005537513177841902, 0.004472463391721249, 0.004272151738405228, 0.004413376096636057, 0.004406941123306751, 0.0025236867368221283, 0.003206439781934023, 0.002891821088269353, 0.002571405377238989, 0.003956411499530077, 0.0048898495733737946, 0.0047303661704063416, 0.004750738386064768, 0.0033141341991722584, 0.002395322546362877, 0.0033125625923275948, 0.0017428186256438494, 0.002098487690091133, -0.00048152924864552915, -0.0030740376096218824, -0.00295448605902493, -0.003986686002463102, -0.004037975799292326, -0.003237832337617874, -0.002699937904253602, -0.003067074343562126, -0.0022024575155228376, -0.003169373841956258, -0.002751795342192054, 0.000761904229875654, -0.0012203026562929153, -0.0003490636881906539, -0.0008695825817994773, -0.0005926882149651647, 0.00018421298591420054, -0.0006839600391685963, -0.0010888860560953617, -0.0019741107244044542, -0.0016168308211490512, -0.00410839356482029, -0.004423860460519791, -0.00484028086066246, -0.005537330638617277, -0.007328354753553867, -0.008609241805970669, -0.00868146400898695, -0.008969539776444435, -0.00916223507374525, -0.01045492384582758, -0.009256260469555855, -0.009102351032197475, -0.00909857451915741, -0.007294691167771816, -0.0075106387957930565, -0.0078007313422858715, -0.007799702230840921, -0.007310636807233095, -0.007393674924969673, -0.007391124963760376, -0.007227934431284666, -0.009380491450428963, -0.008877036161720753, -0.009536745958030224, -0.009639188647270203, -0.010718096047639847, -0.009973845444619656, -0.010536721907556057, -0.011372187174856663, -0.012685161083936691, -0.010731876827776432, -0.011783621273934841, -0.012380323372781277, -0.012266475707292557, -0.01287857349961996, -0.013179691508412361, -0.013643469661474228, -0.014082708396017551, -0.01410458330065012, -0.0156306941062212, -0.014135478995740414, -0.01462352555245161, -0.014807455241680145, -0.015211139805614948, -0.015148126520216465, -0.016008511185646057, -0.016125451773405075, -0.016075491905212402, -0.01617172546684742, -0.017919640988111496, -0.015834802761673927, -0.016193585470318794, -0.01622938923537731, -0.016717026010155678, -0.016965674236416817, -0.017091460525989532, -0.017888115718960762, -0.020157070830464363, -0.020604096353054047, -0.022702811285853386, -0.022510262206196785, -0.022981664165854454, -0.02373064123094082, -0.024061059579253197, -0.023566165938973427, -0.022626332938671112, -0.02203075960278511, -0.02169468067586422, -0.02095017023384571, -0.020773032680153847, -0.020787818357348442, -0.02097577415406704, -0.020690711215138435, -0.02027992345392704, -0.01960892789065838, -0.019071124494075775, -0.019476555287837982, -0.018226012587547302, -0.018564190715551376, -0.01744282804429531, -0.0208823774009943, -0.018871789798140526, -0.018186237663030624, -0.017831958830356598, -0.01729215309023857, -0.016227195039391518, -0.015770183876156807, -0.01537187397480011, -0.014428062364459038, -0.012030339799821377, -0.018036743625998497, -0.01562986522912979, -0.015808677300810814, -0.01523948460817337, -0.015132153406739235, -0.015078650787472725, -0.01553838886320591, -0.014227304607629776, -0.012530521489679813, -0.009288053959608078, -0.004889646545052528, -0.0037616307381540537, -0.0015471149235963821, 3.604292942327447e-05, 0.000291262986138463, 0.0008701296173967421, 0.0009093389962799847, -1.2341261935944203e-05, -0.0006541504990309477, -0.00045362618402577937, -0.0027637381572276354, -0.002785148797556758, -0.003488240297883749, -0.0031260186806321144, -0.0024979158770292997, -0.0013267882168293, -0.0014496365329250693, -0.00038861430948600173, -0.0009300942765548825, -0.00022811330563854426, -0.0003575502778403461, 0.001258837291970849, 0.0024708432611078024, 0.002754335990175605, 0.0029129921458661556, 0.00219060480594635, 0.0030987397767603397, 0.002310508629307151, 0.0025831651873886585, 0.003684978699311614, 0.0029397711623460054, 0.0027333658654242754, 0.001983043272048235, 0.0010429508984088898, 0.0002703349746298045, 0.0011778977932408452, 0.00099957047495991, 0.0013431137194857001, 0.0020171357318758965, 0.002744007622823119, 0.002760354895144701, 0.0020697221625596285, 0.0024408637546002865, 0.0031321728602051735, 0.0027701423969119787, 0.0029672207310795784, 0.004071349278092384, 0.0038380806799978018, 0.0048250313848257065, 0.005262879654765129, 0.00423677871003747, 0.004798218607902527, 0.004782978445291519, 0.005654824897646904, 0.0061919488944113255, 0.006338383536785841, 0.006656446494162083, 0.007457289844751358, 0.006522458977997303, 0.00818132609128952, 0.007471315562725067, 0.007099134381860495, 0.00876654777675867, 0.008603873662650585, 0.008507553488016129, 0.009575407020747662, 0.009161991998553276, 0.009438005276024342, 0.009300542064011097, 0.009410353377461433, 0.008568636141717434, 0.010069495998322964, 0.008841031230986118, 0.008729497902095318, 0.009442374110221863, 0.008537741377949715, 0.008579755201935768, 0.008951394818723202, 0.009895660914480686, 0.009836207143962383, 0.013870037160813808, 0.013661135919392109, 0.012878325767815113, 0.012838014401495457, 0.012339332140982151, 0.012005048803985119, 0.011823388747870922, 0.012609990313649178, 0.011527358554303646, 0.010723096318542957, 0.0073868813924491405, 0.006835986860096455, 0.007422569673508406, 0.0065390607342123985, 0.008645158261060715, 0.007372171618044376, 0.00738711329177022, 0.00754737900570035, 0.006224779412150383, 0.007318247575312853, 0.006190320942550898, 0.006987858098000288, 0.006002385634928942, 0.004874463193118572, 0.0052654859609901905, 0.0059415241703391075, 0.005769921466708183, 0.005947830621153116, 0.004875881597399712, 0.006644950248301029, 0.0062079220078885555, 0.004340778570622206, 0.005532136186957359, 0.0066804117523133755, 0.006219321396201849, 0.005745467729866505, 0.005617494694888592, 0.005864370614290237, 0.006501463241875172, 0.005641827825456858, 0.006076547782868147, 0.006654113996773958, 0.006844842340797186, 0.006395838223397732, 0.007073046173900366, 0.0073473770171403885, 0.006363694556057453, 0.007386054378002882, 0.007127758581191301, 0.006468081846833229, 0.006680832244455814, 0.008028127253055573, 0.007482430897653103, 0.007839375175535679, 0.010286329314112663, 0.008522426709532738, 0.008363143540918827, 0.008439372293651104, 0.00808371976017952, 0.008769476786255836, 0.00893153715878725, 0.009209539741277695, 0.010013775900006294, 0.009900097735226154, 0.00938066653907299, 0.010248883627355099, 0.00991852581501007, 0.010261407122015953, 0.010008485987782478, 0.00980641320347786, 0.01024603471159935, 0.010887316428124905, 0.010701584629714489, 0.011127660050988197, 0.011649712920188904, 0.010509306564927101, 0.009642835706472397, 0.01026119850575924, 0.011149484664201736, 0.009926154278218746, 0.010189413093030453, 0.01210799627006054, 0.011435314081609249, 0.01197424903512001, 0.012088211253285408, 0.011201821267604828, 0.01210088562220335, 0.011746576055884361, 0.01158620323985815, 0.012432316318154335, 0.01223993394523859, 0.012267554178833961, 0.011618666350841522, 0.010992972180247307, 0.011119144037365913, 0.012773731723427773, 0.012671513482928276, 0.013032282702624798, 0.011518907733261585, 0.011593391187489033, 0.012183683924376965, 0.01029745303094387, 0.011388459242880344, 0.011947215534746647, 0.011115465313196182, 0.010724589228630066, 0.011293123476207256, 0.009874106384813786, 0.010590358637273312, 0.008382448926568031, 0.015210147015750408, 0.013522574678063393, 0.014221198856830597, 0.014091026037931442, 0.012341784313321114, 0.012617693282663822, 0.011757805943489075, 0.012158283032476902, 0.013004565611481667, 0.011571505106985569, 0.008408806286752224, 0.008203182369470596, 0.00764013035222888, 0.007300331722944975, 0.007824229076504707, 0.006078090984374285, 0.006697487086057663, 0.006162459496408701, 0.006414005067199469, 0.0049494728446006775, 0.0074855913408100605, 0.006082849111407995, 0.005857495591044426, 0.006685934495180845, 0.004753079731017351, 0.005864833015948534, 0.006003724876791239, 0.005009360611438751, 0.0052219051867723465, 0.00457086181268096, 0.003932138904929161, 0.004426239058375359, 0.0036897773388773203, 0.004171851556748152, 0.003692382015287876, 0.0027051807846874, 0.0031640431843698025, 0.002597363432869315, 0.002352958545088768, 0.0018744580447673798, 0.0022160967346280813, 0.0006451478111557662, 0.00021017281687818468, -0.00045248944661580026, -0.0005565066821873188, -0.00037214686744846404, -0.0013243481516838074, -0.0008054696954786777, 0.00012802220589946955, -8.344304660568014e-05, -0.0015835651429370046, -0.0014840462245047092, -0.0016700676642358303, -0.0025845877826213837, -0.0025553477462381124, -0.0025412917602807283, -0.002194746630266309, -0.0023174872621893883, -0.0021083855535835028, -0.0019874051213264465, -0.0020809746347367764, -0.002922504674643278, -0.003928628284484148, -0.004039001651108265, -0.00524559523910284, -0.004699032753705978, -0.004585486836731434, -0.0058948746882379055, -0.0064295073971152306, -0.00811882596462965, -0.008950713090598583, -0.00789999682456255, -0.008597854524850845, -0.008352113887667656, -0.007648867554962635, -0.008129131980240345, -0.008757440373301506, -0.008330796845257282, -0.008306284435093403, -0.007763700559735298, -0.007138852961361408, -0.009664909914135933, -0.009113875217735767, -0.009924829006195068, -0.010517277754843235, -0.01161263883113861, -0.011020075529813766, -0.011054504662752151, -0.011133942753076553, -0.012381810694932938, -0.015387775376439095, -0.016478383913636208, -0.01699768379330635, -0.017775921151041985, -0.017479531466960907, -0.01776546984910965, -0.01808977872133255, -0.0184924453496933, -0.019530346617102623, -0.020790550857782364, -0.017677240073680878, -0.018836449831724167, -0.018751326948404312, -0.018715571612119675, -0.018209183588624, -0.018681015819311142, -0.01920314133167267, -0.018939277157187462, -0.018735911697149277, -0.01980164460837841, -0.01603841781616211, -0.017157938331365585, -0.017810212448239326, -0.018131522461771965, -0.01798313856124878, -0.018259622156620026, -0.018876925110816956, -0.01990969106554985, -0.01978892832994461, -0.021098844707012177, -0.02060518227517605, -0.022347893565893173, -0.022703267633914948, -0.023609109222888947, -0.024381686002016068, -0.02492394484579563, -0.025477753952145576, -0.02527560107409954, -0.024101587012410164, -0.023844687268137932, -0.02355681173503399, -0.023083334788680077, -0.02283661998808384, -0.02338683418929577, -0.02349558286368847, -0.023209098726511, -0.02286265790462494, -0.022197848185896873, -0.02163996547460556, -0.021292831748723984, -0.02261211909353733, -0.02101164497435093, -0.020631559193134308, -0.01856132037937641, -0.01765223778784275, -0.016513103619217873, -0.016447002068161964, -0.01628981903195381, -0.01570121943950653, -0.01415086816996336, -0.01582285761833191, -0.013288467191159725, -0.012856487184762955, -0.011335819028317928, -0.01091051660478115, -0.010587184689939022, -0.010849294252693653, -0.010405768640339375, -0.010362365283071995, -0.00789570901542902, -0.00991731882095337, -0.007332559209316969, -0.005686108022928238, -0.0048232427798211575, -0.0037615725304931402, -0.003471862757578492, -0.0026930973399430513, -0.0024286529514938593, -0.0016774145187810063, -4.505384276853874e-05, -0.001543666236102581, -0.0017601847648620605, -0.0022442969493567944, -0.0014772050781175494, -0.0015792269259691238, -0.00025201684911735356, -0.0009920765878632665, -0.0016062541399151087, -0.0007777800783514977, 0.0003677684289868921, -0.000570255215279758, 0.00024714137543924153, 0.0011636288836598396, 0.0010244935983791947, 0.0001270368229597807, 0.000604068161919713, 0.0021420109551399946, 0.0014236054848879576, 0.0011692323023453355, 0.00275041488930583, 0.005161798093467951, 0.005480810068547726, 0.00592655036598444, 0.006358002312481403, 0.005726959090679884, 0.005378989037126303, 0.004839170258492231, 0.005118006840348244, 0.005447445437312126, 0.006366157438606024, 0.001980834174901247, 0.00183873123023659, 0.0014532507630065084, 0.0007286554318852723, 0.00021597374870907515, -2.4458648113068193e-05, 0.0009753581834957004, 0.0008005579584278166, 0.0025272464845329523, 0.0031256587244570255, 0.005196176469326019, 0.006424666382372379, 0.005775554105639458, 0.006829460617154837, 0.007693187333643436, 0.006358147598803043, 0.006479492876678705, 0.00692805415019393, 0.006753445137292147, 0.007613210938870907, 0.005032803397625685, 0.005688052158802748, 0.006535443011671305, 0.006624033208936453, 0.008400214836001396, 0.009355207905173302, 0.009613129310309887, 0.011237320490181446, 0.009346846491098404, 0.01124517060816288, 0.010579180903732777, 0.010556426830589771, 0.012121479026973248, 0.011636858806014061, 0.011094383895397186, 0.01205520797520876, 0.010739940218627453, 0.009594853967428207, 0.010713682509958744, 0.010801256634294987, 0.010962506756186485, 0.010422946885228157, 0.010225020349025726, 0.010370111092925072, 0.009200839325785637, 0.009136920794844627, 0.0089596938341856, 0.009641448967158794, 0.00938003696501255, 0.009691108018159866, 0.00961149949580431, 0.008282643742859364, 0.008662799373269081, 0.007270722649991512, 0.00831177830696106, 0.007972680032253265, 0.007339623291045427, 0.008409022353589535, 0.007947663776576519, 0.0077979383058846, 0.007307479158043861, 0.006875061895698309, 0.0071907867677509785, 0.007776959799230099, 0.006193197797983885, 0.005487312562763691, 0.006339213345199823, 0.005719078239053488, 0.006376967765390873, 0.005788948852568865, 0.005715221166610718, 0.006525717210024595, 0.005011256318539381, 0.005722982343286276, 0.005895217880606651, 0.005284103099256754, 0.006626146845519543, 0.007843964733183384, 0.0069703166373074055, 0.006161963101476431, 0.00542577775195241, 0.005735541693866253, 0.005541305523365736, 0.006097546778619289, 0.006073641125112772, 0.0071733249351382256, 0.007479059509932995, 0.007323808502405882, 0.006988035514950752, 0.006939868442714214, 0.007896916009485722, 0.008638798259198666, 0.009746004827320576, 0.010281410999596119, 0.010512176901102066, 0.009689201600849628, 0.010655038990080357, 0.010476501658558846, 0.011050085537135601, 0.011219275183975697, 0.010359066538512707, 0.01200855616480112, 0.012389171868562698, 0.011446846649050713, 0.012926190160214901, 0.01266974862664938, 0.013511817902326584, 0.013266746886074543, 0.013078606687486172, 0.013183512724936008, 0.009861528873443604, 0.008917841129004955, 0.009169630706310272, 0.010406725108623505, 0.009955459274351597, 0.01044569443911314, 0.010856722481548786, 0.01071958988904953, 0.009882957674562931, 0.009413342922925949, 0.010663451626896858, 0.011114411056041718, 0.01119849644601345, 0.010607533156871796, 0.010977728292346, 0.01182810589671135, 0.011496508494019508, 0.010587220080196857, 0.01189743634313345, 0.012640797533094883, 0.011654564179480076, 0.011568678542971611, 0.011912367306649685, 0.011960171163082123, 0.010986155830323696, 0.010767508298158646, 0.011205730959773064, 0.012225178070366383, 0.011183863505721092, 0.011848213151097298, 0.011606702581048012, 0.012402530759572983, 0.011824710294604301, 0.009876050055027008, 0.011726243421435356, 0.01233857125043869, 0.012220767326653004, 0.010643289424479008, 0.01189710944890976, 0.010529359802603722, 0.01194777525961399, 0.009988265112042427, 0.010220492258667946, 0.01031455211341381, 0.009570779278874397, 0.009685303084552288, 0.010024972259998322, 0.009264261461794376, 0.00803234614431858, 0.007288687396794558, 0.009431145153939724, 0.009501902386546135, 0.00982628669589758, 0.009016340598464012, 0.008645115420222282, 0.008879706263542175, 0.008824608288705349, 0.007126669865101576, 0.007356479298323393, 0.006289317272603512, 0.007193489465862513, 0.005706235766410828, 0.006180186755955219, 0.006313682068139315, 0.006218199152499437, 0.0064528705552220345, 0.005306615494191647, 0.005457395687699318, 0.005959842819720507, 0.004459088668227196, 0.0062119001522660255, 0.006299074273556471, 0.005819519050419331, 0.005176567938178778, 0.004847611766308546, 0.004506355617195368, 0.004866658244282007, 0.002975576091557741, 0.003364784875884652, 0.003400705521926284, 0.00013890094123780727, 0.0007230707560665905, -0.00018413543875794858, -0.00011608767817961052, -0.0010874909348785877, -0.0017135870875790715, -0.002863092115148902, -0.0036232073325663805, -0.0031466539949178696, -0.002618088386952877, 0.0041381292976439, 0.0036380295641720295, 0.0031171427108347416, 0.0019195040222257376, 0.001107041141949594, 0.00164750125259161, 0.0004867599345743656, 0.0008002176764421165, 0.001220502657815814, 0.0009487385395914316, -0.00210254592821002, -0.0027559881564229727, -0.0036519174464046955, -0.0036507879849523306, -0.003843448357656598, -0.004627823829650879, -0.004551883786916733, -0.004753193352371454, -0.005078861955553293, -0.00610671192407608, -0.005673480220139027, -0.004528907593339682, -0.004911666736006737, -0.004730292595922947, -0.005931482650339603, -0.006193880457431078, -0.006090567447245121, -0.0070765092968940735, -0.007176969666033983, -0.007913174107670784, -0.008424727246165276, -0.010865187272429466, -0.010131166316568851, -0.010938497260212898, -0.01146808359771967, -0.01142034400254488, -0.011297634802758694, -0.011346149258315563, -0.012102565728127956, -0.013030965812504292, -0.011503790505230427, -0.012406970374286175, -0.011403213255107403, -0.012323731556534767, -0.013149118982255459, -0.014181378297507763, -0.014448890462517738, -0.015352252870798111, -0.015571603551506996, -0.016780616715550423, -0.015690192580223083, -0.016552088782191277, -0.01736666075885296, -0.01769382879137993, -0.01735725626349449, -0.017920317128300667, -0.017253734171390533, -0.0163248423486948, -0.016494590789079666, -0.017573831602931023, -0.016615040600299835, -0.017567228525877, -0.017962532117962837, -0.018192574381828308, -0.01843193918466568, -0.01979793608188629, -0.020036200061440468, -0.0200231671333313, -0.020028386265039444, -0.021728573366999626, -0.020902952179312706, -0.02105819433927536, -0.020479094237089157, -0.021199867129325867, -0.022205138579010963, -0.02326226979494095, -0.022923661395907402, -0.023173091933131218, -0.023560520261526108, -0.024417448788881302, -0.024294057860970497, -0.02421514503657818, -0.02370951510965824, -0.02319299802184105, -0.023828186094760895, -0.023588193580508232, -0.023109203204512596, -0.023099370300769806, -0.023357946425676346, -0.023664237931370735, -0.027552530169487, -0.026019558310508728, -0.024922620505094528, -0.024286603555083275, -0.02379077859222889, -0.02262369729578495, -0.021445542573928833, -0.01942446269094944, -0.019150758162140846, -0.018180403858423233, -0.025676652789115906, -0.023673424497246742, -0.023328697308897972, -0.021962672472000122, -0.020205041393637657, -0.018987571820616722, -0.01898059993982315, -0.017112838104367256, -0.016709085553884506, -0.014821709133684635, -0.011957666836678982, -0.01019211858510971, -0.00901021808385849, -0.007893635891377926, -0.007279791869223118, -0.007095335517078638, -0.006431324407458305, -0.0062103671953082085, -0.0057987733744084835, -0.0046552084386348724, -0.0077891116961836815, -0.0069955820217728615, -0.007212618365883827, -0.005905958358198404, -0.005185654852539301, -0.0033884348813444376, -0.003226472996175289, -0.002303842920809984, -0.001491996576078236, -0.0006991484551690519, -0.0007022031350061297, -0.0007694755913689733, -0.0006896854029037058, -0.001470156479626894, -0.0016651946352794766, -0.0014873446198180318, -0.0011380875948816538, -0.0013757845154032111, -0.0009226267575286329, 0.0005481067346408963, 0.000435347348684445, 0.001691844779998064, 0.0019155163317918777, 0.0028150237631052732, 0.002632569521665573, 0.003249957924708724, 0.0029227337799966335, 0.003210729220882058, 0.0027222633361816406, 0.002431420376524329, 0.003800381673499942, 0.003474161960184574, 0.003770980751141906, 0.003013576613739133, 0.0032639862038195133, 0.0034575036261230707, 0.0034250991884618998, 0.0033341040834784508, 0.0044076633639633656, 0.00468908715993166, 0.005900997668504715, 0.0076968008652329445, 0.007611595559865236, 0.008121822960674763, 0.008779831230640411, 0.008175287395715714, 0.008393902331590652, 0.008425144478678703, 0.008204868994653225, 0.008497909642755985, 0.008753362111747265, 0.00890932697802782, 0.009991800412535667, 0.009746355935931206, 0.010742484591901302, 0.012580360285937786, 0.012377645820379257, 0.013737481087446213, 0.01407245360314846, 0.0159282349050045, 0.014138768427073956, 0.014496230520308018, 0.01390506699681282, 0.01446729525923729, 0.015287721529603004, 0.014178285375237465, 0.014851299114525318, 0.015403840690851212, 0.014484736137092113, 0.014596467837691307, 0.019781166687607765, 0.02024093084037304, 0.020206348970532417, 0.020310938358306885, 0.019174568355083466, 0.018667778000235558, 0.01843860186636448, 0.017361309379339218, 0.017073355615139008, 0.018248867243528366]))

    def test_3DImgBlank(self):
        return_new = fu.filt_table(IMAGE_BLANK_3D, self.table)
        return_old = oldfu.filt_table(IMAGE_BLANK_3D, self.table)
        self.assertTrue(array_equal(return_new.get_3dview(), return_old.get_3dview()))
        self.assertTrue(array_equal(return_old.get_3dview(), IMAGE_BLANK_3D.get_3dview()))



class Test_fit_tanh(unittest.TestCase):
    dres = ((0.0, 0.05, 0, 10, 0.15, 0.20), (0, 0.2, 0.4, 0.6, 0.8, 1.0), (8, 9, 5, 77, 98, 200))
    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.fit_tanh()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.fit_tanh()
        self.assertEqual(str(cm_new.exception), "fit_tanh() takes at least 1 argument (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_emptyList_returns_IndexError_list_index_out_of_range(self):
        with self.assertRaises(IndexError) as cm_new:
            fu.fit_tanh([])
        with self.assertRaises(IndexError) as cm_old:
            oldfu.fit_tanh([])
        self.assertEqual(str(cm_new.exception), "list index out of range")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_fit_tanh(self):
        return_new = fu.fit_tanh(self.dres, low=0.1)
        return_old = oldfu.fit_tanh(self.dres, low=0.1 )

        self.assertEqual(return_new[0] , return_old[0])
        self.assertEqual(return_new[1], return_old[1])
        self.assertEqual(return_new[0] , 0)
        self.assertEqual(return_new[1], 0.1)

    def test_tooHighLow_leads_TypeError(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.fit_tanh(self.dres, low=10)
        with self.assertRaises(TypeError) as cm_old:
            oldfu.fit_tanh(self.dres, low=10 )
        self.assertEqual(str(cm_new.exception), "'tuple' object does not support item assignment")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))


""" not in use
class Test_fit_tanh1(unittest.TestCase):
    dres = ((0.0, 0.05, 0, 10, 0.15, 0.20), (0, 0.2, 0.4, 0.6, 0.8, 1.0), (8, 9, 5, 77, 98, 200))
    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.fit_tanh1()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.fit_tanh1()
        self.assertEqual(str(cm_new.exception), "fit_tanh1() takes at least 1 argument (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_emptyList_returns_IndexError_list_index_out_of_range(self):
        with self.assertRaises(IndexError) as cm_new:
            fu.fit_tanh1([])
        with self.assertRaises(IndexError) as cm_old:
            oldfu.fit_tanh1([])
        self.assertEqual(str(cm_new.exception), "list index out of range")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    def test_fit_tanh1(self):
        return_new = fu.fit_tanh1(self.dres, low=0.1)
        return_old = oldfu.fit_tanh1(self.dres, low=0.1 )

        self.assertEqual(return_new[0] , return_old[0])
        self.assertEqual(return_new[1], return_old[1])
        self.assertEqual(return_new[0] , 0)
        self.assertEqual(return_new[1], 0.1)

    def test_tooHighLow_leads_TypeError(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.fit_tanh1(self.dres, low=10)
        with self.assertRaises(TypeError) as cm_old:
            oldfu.fit_tanh(self.dres, low=10 )
        self.assertEqual(str(cm_new.exception), "'tuple' object does not support item assignment")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))
"""


class Test_filt_vols(unittest.TestCase):
    dres = ((0.0, 0.05, 0, 10, 0.15, 0.20), (0, 0.2, 0.4, 0.6, 0.8, 1.0), (8, 9, 5, 77, 98, 200))
    vols = [IMAGE_3D,IMAGE_3D,IMAGE_3D]
    fscs = (dres, dres, dres)

    def test_all_the_conditions(self,return_new=None,return_old=None, skip=True):
        if skip is False:
            self.assertEqual(len(return_old), len(return_new))
            for img1, img2 in zip(return_old, return_new):
                self.assertTrue(allclose(img1.get_3dview().flatten(), img2.get_3dview().flatten(), equal_nan=True))

    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filt_vols()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filt_vols()
        self.assertEqual(str(cm_new.exception), "filt_vols() takes exactly 3 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    @unittest.skip("cannot perform the unittest. the output change every_time. The compatibility tests are ok")
    def test_with_circularMASK(self):
        res=[[-0.0, -0.0, -0.3827972114086151, -0.0, -0.0, -0.0, -0.3827972114086151, -0.3827972114086151, -0.3827972114086151, -0.0, -0.3827972114086151, -0.3827972114086151, -0.3827972114086151, -0.3827972114086151, -0.3827972114086151, -0.0, -0.3827972114086151, -0.3827972114086151, -0.3827972114086151, -0.0, -0.0, -0.0, -0.3827972114086151, -0.0, -0.0, -0.0, -0.0, -0.0, -1.1394837982733497e+29, -7.381800186484134e+30, -1.7094962134516292e+30, -4.309791360718264e+23, -1.7869327837709185e+24, -7.080393967603076e+19, -1.6989700691866374e+27, -6.914348513814869e+27, -2.8921675454786304e+28, -2.7835296972127667e+31, -7.729257715521892e-20, -1.739803983749368e+30, -6.451596743292492e+21, -3.1139901986458518e+32, -2.7728370171744365e+22, -2.5777557180155355e+22, -4.542222221073664e+26, -7.241153643624261e+22, -2.7502406564040678e+22, -2.98140279713326e+34, -1.5959489562086062e+34, -0.0, -0.0, -0.0, -0.0, -0.0, -9911091.0, -0.0, float('NaN'), float('NaN'), 1.379271989532924e+24, -0.0, -0.0, -0.0, 1.7892107824820692e+35, -0.0, -0.0, -0.0, 1.894770226737543e+35, -0.0, 1.3718320429485078e+24, -0.0, 2.373217556370319e+33, -0.0, 1.364223337478855e+24, -0.0, 1.4700564875701808e+24, -0.0, 1.3564108531332628e+24, -0.0, 4.7698474222243284e+29, -0.0, 7.397525893545681e+30, -0.0, 1.3564153207040931e+24, -0.0, 1.4586961803612736e+32, -0.0, 9.449937149607567e+31, -0.0, 2.428947760028888e+33, -0.0, 1.3718373752104666e+24, -0.0, 1.3640538580176777e+24, -0.0, 1.3718425633572374e+24, -0.0, 2.1053022326346663e+35, -0.0, 3.301115510398824e+29, -0.0, 2.3525942490283492e+33, -0.0, 2.3528311598033674e+33, -0.0, 1.3718478956191962e+24, -0.0, 1.9402263946280708e+35, -0.0, 1.3597234848463744e+24, -0.0, 1.371853227881155e+24, -0.0, 2.3731833582767338e+33, -0.0, 2.1395587074721776e+35, -0.0, 1.1634135403993247e+29, -0.0, 1.3718585601431138e+24, -0.0, 1.3696412038593787e+24, -0.0, 1.3729882791024404e+24, -0.0, 3.459957180532355e+30, -0.0, 3.4755913114630663e+30, -0.0, 3.475780206122381e+30, -0.0, 3.463718450988631e+30, -0.0, 3.478171763625034e+30, -0.0, 3.4781847595775946e+30, -0.0, 3.492506601531114e+30, -0.0, 1.3686525736691783e+24, -0.0, 3.2197962084480815e+30, -0.0, 3.21970735240034e+30, -0.0, 2.2385321559761482e+31, -0.0, 1.3642551869354197e+24, -0.0, 2.1046178993809493e+35, -0.0, 2.0241969568800327e+35, -0.0, 3.492998936571152e+30, -0.0, 3.493024928476274e+30, -0.0, 3.48393985094187e+30, -0.0, 1.3506390398508248e+24, -0.0, 1.369647400812466e+24, -0.0, 1.358784430280872e+24, -0.0, 1.3597729163558844e+24, -0.0, 1.364345258927967e+24, -0.0, 3.4927659161194216e+30, -0.0, 1.3640433376089482e+24, -0.0, 1.364048669870907e+24, -0.0, 2.1180763873472474e+35, -0.0, 1.3718637482898845e+24, -0.0, 1.3643187417333611e+24, -0.0, 1.3643292621420907e+24, -0.0, 1.36432407399532e+24, -0.0, 1.3643345944040495e+24, -0.0, 2.352736457390362e+33, -0.0, 3.2109813258343614e+30, -0.0, 2.3731720620738753e+33, -0.0, 2.3575984668946554e+33, -0.0, 1.3554990363383068e+24, -0.0, 1.3696535977655532e+24, -0.0, 1.3696597947186404e+24, -0.0, 8.237740460295389e+31, -0.0, 3.476024409137943e+30, -0.0, 1.3597296817994617e+24, -0.0, 2.0739015369149816e+35, -0.0, 3.47187809580812e+30, -0.0, 3.502061951209348e+30, -0.0, 2.0903199890328126e+35, -0.0, 1.3684408684578949e+24, -0.0, 1.4794225848971402e+32, -0.0, 1.3684725737992715e+24, -0.0, 1.3684779060612303e+24, -0.0, 1.3588002829515605e+24, -0.0, 3.314846187626552e+30, -0.0, 1.3718690805518433e+24, -0.0, 1.357953750336803e+24, -0.0, 6.0500354143384625e+32, -0.0, 1.3730518339003819e+24, -0.0, 3.467650179985473e+30, -0.0, 1.3685149436645658e+24, -0.0, 1.4366540505974656e+34, -0.0, 2.104605817086166e+35, -0.0, 1.371874412813802e+24, -0.0, 1.371879745075761e+24, -0.0, 3.495201901645945e+30, -0.0, 3.4930769122865174e+30, -0.0, 4.9416859365015085e+31, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -9782288.0, -0.0, float('NaN'), float('NaN'), 1.4274208738690673e+24, -0.0, -0.0, -0.0, 1.7892107824820692e+35, -0.0, -0.0, -0.0, 3.4599051967221116e+30, -0.0, 3.4755913114630663e+30, -0.0, 3.475780206122381e+30, -0.0, 3.463718450988631e+30, -0.0, 3.493141589817867e+30, -0.0, 3.4931545857704277e+30, -0.0, 2.3515195623317446e+33, -0.0, 1.3642551869354197e+24, -0.0, 1.3642605191973785e+24, -0.0, 1.3642657073441492e+24, -0.0, 1.3544990210482485e+24, -0.0, 1.3506390398508248e+24, -0.0, 1.3506443721127836e+24, -0.0, 1.359735878752549e+24, -0.0, 1.3545052180013357e+24, -0.0, 1.3597420757056362e+24, -0.0, 3.4599181926746725e+30, -0.0, 3.467494833017652e+30, -0.0, 6.587405842579132e+31, -0.0, 1.404105054051027e+24, -0.0, 3.492998936571152e+30, -0.0, 3.493024928476274e+30, -0.0, 3.48393985094187e+30, -0.0, 3.46751689591386e+30, -0.0, 3.459957180532355e+30, -0.0, 2.1046178993809493e+35, -0.0, 2.1351524332139468e+35, -0.0, 2.139624070706252e+35, -0.0, 2.073530154903196e+35, -0.0, 9.201386836798078e+31, -0.0, 2.0806319693205683e+35, -0.0, 2.1045149027696807e+35, -0.0, 2.1351597618189793e+35, -0.0, 2.1044723176323293e+35, -0.0, 3.4675725065015625e+30, -0.0, 2.1044057659758173e+35, -0.0, 1.3597729163558844e+24, -0.0, 1.8269475771872267e+33, -0.0, 1.3597791133089717e+24, -0.0, 2.0241969568800327e+35, -0.0, 2.1353200007776644e+35, -0.0, 2.135196206773736e+35, -0.0, 3.4927399242143e+30, -0.0, 2.238523209925083e+31, -0.0, 2.2385321559761482e+31, -0.0, 5.046360053237349e+31, -0.0, 2.135137974074288e+35, -0.0, 1.364271039606108e+24, -0.0, 1.3642763718680668e+24, -0.0, 2.1350650841647748e+35, -0.0, 3.4673836118422477e+30, -0.0, 3.467561323937731e+30, -0.0, 3.483773321410218e+30, -0.0, 3.4837842017425947e+30, -0.0, 3.613795009299692e+26, -0.0, 3.6213375140165506e+26, -0.0, 1.3643080772094435e+24, -0.0, 3.614106759274538e+26, -0.0, 2.1352471108681513e+35, -0.0, 8.858818846567487e+31, -0.0, 2.0905867898700794e+35, -0.0, 1.433178410143168e+34, -0.0, 9.620285436138481e+31, -0.0, 3.4773814283704607e+30, -0.0, 1.359785310262059e+24, -0.0, 3.4675280784776917e+30, -0.0, 2.1053675958687405e+35, -0.0, 3.613944058991808e+26, -0.0, 3.495223964542153e+30, -0.0, 3.613822310480921e+26, -0.0, 3.475635739486937e+30, -0.0, 2.105076630441907e+35, -0.0, 3.6139034761548456e+26, -0.0, 3.6238186010944645e+26, -0.0, 2.1044542932253573e+35, -0.0, 2.13522532312346e+35, -0.0, 2.1053604653341142e+35, -0.0, 6.0418278718780004e+32, -0.0, -0.0, -0.0, -0.0, -0.0, 1.7886672772872214e+35, -0.0, -0.0, -0.0, float('NaN'), float('NaN'), -0.0, -3.615570845646327e+21, -0.0, -0.0, -9.478319321609175e+26, -2.846098389760625e-37, -1.6030668059180152e-38, -0.0, -9.478589381942414e+26, -1.1384394455873518e-36, -0.0, -9.479187056450402e+26, -1.8215033999256884e-35, -1.7718078038756953e-38, -0.0, -0.0, -1.017816949332849e+36, -1.0259456263151018e-36, -4.7089895384779624e+36, -7.087124716819493e-38, -0.0, -1.0177888233351565e+36, -1.7717803384257945e-38, -0.0, -0.0, -2.533710787043159e-24, -3.615581260220465e+21, -4.321557093557763e+21, -1.7717813193347196e-38, -0.0, -0.0, -2.5340200205180056e-24, -3.615581260220465e+21, -2.7657976207408788e+23, -1.842090769132985e-38, -0.0, -1.017944189761847e+36, -6.738843938269018e-35, -0.0, -0.0, -1.0177577658954509e+36, -1.075781584900792e-30, -7.260024728261893e-35, -0.0, -0.0, -4.071034549620954e+36, -4.644618789098792e-33, -0.0, -2.5343292539928523e-24, -0.0, 1.4406433378789893e-37, -1.0256000863337628e+36, -4.5357594600320683e-36, -0.0, -1.0133915447748096e-23, -3.6162432893656886e+21, -6.885008763749252e-29, -0.0, -1.0178819956542732e+36, -4.303127844235937e-30, -0.0, -9.438835397387044e-33, -1.013453391469779e-23, -4.071406921984771e+36, -2.810731659502124e-34, -0.0, -3.61646396574743e+21, -1.7988670865870085e-32, -0.0, -1.0180373620809637e+36, -7.431389474810892e-32, -0.0, -1.1667714480552169e-33, -0.0, -3.6167949803200415e+21, -0.00022341942531056702, -1.017944189761847e+36, -7.257214562079458e-35, -0.0, -4.070910319862132e+36, -2.972556495220967e-31, -0.0, -2.474636052227909e-27, -0.0, -1.4812569470492107e+25, -4.644618421756807e-33, -0.0, -2.5343292539928523e-24, 1.4404263047728346e-37, -7.460876162854093e-32, -0.0, -1.01797516797339e+36, -1.0757823372171765e-30, -1.2092352006374872e+36, -4.303129348868706e-30, -1.185384037681543e+36, -7.257214562079458e-35, -0.0, -3.617115580318515e+21, -1.1789390787592293e-36, -0.0, -1.7723321697610456e-38, -0.0, -5.822179765282233e+36, -2.972556495220967e-31, -0.0, 1.4407312273186717e-37, -1.0256000863337628e+36, -6.900576192787475e-32, -0.0, -3.615581260220465e+21, -4.4252770578765345e+24, -1.7717806186854874e-38, -0.0, -0.0, -0.0, -7.306043698918074e-07, -3.617115580318515e+21, 2.0473943625439205e-37, -1.193740186056655e-30, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, 1.7886672772872214e+35, -0.0, -0.0, -0.0, float('NaN'), float('NaN'), -0.0, -5.19193837830002e-20, -5.19193837830002e-20, -1.0683390397172315e+23, -7.381294855491535e+30, -1607581696000.0, -4.875887139112493e-15, -1.0700028467488175e+20, -4.347809907439587e+29, -5.022974833919676e-15, -1.185940561363329e+32, -2.6469921946576524e+28, -3.152504246776629e+23, -1.99158272096156e-08, -2.6377008808556505e+22, -1.472318100770309e-11, -2.734685467322877e+31, -5.065805478414063e-15, -1.7258240525991936e+16, -6.209942426949056e-08, -6.281663900153944e-08, -1.6901394701562822e-05, -1.632978907650795e-08, -1.001961100893789e-12, -1.533403092002228e-11, -1.6354506442439742e-05, -1.6151886939042015e-08, -6.724337436025962e-05, -2.5699304728732386e-07, -2.410962263166283e-10, -1.0107924026669934e-06, -1.6263955330941826e-05, -4.111622274649562e-06, -1.6505966371482828e-08, -3.4852789057571165e-12, -2.509207286394144e-10, -4.157163857598789e-06, -2.598227979433432e-07, -1.014889061679014e-09, -9.803928502361003e-13, -1.533403092002228e-11, -3.971126538715453e-09, -4.126402775028737e-09, -9.814451473744157e-10, -6.424406251426262e-08, -2.410962263166283e-10, -4.202795935270842e-06, -1.0278610034220037e-06, -1.6174108168343082e-05, -4.020800133730518e-06, -3.485276520512337e-12, -4.088268724444788e-06, -6.567430688164677e-08, -1.6718864571885206e-05, -6.567427135450998e-08, -5.583823271432686e-20, -1.552485606737264e-08, -2.5236782108528644e-10, -2.579219615661543e-10, -6.687825953122228e-05, -2.6410648956698424e-07, -2.410962263166283e-10, -1.027882490234333e-06, -6.389313256249807e-08, -4.059906189013418e-09, -2.584246203696239e-07, -3.485278255235813e-12, -1.022067181111197e-06, -1.0316224541284669e-09, -1.0206123723932592e-09, -4.037798095879452e-09, -3.485276954193206e-12, -3.992449926215613e-09, -4.104469653043452e-09, -6.541515176650137e-05, -1.0393805496278219e-06, -5.5838258563721e-20, -1.552485606737264e-08, -1.014911155117204e-09, -1.0107484058607952e-06, -6.28222593945793e-08, -9.965853012619541e-13, -1.533403092002228e-11, -1.0037919384586758e-09, -2.570041885974206e-07, -1.6237876820923702e-08, -6.459503509859132e-08, -3.4852776047145095e-12, -9.981124815539033e-10, -3.970954232102031e-09, -2.5554484750500706e-07, -2.565020973399612e-10, -5.583699840575657e-20, -1.552485606737264e-08, -4.111976522835903e-06, -1.0149548979043743e-09, -2.565184176184232e-10, -9.693859213608103e-13, -1.533403092002228e-11, -2.5410196258235374e-07, -6.541800394188613e-05, -3.970952455745191e-09, -4.015168197923913e-09, -2.410962263166283e-10, -1.6505950384271273e-08, -1.0260959859564878e-09, -4.03745081811735e-09, -6.579305772902444e-05, -3.485276954193206e-12, -1.6261808923445642e-05, -1.653631989029236e-05, -2.513001504667045e-07, -1.579260100470492e-08, -3.485276520512337e-12, -4.0654522308614105e-06, -1.0335426168239792e-06, -2.5793286950737127e-10, -4.104034001528589e-09, -3.4852784720762475e-12, -6.504723569378257e-05, -4.0819259083946235e-09, -2.4955004729321217e-10, -3.9930623252359965e-09, -9.912088511088157e-13, -1.533403092002228e-11, -1.0564925787548418e-06, -4.042904947709758e-06, -1.6811911336844787e-05, -4.082275850691985e-09, -2.410962263166283e-10, -6.566729382484482e-08, -9.815105395105661e-10, -6.469360960181803e-05, -1.5884161541634967e-08, -3.485276520512337e-12, -4.0654522308614105e-06, -1.597120125040874e-08, -1.0038569975279188e-09, -2.598284538635198e-07, -5.583190607511054e-20, -3.88121401684316e-09, -1.5705211353633786e-08, -6.352965442601999e-08, -6.389038276211068e-08, -6.566871491031634e-08, -2.410962263166283e-10, -1.033564331009984e-06, -2.481519156827261e-10, -1.050744117492286e-06, -2.5790553026538987e-10, -3.485277821554944e-12, -6.352269110720954e-08, -6.496408389011776e-08, -6.353248949153567e-08, -4.203244316158816e-06, -9.965213333337775e-13, -1.533403092002228e-11, -1.6537747796974145e-05, -4.037885137364583e-09, -2.5792185054385186e-10, -1.626359335205052e-05, -3.485277821554944e-12, -6.352269110720954e-08, -4.088893547304906e-06, -1.6262534700217657e-05, -1.5703815137158017e-08, -9.856839736782641e-13, -1.533403092002228e-11, -6.688111898256466e-05, -1.0221564252788085e-06, -4.22605899075279e-06, -4.015427990111675e-09, -2.410962263166283e-10, -4.059642400022767e-09, -4.134528353461064e-06, -2.5097518507877226e-10, -3.948408711096363e-09, -5.583827795076661e-20, -3.88121401684316e-09, -6.578738248208538e-05, -1.5705900580087473e-08, -2.569987032075005e-07, -9.694493471879007e-13, -1.533403092002228e-11, -1.0149979745577298e-09, -1.0204377343114857e-09, -2.523352637950893e-10, -1.02797196177562e-06, -3.485278255235813e-12, -1.0163630577153526e-06, -1.039358039633953e-06, -6.432711234083399e-05, -3.993235520027838e-09, -9.802869236838485e-13, -1.533403092002228e-11, -1.0222455557595822e-06, -1.0050667924588197e-06, -4.126316621722026e-09, -2.5843030471150996e-07, -2.410962263166283e-10, -1.0149106000056918e-09, -1.0051111303255311e-06, -9.871897743707336e-10, -3.970429318655988e-09, -3.4852784720762475e-12, -2.5409076442883816e-07, -1.6418926662709055e-08, -1.014954342792862e-09, -2.4814650334548105e-10, -5.583699840575657e-20, -3.88121401684316e-09, -1.6263955330941826e-05, -2.583967955160915e-07, -1.623788747906474e-08, -9.96521550174212e-13, -1.533403092002228e-11, -2.56992990443905e-07, -3.993147590364288e-09, -1.0050442824649508e-06, -1.0393360980742727e-06, -2.410962263166283e-10, -6.566729382484482e-08, -4.037189693661958e-09, -2.569596233570337e-07, -4.020266260340577e-06, -2.410962263166283e-10, -2.626691752993793e-07, -1.0222903483736445e-06, -1.0094710622965408e-09, -1.6263948054984212e-05, -5.583447162747916e-20, -1.552485606737264e-08, -1.6062408292327746e-08, -1.5972243971873468e-08, -1.0164300192627707e-06, -6.53094360814066e-08, -2.410962263166283e-10, -6.760837277397513e-05, -1.6536681869183667e-05, -2.509644159154334e-10, -2.4954446842251343e-10, -3.485276520512337e-12, -2.4952812038847583e-10, -4.134437858738238e-06, -4.104816042627135e-09, -4.059905744924208e-09, -5.583949933463983e-20, -1.552485606737264e-08, -1.6418219672686973e-08, -4.1576108742447104e-06, -2.512498440410127e-07, -1.6419273052292738e-08, -2.410962263166283e-10, -1.5882410053791318e-08, -6.602106594755242e-08, -1.0317315890517875e-09, -6.541518087033182e-05, -5.583823271432686e-20, -1.552485606737264e-08, -4.082360671731067e-09, -2.6411763087708096e-07, -1.0335201068301103e-06, -9.858121263750519e-13, -1.533403092002228e-11, -1.0205032374699385e-09, -1.6082491129054688e-05, -1.6539179341634735e-05, -6.602663660260077e-08, -2.410962263166283e-10, -1.6149790837971523e-08, -4.126575969820578e-09, -2.5699853267724393e-07, -6.46061835141154e-08, -3.485276520512337e-12, -1.022067181111197e-06, -1.6418919557281697e-08, -2.565401224785546e-10, -6.506154750240967e-05, -5.583193192450468e-20, -1.552485606737264e-08, -4.1568978303985205e-06, -2.5839122486104316e-07, -9.815752655129018e-10, -1.007507987628442e-12, -1.533403092002228e-11, -4.0664335756446235e-06, -1.0165643971049576e-06, -1.045017370415735e-06, -4.156986960879294e-06, -2.410962263166283e-10, -1.632804469409166e-08, -2.551422406682491e-10, -2.4678098453634334e-10, -4.203156095172744e-06, -2.410962263166283e-10, -6.566868648860691e-08, -1.0506769285711925e-06, -1.0451294656377286e-06, -2.4958804467622997e-10, -3.485276954193206e-12, -2.509207286394144e-10, -2.5791097035821053e-10, -2.641344281073543e-07, -1.6538107956876047e-05, -9.966705195527115e-13, -1.533403092002228e-11, -1.5703468747574334e-08, -4.202709078526823e-06, -4.014993226775232e-09, -4.043618446303299e-06, -3.485277821554944e-12, -1.0036829145576576e-09, -4.015254795319834e-09, -2.641010325987736e-07, -1.6813326510600746e-05, -5.583317269542351e-20, -6.209942426949056e-08, -6.423849896464162e-08, -1.597119769769506e-08, -6.389314677335278e-08, -9.747621546735141e-13, -1.533403092002228e-11, -2.583967955160915e-07, -4.1568978303985205e-06, -1.0107262369274395e-06, -1.5971901135003463e-08, -3.485278255235813e-12, -6.423570653169008e-08, -6.530804341764451e-08, -6.724047125317156e-05, -2.598116850549559e-07, -5.583569947370092e-20, -6.209942426949056e-08, -4.104816486716345e-09, -1.0164528703171527e-06, -1.6239971145637355e-08, -9.96606226363883e-13, -1.533403092002228e-11, -3.970952899834401e-09, -4.0200879993790295e-06, -1.0279943580826512e-06, -9.965431257974444e-13, -1.533403092002228e-11, -6.282083830910778e-08, -2.6123217367057805e-07, -1.6445768778794445e-05, -2.509643881598578e-10, -3.4852776047145095e-12, -1.0277713045070414e-06, -4.180517862550914e-06, -1.6082842194009572e-05, -6.76069685141556e-05, -9.967124781767867e-13, -1.533403092002228e-11, -4.066344899911201e-06, -3.970865858349271e-09, -6.45978204261155e-08, -2.6126565444428707e-07, -3.485277821554944e-12, -1.644434087211266e-05, -1.6173402400454506e-05, -6.531083585059605e-08, -2.53744109057763e-10, -5.583570593604945e-20, -6.209942426949056e-08, -6.542089977301657e-05, -6.761411350453272e-05, -2.523405928656075e-10, -4.066346718900604e-06, -2.410962263166283e-10, -2.62680316609476e-07, -9.815102064436587e-10, -1.5882774206943395e-08, -1.6447911548311822e-05, -2.410962263166283e-10, -2.641063474584371e-07, -2.551420741347954e-10, -6.688828580081463e-05, -1.0392245712864678e-06, -3.4852771710336405e-12, -2.5231333689035296e-10, -2.641009189119359e-07, -2.453993952489242e-10, -1.650596281876915e-08, -3.4852784720762475e-12, -6.577736348845065e-05, -3.94814980708702e-09, -1.003878868921504e-09, -4.127099550998992e-09, -5.584203257526578e-20, -2.483976970779622e-07, -1.6150492498923086e-08, -6.318151690720697e-08, -2.537495491505837e-10, -3.4852776047145095e-12, -4.037013390245647e-09, -2.583856542059948e-07, -1.5705900580087473e-08, -2.5699853267724393e-07, -5.584203257526578e-20, -2.483976970779622e-07, -4.06016598120118e-09, -1.05638139302755e-06, -1.6418916004568018e-08, -9.857267996640773e-13, -1.533403092002228e-11, -2.481627958683674e-10, -1.0204813660763534e-09, -6.317734602134806e-08, -4.1045575827070024e-09, -2.410962263166283e-10, -6.5057203755714e-05, -1.0393135880804039e-06, -4.11135442845989e-06, -2.481627403572162e-10, -3.485278255235813e-12, -4.037013390245647e-09, -1.0093188507198647e-09, -1.056537030308391e-06, -2.6266383201800636e-07, -5.583318562012058e-20, -2.483976970779622e-07, -9.871892192592213e-10, -4.037796763611823e-09, -4.13407997257309e-06, -1.0074434775991792e-12, -1.533403092002228e-11, -1.6810479792184196e-05, -2.5128326797130285e-07, -4.1576104194973595e-06, -9.815319668149414e-10, -2.410962263166283e-10],[-0.0, -0.0, -0.3827972114086151, -0.0, -0.0, -0.0, -0.3827972114086151, -0.3827972114086151, -0.3827972114086151, -0.0, -0.3827972114086151, -0.3827972114086151, -0.3827972114086151, -0.3827972114086151, -0.3827972114086151, -0.0, -0.3827972114086151, -0.3827972114086151, -0.3827972114086151, -0.0, -0.0, -0.0, -0.3827972114086151, -0.0, -0.0, -0.0, -0.0, -0.0, -1.1394837982733497e+29, -7.381800186484134e+30, -1.7094962134516292e+30, -4.309791360718264e+23, -1.7869327837709185e+24, -7.080393967603076e+19, -1.6989700691866374e+27, -6.914348513814869e+27, -2.8921675454786304e+28, -2.7835296972127667e+31, -7.729257715521892e-20, -1.739803983749368e+30, -6.451596743292492e+21, -3.1139901986458518e+32, -2.7728370171744365e+22, -2.5777557180155355e+22, -4.542222221073664e+26, -7.241153643624261e+22, -2.7502406564040678e+22, -2.98140279713326e+34, -1.5959489562086062e+34, -0.0, -0.0, -0.0, -0.0, -0.0, -9911091.0, -0.0, float('NaN'), float('NaN'), 1.379271989532924e+24, -0.0, -0.0, -0.0, 1.7892107824820692e+35, -0.0, -0.0, -0.0, 1.894770226737543e+35, -0.0, 1.3718320429485078e+24, -0.0, 2.373217556370319e+33, -0.0, 1.364223337478855e+24, -0.0, 1.4700564875701808e+24, -0.0, 1.3564108531332628e+24, -0.0, 4.7698474222243284e+29, -0.0, 7.397525893545681e+30, -0.0, 1.3564153207040931e+24, -0.0, 1.4586961803612736e+32, -0.0, 9.449937149607567e+31, -0.0, 2.428947760028888e+33, -0.0, 1.3718373752104666e+24, -0.0, 1.3640538580176777e+24, -0.0, 1.3718425633572374e+24, -0.0, 2.1053022326346663e+35, -0.0, 3.301115510398824e+29, -0.0, 2.3525942490283492e+33, -0.0, 2.3528311598033674e+33, -0.0, 1.3718478956191962e+24, -0.0, 1.9402263946280708e+35, -0.0, 1.3597234848463744e+24, -0.0, 1.371853227881155e+24, -0.0, 2.3731833582767338e+33, -0.0, 2.1395587074721776e+35, -0.0, 1.1634135403993247e+29, -0.0, 1.3718585601431138e+24, -0.0, 1.3696412038593787e+24, -0.0, 1.3729882791024404e+24, -0.0, 3.459957180532355e+30, -0.0, 3.4755913114630663e+30, -0.0, 3.475780206122381e+30, -0.0, 3.463718450988631e+30, -0.0, 3.478171763625034e+30, -0.0, 3.4781847595775946e+30, -0.0, 3.492506601531114e+30, -0.0, 1.3686525736691783e+24, -0.0, 3.2197962084480815e+30, -0.0, 3.21970735240034e+30, -0.0, 2.2385321559761482e+31, -0.0, 1.3642551869354197e+24, -0.0, 2.1046178993809493e+35, -0.0, 2.0241969568800327e+35, -0.0, 3.492998936571152e+30, -0.0, 3.493024928476274e+30, -0.0, 3.48393985094187e+30, -0.0, 1.3506390398508248e+24, -0.0, 1.369647400812466e+24, -0.0, 1.358784430280872e+24, -0.0, 1.3597729163558844e+24, -0.0, 1.364345258927967e+24, -0.0, 3.4927659161194216e+30, -0.0, 1.3640433376089482e+24, -0.0, 1.364048669870907e+24, -0.0, 2.1180763873472474e+35, -0.0, 1.3718637482898845e+24, -0.0, 1.3643187417333611e+24, -0.0, 1.3643292621420907e+24, -0.0, 1.36432407399532e+24, -0.0, 1.3643345944040495e+24, -0.0, 2.352736457390362e+33, -0.0, 3.2109813258343614e+30, -0.0, 2.3731720620738753e+33, -0.0, 2.3575984668946554e+33, -0.0, 1.3554990363383068e+24, -0.0, 1.3696535977655532e+24, -0.0, 1.3696597947186404e+24, -0.0, 8.237740460295389e+31, -0.0, 3.476024409137943e+30, -0.0, 1.3597296817994617e+24, -0.0, 2.0739015369149816e+35, -0.0, 3.47187809580812e+30, -0.0, 3.502061951209348e+30, -0.0, 2.0903199890328126e+35, -0.0, 1.3684408684578949e+24, -0.0, 1.4794225848971402e+32, -0.0, 1.3684725737992715e+24, -0.0, 1.3684779060612303e+24, -0.0, 1.3588002829515605e+24, -0.0, 3.314846187626552e+30, -0.0, 1.3718690805518433e+24, -0.0, 1.357953750336803e+24, -0.0, 6.0500354143384625e+32, -0.0, 1.3730518339003819e+24, -0.0, 3.467650179985473e+30, -0.0, 1.3685149436645658e+24, -0.0, 1.4366540505974656e+34, -0.0, 2.104605817086166e+35, -0.0, 1.371874412813802e+24, -0.0, 1.371879745075761e+24, -0.0, 3.495201901645945e+30, -0.0, 3.4930769122865174e+30, -0.0, 4.9416859365015085e+31, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -9782288.0, -0.0, float('NaN'), float('NaN'), 1.4274208738690673e+24, -0.0, -0.0, -0.0, 1.7892107824820692e+35, -0.0, -0.0, -0.0, 3.4599051967221116e+30, -0.0, 3.4755913114630663e+30, -0.0, 3.475780206122381e+30, -0.0, 3.463718450988631e+30, -0.0, 3.493141589817867e+30, -0.0, 3.4931545857704277e+30, -0.0, 2.3515195623317446e+33, -0.0, 1.3642551869354197e+24, -0.0, 1.3642605191973785e+24, -0.0, 1.3642657073441492e+24, -0.0, 1.3544990210482485e+24, -0.0, 1.3506390398508248e+24, -0.0, 1.3506443721127836e+24, -0.0, 1.359735878752549e+24, -0.0, 1.3545052180013357e+24, -0.0, 1.3597420757056362e+24, -0.0, 3.4599181926746725e+30, -0.0, 3.467494833017652e+30, -0.0, 6.587405842579132e+31, -0.0, 1.404105054051027e+24, -0.0, 3.492998936571152e+30, -0.0, 3.493024928476274e+30, -0.0, 3.48393985094187e+30, -0.0, 3.46751689591386e+30, -0.0, 3.459957180532355e+30, -0.0, 2.1046178993809493e+35, -0.0, 2.1351524332139468e+35, -0.0, 2.139624070706252e+35, -0.0, 2.073530154903196e+35, -0.0, 9.201386836798078e+31, -0.0, 2.0806319693205683e+35, -0.0, 2.1045149027696807e+35, -0.0, 2.1351597618189793e+35, -0.0, 2.1044723176323293e+35, -0.0, 3.4675725065015625e+30, -0.0, 2.1044057659758173e+35, -0.0, 1.3597729163558844e+24, -0.0, 1.8269475771872267e+33, -0.0, 1.3597791133089717e+24, -0.0, 2.0241969568800327e+35, -0.0, 2.1353200007776644e+35, -0.0, 2.135196206773736e+35, -0.0, 3.4927399242143e+30, -0.0, 2.238523209925083e+31, -0.0, 2.2385321559761482e+31, -0.0, 5.046360053237349e+31, -0.0, 2.135137974074288e+35, -0.0, 1.364271039606108e+24, -0.0, 1.3642763718680668e+24, -0.0, 2.1350650841647748e+35, -0.0, 3.4673836118422477e+30, -0.0, 3.467561323937731e+30, -0.0, 3.483773321410218e+30, -0.0, 3.4837842017425947e+30, -0.0, 3.613795009299692e+26, -0.0, 3.6213375140165506e+26, -0.0, 1.3643080772094435e+24, -0.0, 3.614106759274538e+26, -0.0, 2.1352471108681513e+35, -0.0, 8.858818846567487e+31, -0.0, 2.0905867898700794e+35, -0.0, 1.433178410143168e+34, -0.0, 9.620285436138481e+31, -0.0, 3.4773814283704607e+30, -0.0, 1.359785310262059e+24, -0.0, 3.4675280784776917e+30, -0.0, 2.1053675958687405e+35, -0.0, 3.613944058991808e+26, -0.0, 3.495223964542153e+30, -0.0, 3.613822310480921e+26, -0.0, 3.475635739486937e+30, -0.0, 2.105076630441907e+35, -0.0, 3.6139034761548456e+26, -0.0, 3.6238186010944645e+26, -0.0, 2.1044542932253573e+35, -0.0, 2.13522532312346e+35, -0.0, 2.1053604653341142e+35, -0.0, 6.0418278718780004e+32, -0.0, -0.0, -0.0, -0.0, -0.0, 1.7886672772872214e+35, -0.0, -0.0, -0.0, float('NaN'), float('NaN'), -0.0, -3.615570845646327e+21, -0.0, -0.0, -9.478319321609175e+26, -2.846098389760625e-37, -1.6030668059180152e-38, -0.0, -9.478589381942414e+26, -1.1384394455873518e-36, -0.0, -9.479187056450402e+26, -1.8215033999256884e-35, -1.7718078038756953e-38, -0.0, -0.0, -1.017816949332849e+36, -1.0259456263151018e-36, -4.7089895384779624e+36, -7.087124716819493e-38, -0.0, -1.0177888233351565e+36, -1.7717803384257945e-38, -0.0, -0.0, -2.533710787043159e-24, -3.615581260220465e+21, -4.321557093557763e+21, -1.7717813193347196e-38, -0.0, -0.0, -2.5340200205180056e-24, -3.615581260220465e+21, -2.7657976207408788e+23, -1.842090769132985e-38, -0.0, -1.017944189761847e+36, -6.738843938269018e-35, -0.0, -0.0, -1.0177577658954509e+36, -1.075781584900792e-30, -7.260024728261893e-35, -0.0, -0.0, -4.071034549620954e+36, -4.644618789098792e-33, -0.0, -2.5343292539928523e-24, -0.0, 1.4406433378789893e-37, -1.0256000863337628e+36, -4.5357594600320683e-36, -0.0, -1.0133915447748096e-23, -3.6162432893656886e+21, -6.885008763749252e-29, -0.0, -1.0178819956542732e+36, -4.303127844235937e-30, -0.0, -9.438835397387044e-33, -1.013453391469779e-23, -4.071406921984771e+36, -2.810731659502124e-34, -0.0, -3.61646396574743e+21, -1.7988670865870085e-32, -0.0, -1.0180373620809637e+36, -7.431389474810892e-32, -0.0, -1.1667714480552169e-33, -0.0, -3.6167949803200415e+21, -0.00022341942531056702, -1.017944189761847e+36, -7.257214562079458e-35, -0.0, -4.070910319862132e+36, -2.972556495220967e-31, -0.0, -2.474636052227909e-27, -0.0, -1.4812569470492107e+25, -4.644618421756807e-33, -0.0, -2.5343292539928523e-24, 1.4404263047728346e-37, -7.460876162854093e-32, -0.0, -1.01797516797339e+36, -1.0757823372171765e-30, -1.2092352006374872e+36, -4.303129348868706e-30, -1.185384037681543e+36, -7.257214562079458e-35, -0.0, -3.617115580318515e+21, -1.1789390787592293e-36, -0.0, -1.7723321697610456e-38, -0.0, -5.822179765282233e+36, -2.972556495220967e-31, -0.0, 1.4407312273186717e-37, -1.0256000863337628e+36, -6.900576192787475e-32, -0.0, -3.615581260220465e+21, -4.4252770578765345e+24, -1.7717806186854874e-38, -0.0, -0.0, -0.0, -7.306043698918074e-07, -3.617115580318515e+21, 2.0473943625439205e-37, -1.193740186056655e-30, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, 1.7886672772872214e+35, -0.0, -0.0, -0.0, float('NaN'), float('NaN'), -0.0, -5.19193837830002e-20, -5.19193837830002e-20, -1.0683390397172315e+23, -7.381294855491535e+30, -1607581696000.0, -4.875887139112493e-15, -1.0700028467488175e+20, -4.347809907439587e+29, -5.022974833919676e-15, -1.185940561363329e+32, -2.6469921946576524e+28, -3.152504246776629e+23, -1.99158272096156e-08, -2.6377008808556505e+22, -1.472318100770309e-11, -2.734685467322877e+31, -5.065805478414063e-15, -1.7258240525991936e+16, -6.209942426949056e-08, -6.281663900153944e-08, -1.6901394701562822e-05, -1.632978907650795e-08, -1.001961100893789e-12, -1.533403092002228e-11, -1.6354506442439742e-05, -1.6151886939042015e-08, -6.724337436025962e-05, -2.5699304728732386e-07, -2.410962263166283e-10, -1.0107924026669934e-06, -1.6263955330941826e-05, -4.111622274649562e-06, -1.6505966371482828e-08, -3.4852789057571165e-12, -2.509207286394144e-10, -4.157163857598789e-06, -2.598227979433432e-07, -1.014889061679014e-09, -9.803928502361003e-13, -1.533403092002228e-11, -3.971126538715453e-09, -4.126402775028737e-09, -9.814451473744157e-10, -6.424406251426262e-08, -2.410962263166283e-10, -4.202795935270842e-06, -1.0278610034220037e-06, -1.6174108168343082e-05, -4.020800133730518e-06, -3.485276520512337e-12, -4.088268724444788e-06, -6.567430688164677e-08, -1.6718864571885206e-05, -6.567427135450998e-08, -5.583823271432686e-20, -1.552485606737264e-08, -2.5236782108528644e-10, -2.579219615661543e-10, -6.687825953122228e-05, -2.6410648956698424e-07, -2.410962263166283e-10, -1.027882490234333e-06, -6.389313256249807e-08, -4.059906189013418e-09, -2.584246203696239e-07, -3.485278255235813e-12, -1.022067181111197e-06, -1.0316224541284669e-09, -1.0206123723932592e-09, -4.037798095879452e-09, -3.485276954193206e-12, -3.992449926215613e-09, -4.104469653043452e-09, -6.541515176650137e-05, -1.0393805496278219e-06, -5.5838258563721e-20, -1.552485606737264e-08, -1.014911155117204e-09, -1.0107484058607952e-06, -6.28222593945793e-08, -9.965853012619541e-13, -1.533403092002228e-11, -1.0037919384586758e-09, -2.570041885974206e-07, -1.6237876820923702e-08, -6.459503509859132e-08, -3.4852776047145095e-12, -9.981124815539033e-10, -3.970954232102031e-09, -2.5554484750500706e-07, -2.565020973399612e-10, -5.583699840575657e-20, -1.552485606737264e-08, -4.111976522835903e-06, -1.0149548979043743e-09, -2.565184176184232e-10, -9.693859213608103e-13, -1.533403092002228e-11, -2.5410196258235374e-07, -6.541800394188613e-05, -3.970952455745191e-09, -4.015168197923913e-09, -2.410962263166283e-10, -1.6505950384271273e-08, -1.0260959859564878e-09, -4.03745081811735e-09, -6.579305772902444e-05, -3.485276954193206e-12, -1.6261808923445642e-05, -1.653631989029236e-05, -2.513001504667045e-07, -1.579260100470492e-08, -3.485276520512337e-12, -4.0654522308614105e-06, -1.0335426168239792e-06, -2.5793286950737127e-10, -4.104034001528589e-09, -3.4852784720762475e-12, -6.504723569378257e-05, -4.0819259083946235e-09, -2.4955004729321217e-10, -3.9930623252359965e-09, -9.912088511088157e-13, -1.533403092002228e-11, -1.0564925787548418e-06, -4.042904947709758e-06, -1.6811911336844787e-05, -4.082275850691985e-09, -2.410962263166283e-10, -6.566729382484482e-08, -9.815105395105661e-10, -6.469360960181803e-05, -1.5884161541634967e-08, -3.485276520512337e-12, -4.0654522308614105e-06, -1.597120125040874e-08, -1.0038569975279188e-09, -2.598284538635198e-07, -5.583190607511054e-20, -3.88121401684316e-09, -1.5705211353633786e-08, -6.352965442601999e-08, -6.389038276211068e-08, -6.566871491031634e-08, -2.410962263166283e-10, -1.033564331009984e-06, -2.481519156827261e-10, -1.050744117492286e-06, -2.5790553026538987e-10, -3.485277821554944e-12, -6.352269110720954e-08, -6.496408389011776e-08, -6.353248949153567e-08, -4.203244316158816e-06, -9.965213333337775e-13, -1.533403092002228e-11, -1.6537747796974145e-05, -4.037885137364583e-09, -2.5792185054385186e-10, -1.626359335205052e-05, -3.485277821554944e-12, -6.352269110720954e-08, -4.088893547304906e-06, -1.6262534700217657e-05, -1.5703815137158017e-08, -9.856839736782641e-13, -1.533403092002228e-11, -6.688111898256466e-05, -1.0221564252788085e-06, -4.22605899075279e-06, -4.015427990111675e-09, -2.410962263166283e-10, -4.059642400022767e-09, -4.134528353461064e-06, -2.5097518507877226e-10, -3.948408711096363e-09, -5.583827795076661e-20, -3.88121401684316e-09, -6.578738248208538e-05, -1.5705900580087473e-08, -2.569987032075005e-07, -9.694493471879007e-13, -1.533403092002228e-11, -1.0149979745577298e-09, -1.0204377343114857e-09, -2.523352637950893e-10, -1.02797196177562e-06, -3.485278255235813e-12, -1.0163630577153526e-06, -1.039358039633953e-06, -6.432711234083399e-05, -3.993235520027838e-09, -9.802869236838485e-13, -1.533403092002228e-11, -1.0222455557595822e-06, -1.0050667924588197e-06, -4.126316621722026e-09, -2.5843030471150996e-07, -2.410962263166283e-10, -1.0149106000056918e-09, -1.0051111303255311e-06, -9.871897743707336e-10, -3.970429318655988e-09, -3.4852784720762475e-12, -2.5409076442883816e-07, -1.6418926662709055e-08, -1.014954342792862e-09, -2.4814650334548105e-10, -5.583699840575657e-20, -3.88121401684316e-09, -1.6263955330941826e-05, -2.583967955160915e-07, -1.623788747906474e-08, -9.96521550174212e-13, -1.533403092002228e-11, -2.56992990443905e-07, -3.993147590364288e-09, -1.0050442824649508e-06, -1.0393360980742727e-06, -2.410962263166283e-10, -6.566729382484482e-08, -4.037189693661958e-09, -2.569596233570337e-07, -4.020266260340577e-06, -2.410962263166283e-10, -2.626691752993793e-07, -1.0222903483736445e-06, -1.0094710622965408e-09, -1.6263948054984212e-05, -5.583447162747916e-20, -1.552485606737264e-08, -1.6062408292327746e-08, -1.5972243971873468e-08, -1.0164300192627707e-06, -6.53094360814066e-08, -2.410962263166283e-10, -6.760837277397513e-05, -1.6536681869183667e-05, -2.509644159154334e-10, -2.4954446842251343e-10, -3.485276520512337e-12, -2.4952812038847583e-10, -4.134437858738238e-06, -4.104816042627135e-09, -4.059905744924208e-09, -5.583949933463983e-20, -1.552485606737264e-08, -1.6418219672686973e-08, -4.1576108742447104e-06, -2.512498440410127e-07, -1.6419273052292738e-08, -2.410962263166283e-10, -1.5882410053791318e-08, -6.602106594755242e-08, -1.0317315890517875e-09, -6.541518087033182e-05, -5.583823271432686e-20, -1.552485606737264e-08, -4.082360671731067e-09, -2.6411763087708096e-07, -1.0335201068301103e-06, -9.858121263750519e-13, -1.533403092002228e-11, -1.0205032374699385e-09, -1.6082491129054688e-05, -1.6539179341634735e-05, -6.602663660260077e-08, -2.410962263166283e-10, -1.6149790837971523e-08, -4.126575969820578e-09, -2.5699853267724393e-07, -6.46061835141154e-08, -3.485276520512337e-12, -1.022067181111197e-06, -1.6418919557281697e-08, -2.565401224785546e-10, -6.506154750240967e-05, -5.583193192450468e-20, -1.552485606737264e-08, -4.1568978303985205e-06, -2.5839122486104316e-07, -9.815752655129018e-10, -1.007507987628442e-12, -1.533403092002228e-11, -4.0664335756446235e-06, -1.0165643971049576e-06, -1.045017370415735e-06, -4.156986960879294e-06, -2.410962263166283e-10, -1.632804469409166e-08, -2.551422406682491e-10, -2.4678098453634334e-10, -4.203156095172744e-06, -2.410962263166283e-10, -6.566868648860691e-08, -1.0506769285711925e-06, -1.0451294656377286e-06, -2.4958804467622997e-10, -3.485276954193206e-12, -2.509207286394144e-10, -2.5791097035821053e-10, -2.641344281073543e-07, -1.6538107956876047e-05, -9.966705195527115e-13, -1.533403092002228e-11, -1.5703468747574334e-08, -4.202709078526823e-06, -4.014993226775232e-09, -4.043618446303299e-06, -3.485277821554944e-12, -1.0036829145576576e-09, -4.015254795319834e-09, -2.641010325987736e-07, -1.6813326510600746e-05, -5.583317269542351e-20, -6.209942426949056e-08, -6.423849896464162e-08, -1.597119769769506e-08, -6.389314677335278e-08, -9.747621546735141e-13, -1.533403092002228e-11, -2.583967955160915e-07, -4.1568978303985205e-06, -1.0107262369274395e-06, -1.5971901135003463e-08, -3.485278255235813e-12, -6.423570653169008e-08, -6.530804341764451e-08, -6.724047125317156e-05, -2.598116850549559e-07, -5.583569947370092e-20, -6.209942426949056e-08, -4.104816486716345e-09, -1.0164528703171527e-06, -1.6239971145637355e-08, -9.96606226363883e-13, -1.533403092002228e-11, -3.970952899834401e-09, -4.0200879993790295e-06, -1.0279943580826512e-06, -9.965431257974444e-13, -1.533403092002228e-11, -6.282083830910778e-08, -2.6123217367057805e-07, -1.6445768778794445e-05, -2.509643881598578e-10, -3.4852776047145095e-12, -1.0277713045070414e-06, -4.180517862550914e-06, -1.6082842194009572e-05, -6.76069685141556e-05, -9.967124781767867e-13, -1.533403092002228e-11, -4.066344899911201e-06, -3.970865858349271e-09, -6.45978204261155e-08, -2.6126565444428707e-07, -3.485277821554944e-12, -1.644434087211266e-05, -1.6173402400454506e-05, -6.531083585059605e-08, -2.53744109057763e-10, -5.583570593604945e-20, -6.209942426949056e-08, -6.542089977301657e-05, -6.761411350453272e-05, -2.523405928656075e-10, -4.066346718900604e-06, -2.410962263166283e-10, -2.62680316609476e-07, -9.815102064436587e-10, -1.5882774206943395e-08, -1.6447911548311822e-05, -2.410962263166283e-10, -2.641063474584371e-07, -2.551420741347954e-10, -6.688828580081463e-05, -1.0392245712864678e-06, -3.4852771710336405e-12, -2.5231333689035296e-10, -2.641009189119359e-07, -2.453993952489242e-10, -1.650596281876915e-08, -3.4852784720762475e-12, -6.577736348845065e-05, -3.94814980708702e-09, -1.003878868921504e-09, -4.127099550998992e-09, -5.584203257526578e-20, -2.483976970779622e-07, -1.6150492498923086e-08, -6.318151690720697e-08, -2.537495491505837e-10, -3.4852776047145095e-12, -4.037013390245647e-09, -2.583856542059948e-07, -1.5705900580087473e-08, -2.5699853267724393e-07, -5.584203257526578e-20, -2.483976970779622e-07, -4.06016598120118e-09, -1.05638139302755e-06, -1.6418916004568018e-08, -9.857267996640773e-13, -1.533403092002228e-11, -2.481627958683674e-10, -1.0204813660763534e-09, -6.317734602134806e-08, -4.1045575827070024e-09, -2.410962263166283e-10, -6.5057203755714e-05, -1.0393135880804039e-06, -4.11135442845989e-06, -2.481627403572162e-10, -3.485278255235813e-12, -4.037013390245647e-09, -1.0093188507198647e-09, -1.056537030308391e-06, -2.6266383201800636e-07, -5.583318562012058e-20, -2.483976970779622e-07, -9.871892192592213e-10, -4.037796763611823e-09, -4.13407997257309e-06, -1.0074434775991792e-12, -1.533403092002228e-11, -1.6810479792184196e-05, -2.5128326797130285e-07, -4.1576104194973595e-06, -9.815319668149414e-10, -2.410962263166283e-10],[-0.0, -0.0, -0.3827972114086151, -0.0, -0.0, -0.0, -0.3827972114086151, -0.3827972114086151, -0.3827972114086151, -0.0, -0.3827972114086151, -0.3827972114086151, -0.3827972114086151, -0.3827972114086151, -0.3827972114086151, -0.0, -0.3827972114086151, -0.3827972114086151, -0.3827972114086151, -0.0, -0.0, -0.0, -0.3827972114086151, -0.0, -0.0, -0.0, -0.0, -0.0, -1.1394837982733497e+29, -7.381800186484134e+30, -1.7094962134516292e+30, -4.309791360718264e+23, -1.7869327837709185e+24, -7.080393967603076e+19, -1.6989700691866374e+27, -6.914348513814869e+27, -2.8921675454786304e+28, -2.7835296972127667e+31, -7.729257715521892e-20, -1.739803983749368e+30, -6.451596743292492e+21, -3.1139901986458518e+32, -2.7728370171744365e+22, -2.5777557180155355e+22, -4.542222221073664e+26, -7.241153643624261e+22, -2.7502406564040678e+22, -2.98140279713326e+34, -1.5959489562086062e+34, -0.0, -0.0, -0.0, -0.0, -0.0, -9911091.0, -0.0, float('NaN'), float('NaN'), 1.379271989532924e+24, -0.0, -0.0, -0.0, 1.7892107824820692e+35, -0.0, -0.0, -0.0, 1.894770226737543e+35, -0.0, 1.3718320429485078e+24, -0.0, 2.373217556370319e+33, -0.0, 1.364223337478855e+24, -0.0, 1.4700564875701808e+24, -0.0, 1.3564108531332628e+24, -0.0, 4.7698474222243284e+29, -0.0, 7.397525893545681e+30, -0.0, 1.3564153207040931e+24, -0.0, 1.4586961803612736e+32, -0.0, 9.449937149607567e+31, -0.0, 2.428947760028888e+33, -0.0, 1.3718373752104666e+24, -0.0, 1.3640538580176777e+24, -0.0, 1.3718425633572374e+24, -0.0, 2.1053022326346663e+35, -0.0, 3.301115510398824e+29, -0.0, 2.3525942490283492e+33, -0.0, 2.3528311598033674e+33, -0.0, 1.3718478956191962e+24, -0.0, 1.9402263946280708e+35, -0.0, 1.3597234848463744e+24, -0.0, 1.371853227881155e+24, -0.0, 2.3731833582767338e+33, -0.0, 2.1395587074721776e+35, -0.0, 1.1634135403993247e+29, -0.0, 1.3718585601431138e+24, -0.0, 1.3696412038593787e+24, -0.0, 1.3729882791024404e+24, -0.0, 3.459957180532355e+30, -0.0, 3.4755913114630663e+30, -0.0, 3.475780206122381e+30, -0.0, 3.463718450988631e+30, -0.0, 3.478171763625034e+30, -0.0, 3.4781847595775946e+30, -0.0, 3.492506601531114e+30, -0.0, 1.3686525736691783e+24, -0.0, 3.2197962084480815e+30, -0.0, 3.21970735240034e+30, -0.0, 2.2385321559761482e+31, -0.0, 1.3642551869354197e+24, -0.0, 2.1046178993809493e+35, -0.0, 2.0241969568800327e+35, -0.0, 3.492998936571152e+30, -0.0, 3.493024928476274e+30, -0.0, 3.48393985094187e+30, -0.0, 1.3506390398508248e+24, -0.0, 1.369647400812466e+24, -0.0, 1.358784430280872e+24, -0.0, 1.3597729163558844e+24, -0.0, 1.364345258927967e+24, -0.0, 3.4927659161194216e+30, -0.0, 1.3640433376089482e+24, -0.0, 1.364048669870907e+24, -0.0, 2.1180763873472474e+35, -0.0, 1.3718637482898845e+24, -0.0, 1.3643187417333611e+24, -0.0, 1.3643292621420907e+24, -0.0, 1.36432407399532e+24, -0.0, 1.3643345944040495e+24, -0.0, 2.352736457390362e+33, -0.0, 3.2109813258343614e+30, -0.0, 2.3731720620738753e+33, -0.0, 2.3575984668946554e+33, -0.0, 1.3554990363383068e+24, -0.0, 1.3696535977655532e+24, -0.0, 1.3696597947186404e+24, -0.0, 8.237740460295389e+31, -0.0, 3.476024409137943e+30, -0.0, 1.3597296817994617e+24, -0.0, 2.0739015369149816e+35, -0.0, 3.47187809580812e+30, -0.0, 3.502061951209348e+30, -0.0, 2.0903199890328126e+35, -0.0, 1.3684408684578949e+24, -0.0, 1.4794225848971402e+32, -0.0, 1.3684725737992715e+24, -0.0, 1.3684779060612303e+24, -0.0, 1.3588002829515605e+24, -0.0, 3.314846187626552e+30, -0.0, 1.3718690805518433e+24, -0.0, 1.357953750336803e+24, -0.0, 6.0500354143384625e+32, -0.0, 1.3730518339003819e+24, -0.0, 3.467650179985473e+30, -0.0, 1.3685149436645658e+24, -0.0, 1.4366540505974656e+34, -0.0, 2.104605817086166e+35, -0.0, 1.371874412813802e+24, -0.0, 1.371879745075761e+24, -0.0, 3.495201901645945e+30, -0.0, 3.4930769122865174e+30, -0.0, 4.9416859365015085e+31, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -9782288.0, -0.0, float('NaN'), float('NaN'), 1.4274208738690673e+24, -0.0, -0.0, -0.0, 1.7892107824820692e+35, -0.0, -0.0, -0.0, 3.4599051967221116e+30, -0.0, 3.4755913114630663e+30, -0.0, 3.475780206122381e+30, -0.0, 3.463718450988631e+30, -0.0, 3.493141589817867e+30, -0.0, 3.4931545857704277e+30, -0.0, 2.3515195623317446e+33, -0.0, 1.3642551869354197e+24, -0.0, 1.3642605191973785e+24, -0.0, 1.3642657073441492e+24, -0.0, 1.3544990210482485e+24, -0.0, 1.3506390398508248e+24, -0.0, 1.3506443721127836e+24, -0.0, 1.359735878752549e+24, -0.0, 1.3545052180013357e+24, -0.0, 1.3597420757056362e+24, -0.0, 3.4599181926746725e+30, -0.0, 3.467494833017652e+30, -0.0, 6.587405842579132e+31, -0.0, 1.404105054051027e+24, -0.0, 3.492998936571152e+30, -0.0, 3.493024928476274e+30, -0.0, 3.48393985094187e+30, -0.0, 3.46751689591386e+30, -0.0, 3.459957180532355e+30, -0.0, 2.1046178993809493e+35, -0.0, 2.1351524332139468e+35, -0.0, 2.139624070706252e+35, -0.0, 2.073530154903196e+35, -0.0, 9.201386836798078e+31, -0.0, 2.0806319693205683e+35, -0.0, 2.1045149027696807e+35, -0.0, 2.1351597618189793e+35, -0.0, 2.1044723176323293e+35, -0.0, 3.4675725065015625e+30, -0.0, 2.1044057659758173e+35, -0.0, 1.3597729163558844e+24, -0.0, 1.8269475771872267e+33, -0.0, 1.3597791133089717e+24, -0.0, 2.0241969568800327e+35, -0.0, 2.1353200007776644e+35, -0.0, 2.135196206773736e+35, -0.0, 3.4927399242143e+30, -0.0, 2.238523209925083e+31, -0.0, 2.2385321559761482e+31, -0.0, 5.046360053237349e+31, -0.0, 2.135137974074288e+35, -0.0, 1.364271039606108e+24, -0.0, 1.3642763718680668e+24, -0.0, 2.1350650841647748e+35, -0.0, 3.4673836118422477e+30, -0.0, 3.467561323937731e+30, -0.0, 3.483773321410218e+30, -0.0, 3.4837842017425947e+30, -0.0, 3.613795009299692e+26, -0.0, 3.6213375140165506e+26, -0.0, 1.3643080772094435e+24, -0.0, 3.614106759274538e+26, -0.0, 2.1352471108681513e+35, -0.0, 8.858818846567487e+31, -0.0, 2.0905867898700794e+35, -0.0, 1.433178410143168e+34, -0.0, 9.620285436138481e+31, -0.0, 3.4773814283704607e+30, -0.0, 1.359785310262059e+24, -0.0, 3.4675280784776917e+30, -0.0, 2.1053675958687405e+35, -0.0, 3.613944058991808e+26, -0.0, 3.495223964542153e+30, -0.0, 3.613822310480921e+26, -0.0, 3.475635739486937e+30, -0.0, 2.105076630441907e+35, -0.0, 3.6139034761548456e+26, -0.0, 3.6238186010944645e+26, -0.0, 2.1044542932253573e+35, -0.0, 2.13522532312346e+35, -0.0, 2.1053604653341142e+35, -0.0, 6.0418278718780004e+32, -0.0, -0.0, -0.0, -0.0, -0.0, 1.7886672772872214e+35, -0.0, -0.0, -0.0, float('NaN'), float('NaN'), -0.0, -3.615570845646327e+21, -0.0, -0.0, -9.478319321609175e+26, -2.846098389760625e-37, -1.6030668059180152e-38, -0.0, -9.478589381942414e+26, -1.1384394455873518e-36, -0.0, -9.479187056450402e+26, -1.8215033999256884e-35, -1.7718078038756953e-38, -0.0, -0.0, -1.017816949332849e+36, -1.0259456263151018e-36, -4.7089895384779624e+36, -7.087124716819493e-38, -0.0, -1.0177888233351565e+36, -1.7717803384257945e-38, -0.0, -0.0, -2.533710787043159e-24, -3.615581260220465e+21, -4.321557093557763e+21, -1.7717813193347196e-38, -0.0, -0.0, -2.5340200205180056e-24, -3.615581260220465e+21, -2.7657976207408788e+23, -1.842090769132985e-38, -0.0, -1.017944189761847e+36, -6.738843938269018e-35, -0.0, -0.0, -1.0177577658954509e+36, -1.075781584900792e-30, -7.260024728261893e-35, -0.0, -0.0, -4.071034549620954e+36, -4.644618789098792e-33, -0.0, -2.5343292539928523e-24, -0.0, 1.4406433378789893e-37, -1.0256000863337628e+36, -4.5357594600320683e-36, -0.0, -1.0133915447748096e-23, -3.6162432893656886e+21, -6.885008763749252e-29, -0.0, -1.0178819956542732e+36, -4.303127844235937e-30, -0.0, -9.438835397387044e-33, -1.013453391469779e-23, -4.071406921984771e+36, -2.810731659502124e-34, -0.0, -3.61646396574743e+21, -1.7988670865870085e-32, -0.0, -1.0180373620809637e+36, -7.431389474810892e-32, -0.0, -1.1667714480552169e-33, -0.0, -3.6167949803200415e+21, -0.00022341942531056702, -1.017944189761847e+36, -7.257214562079458e-35, -0.0, -4.070910319862132e+36, -2.972556495220967e-31, -0.0, -2.474636052227909e-27, -0.0, -1.4812569470492107e+25, -4.644618421756807e-33, -0.0, -2.5343292539928523e-24, 1.4404263047728346e-37, -7.460876162854093e-32, -0.0, -1.01797516797339e+36, -1.0757823372171765e-30, -1.2092352006374872e+36, -4.303129348868706e-30, -1.185384037681543e+36, -7.257214562079458e-35, -0.0, -3.617115580318515e+21, -1.1789390787592293e-36, -0.0, -1.7723321697610456e-38, -0.0, -5.822179765282233e+36, -2.972556495220967e-31, -0.0, 1.4407312273186717e-37, -1.0256000863337628e+36, -6.900576192787475e-32, -0.0, -3.615581260220465e+21, -4.4252770578765345e+24, -1.7717806186854874e-38, -0.0, -0.0, -0.0, -7.306043698918074e-07, -3.617115580318515e+21, 2.0473943625439205e-37, -1.193740186056655e-30, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, 1.7886672772872214e+35, -0.0, -0.0, -0.0, float('NaN'), float('NaN'), -0.0, -5.19193837830002e-20, -5.19193837830002e-20, -1.0683390397172315e+23, -7.381294855491535e+30, -1607581696000.0, -4.875887139112493e-15, -1.0700028467488175e+20, -4.347809907439587e+29, -5.022974833919676e-15, -1.185940561363329e+32, -2.6469921946576524e+28, -3.152504246776629e+23, -1.99158272096156e-08, -2.6377008808556505e+22, -1.472318100770309e-11, -2.734685467322877e+31, -5.065805478414063e-15, -1.7258240525991936e+16, -6.209942426949056e-08, -6.281663900153944e-08, -1.6901394701562822e-05, -1.632978907650795e-08, -1.001961100893789e-12, -1.533403092002228e-11, -1.6354506442439742e-05, -1.6151886939042015e-08, -6.724337436025962e-05, -2.5699304728732386e-07, -2.410962263166283e-10, -1.0107924026669934e-06, -1.6263955330941826e-05, -4.111622274649562e-06, -1.6505966371482828e-08, -3.4852789057571165e-12, -2.509207286394144e-10, -4.157163857598789e-06, -2.598227979433432e-07, -1.014889061679014e-09, -9.803928502361003e-13, -1.533403092002228e-11, -3.971126538715453e-09, -4.126402775028737e-09, -9.814451473744157e-10, -6.424406251426262e-08, -2.410962263166283e-10, -4.202795935270842e-06, -1.0278610034220037e-06, -1.6174108168343082e-05, -4.020800133730518e-06, -3.485276520512337e-12, -4.088268724444788e-06, -6.567430688164677e-08, -1.6718864571885206e-05, -6.567427135450998e-08, -5.583823271432686e-20, -1.552485606737264e-08, -2.5236782108528644e-10, -2.579219615661543e-10, -6.687825953122228e-05, -2.6410648956698424e-07, -2.410962263166283e-10, -1.027882490234333e-06, -6.389313256249807e-08, -4.059906189013418e-09, -2.584246203696239e-07, -3.485278255235813e-12, -1.022067181111197e-06, -1.0316224541284669e-09, -1.0206123723932592e-09, -4.037798095879452e-09, -3.485276954193206e-12, -3.992449926215613e-09, -4.104469653043452e-09, -6.541515176650137e-05, -1.0393805496278219e-06, -5.5838258563721e-20, -1.552485606737264e-08, -1.014911155117204e-09, -1.0107484058607952e-06, -6.28222593945793e-08, -9.965853012619541e-13, -1.533403092002228e-11, -1.0037919384586758e-09, -2.570041885974206e-07, -1.6237876820923702e-08, -6.459503509859132e-08, -3.4852776047145095e-12, -9.981124815539033e-10, -3.970954232102031e-09, -2.5554484750500706e-07, -2.565020973399612e-10, -5.583699840575657e-20, -1.552485606737264e-08, -4.111976522835903e-06, -1.0149548979043743e-09, -2.565184176184232e-10, -9.693859213608103e-13, -1.533403092002228e-11, -2.5410196258235374e-07, -6.541800394188613e-05, -3.970952455745191e-09, -4.015168197923913e-09, -2.410962263166283e-10, -1.6505950384271273e-08, -1.0260959859564878e-09, -4.03745081811735e-09, -6.579305772902444e-05, -3.485276954193206e-12, -1.6261808923445642e-05, -1.653631989029236e-05, -2.513001504667045e-07, -1.579260100470492e-08, -3.485276520512337e-12, -4.0654522308614105e-06, -1.0335426168239792e-06, -2.5793286950737127e-10, -4.104034001528589e-09, -3.4852784720762475e-12, -6.504723569378257e-05, -4.0819259083946235e-09, -2.4955004729321217e-10, -3.9930623252359965e-09, -9.912088511088157e-13, -1.533403092002228e-11, -1.0564925787548418e-06, -4.042904947709758e-06, -1.6811911336844787e-05, -4.082275850691985e-09, -2.410962263166283e-10, -6.566729382484482e-08, -9.815105395105661e-10, -6.469360960181803e-05, -1.5884161541634967e-08, -3.485276520512337e-12, -4.0654522308614105e-06, -1.597120125040874e-08, -1.0038569975279188e-09, -2.598284538635198e-07, -5.583190607511054e-20, -3.88121401684316e-09, -1.5705211353633786e-08, -6.352965442601999e-08, -6.389038276211068e-08, -6.566871491031634e-08, -2.410962263166283e-10, -1.033564331009984e-06, -2.481519156827261e-10, -1.050744117492286e-06, -2.5790553026538987e-10, -3.485277821554944e-12, -6.352269110720954e-08, -6.496408389011776e-08, -6.353248949153567e-08, -4.203244316158816e-06, -9.965213333337775e-13, -1.533403092002228e-11, -1.6537747796974145e-05, -4.037885137364583e-09, -2.5792185054385186e-10, -1.626359335205052e-05, -3.485277821554944e-12, -6.352269110720954e-08, -4.088893547304906e-06, -1.6262534700217657e-05, -1.5703815137158017e-08, -9.856839736782641e-13, -1.533403092002228e-11, -6.688111898256466e-05, -1.0221564252788085e-06, -4.22605899075279e-06, -4.015427990111675e-09, -2.410962263166283e-10, -4.059642400022767e-09, -4.134528353461064e-06, -2.5097518507877226e-10, -3.948408711096363e-09, -5.583827795076661e-20, -3.88121401684316e-09, -6.578738248208538e-05, -1.5705900580087473e-08, -2.569987032075005e-07, -9.694493471879007e-13, -1.533403092002228e-11, -1.0149979745577298e-09, -1.0204377343114857e-09, -2.523352637950893e-10, -1.02797196177562e-06, -3.485278255235813e-12, -1.0163630577153526e-06, -1.039358039633953e-06, -6.432711234083399e-05, -3.993235520027838e-09, -9.802869236838485e-13, -1.533403092002228e-11, -1.0222455557595822e-06, -1.0050667924588197e-06, -4.126316621722026e-09, -2.5843030471150996e-07, -2.410962263166283e-10, -1.0149106000056918e-09, -1.0051111303255311e-06, -9.871897743707336e-10, -3.970429318655988e-09, -3.4852784720762475e-12, -2.5409076442883816e-07, -1.6418926662709055e-08, -1.014954342792862e-09, -2.4814650334548105e-10, -5.583699840575657e-20, -3.88121401684316e-09, -1.6263955330941826e-05, -2.583967955160915e-07, -1.623788747906474e-08, -9.96521550174212e-13, -1.533403092002228e-11, -2.56992990443905e-07, -3.993147590364288e-09, -1.0050442824649508e-06, -1.0393360980742727e-06, -2.410962263166283e-10, -6.566729382484482e-08, -4.037189693661958e-09, -2.569596233570337e-07, -4.020266260340577e-06, -2.410962263166283e-10, -2.626691752993793e-07, -1.0222903483736445e-06, -1.0094710622965408e-09, -1.6263948054984212e-05, -5.583447162747916e-20, -1.552485606737264e-08, -1.6062408292327746e-08, -1.5972243971873468e-08, -1.0164300192627707e-06, -6.53094360814066e-08, -2.410962263166283e-10, -6.760837277397513e-05, -1.6536681869183667e-05, -2.509644159154334e-10, -2.4954446842251343e-10, -3.485276520512337e-12, -2.4952812038847583e-10, -4.134437858738238e-06, -4.104816042627135e-09, -4.059905744924208e-09, -5.583949933463983e-20, -1.552485606737264e-08, -1.6418219672686973e-08, -4.1576108742447104e-06, -2.512498440410127e-07, -1.6419273052292738e-08, -2.410962263166283e-10, -1.5882410053791318e-08, -6.602106594755242e-08, -1.0317315890517875e-09, -6.541518087033182e-05, -5.583823271432686e-20, -1.552485606737264e-08, -4.082360671731067e-09, -2.6411763087708096e-07, -1.0335201068301103e-06, -9.858121263750519e-13, -1.533403092002228e-11, -1.0205032374699385e-09, -1.6082491129054688e-05, -1.6539179341634735e-05, -6.602663660260077e-08, -2.410962263166283e-10, -1.6149790837971523e-08, -4.126575969820578e-09, -2.5699853267724393e-07, -6.46061835141154e-08, -3.485276520512337e-12, -1.022067181111197e-06, -1.6418919557281697e-08, -2.565401224785546e-10, -6.506154750240967e-05, -5.583193192450468e-20, -1.552485606737264e-08, -4.1568978303985205e-06, -2.5839122486104316e-07, -9.815752655129018e-10, -1.007507987628442e-12, -1.533403092002228e-11, -4.0664335756446235e-06, -1.0165643971049576e-06, -1.045017370415735e-06, -4.156986960879294e-06, -2.410962263166283e-10, -1.632804469409166e-08, -2.551422406682491e-10, -2.4678098453634334e-10, -4.203156095172744e-06, -2.410962263166283e-10, -6.566868648860691e-08, -1.0506769285711925e-06, -1.0451294656377286e-06, -2.4958804467622997e-10, -3.485276954193206e-12, -2.509207286394144e-10, -2.5791097035821053e-10, -2.641344281073543e-07, -1.6538107956876047e-05, -9.966705195527115e-13, -1.533403092002228e-11, -1.5703468747574334e-08, -4.202709078526823e-06, -4.014993226775232e-09, -4.043618446303299e-06, -3.485277821554944e-12, -1.0036829145576576e-09, -4.015254795319834e-09, -2.641010325987736e-07, -1.6813326510600746e-05, -5.583317269542351e-20, -6.209942426949056e-08, -6.423849896464162e-08, -1.597119769769506e-08, -6.389314677335278e-08, -9.747621546735141e-13, -1.533403092002228e-11, -2.583967955160915e-07, -4.1568978303985205e-06, -1.0107262369274395e-06, -1.5971901135003463e-08, -3.485278255235813e-12, -6.423570653169008e-08, -6.530804341764451e-08, -6.724047125317156e-05, -2.598116850549559e-07, -5.583569947370092e-20, -6.209942426949056e-08, -4.104816486716345e-09, -1.0164528703171527e-06, -1.6239971145637355e-08, -9.96606226363883e-13, -1.533403092002228e-11, -3.970952899834401e-09, -4.0200879993790295e-06, -1.0279943580826512e-06, -9.965431257974444e-13, -1.533403092002228e-11, -6.282083830910778e-08, -2.6123217367057805e-07, -1.6445768778794445e-05, -2.509643881598578e-10, -3.4852776047145095e-12, -1.0277713045070414e-06, -4.180517862550914e-06, -1.6082842194009572e-05, -6.76069685141556e-05, -9.967124781767867e-13, -1.533403092002228e-11, -4.066344899911201e-06, -3.970865858349271e-09, -6.45978204261155e-08, -2.6126565444428707e-07, -3.485277821554944e-12, -1.644434087211266e-05, -1.6173402400454506e-05, -6.531083585059605e-08, -2.53744109057763e-10, -5.583570593604945e-20, -6.209942426949056e-08, -6.542089977301657e-05, -6.761411350453272e-05, -2.523405928656075e-10, -4.066346718900604e-06, -2.410962263166283e-10, -2.62680316609476e-07, -9.815102064436587e-10, -1.5882774206943395e-08, -1.6447911548311822e-05, -2.410962263166283e-10, -2.641063474584371e-07, -2.551420741347954e-10, -6.688828580081463e-05, -1.0392245712864678e-06, -3.4852771710336405e-12, -2.5231333689035296e-10, -2.641009189119359e-07, -2.453993952489242e-10, -1.650596281876915e-08, -3.4852784720762475e-12, -6.577736348845065e-05, -3.94814980708702e-09, -1.003878868921504e-09, -4.127099550998992e-09, -5.584203257526578e-20, -2.483976970779622e-07, -1.6150492498923086e-08, -6.318151690720697e-08, -2.537495491505837e-10, -3.4852776047145095e-12, -4.037013390245647e-09, -2.583856542059948e-07, -1.5705900580087473e-08, -2.5699853267724393e-07, -5.584203257526578e-20, -2.483976970779622e-07, -4.06016598120118e-09, -1.05638139302755e-06, -1.6418916004568018e-08, -9.857267996640773e-13, -1.533403092002228e-11, -2.481627958683674e-10, -1.0204813660763534e-09, -6.317734602134806e-08, -4.1045575827070024e-09, -2.410962263166283e-10, -6.5057203755714e-05, -1.0393135880804039e-06, -4.11135442845989e-06, -2.481627403572162e-10, -3.485278255235813e-12, -4.037013390245647e-09, -1.0093188507198647e-09, -1.056537030308391e-06, -2.6266383201800636e-07, -5.583318562012058e-20, -2.483976970779622e-07, -9.871892192592213e-10, -4.037796763611823e-09, -4.13407997257309e-06, -1.0074434775991792e-12, -1.533403092002228e-11, -1.6810479792184196e-05, -2.5128326797130285e-07, -4.1576104194973595e-06, -9.815319668149414e-10, -2.410962263166283e-10]]

        return_new = fu.filt_vols(deepcopy(self.vols), self.fscs, MASK)
        return_old = oldfu.filt_vols(deepcopy(self.vols), self.fscs, MASK)
        self.assertEqual(len(return_old), len(return_new))
        for img1, img2 in zip(return_old, return_new):
            self.assertTrue(allclose(img1.get_3dview(), img2.get_3dview(), equal_nan=True))
        self.assertEqual(len(return_old), len(res))
        for img1, img2 in zip(return_old, res):
            print(img1.get_3dview().flatten().tolist())
            print (img2)
            self.assertTrue(allclose(img1.get_3dview().flatten(), img2, equal_nan=True,atol=TOLERANCE)) #here fails


    def test_with_NoneTypeMask_crashes_because_signal11SIGSEV(self):
        self.assertTrue(True)
        """
        return_new = fu.filt_vols(self.vols, self.fscs, None)
        return_old = oldfu.filt_vols(self.vols, self.fscs, None)
        self.test_all_the_conditions(return_new,return_old,False)
        """

    def test_with_EmptyMASK_crashes_because_signal11SIGSEV(self):
        self.assertTrue(True)
        """
        return_new = fu.filt_vols(self.vols, self.fscs, EMData())
        return_old = oldfu.filt_vols(self.vols, self.fscs, EMData())
        self.test_all_the_conditions(return_new,return_old,False)
        """



class Test_filterlocal(unittest.TestCase):
    def test_wrong_number_params(self):
        with self.assertRaises(TypeError) as cm_new:
            fu.filterlocal()
        with self.assertRaises(TypeError) as cm_old:
            oldfu.filterlocal()
        self.assertEqual(str(cm_new.exception), "filterlocal() takes exactly 7 arguments (0 given)")
        self.assertEqual(str(cm_new.exception), str(cm_old.exception))

    @unittest.skip("not able to test it")
    def test_filterlocal_true_should_return_equal_object(self):
        #mpi_barrier(MPI_COMM_WORLD)
        vols = []
        vols.append(model_gauss_noise(0.25 , 10,10,10))
        vols.append(model_gauss_noise(0.25 , 10,10,10))
        vols.append(model_gauss_noise(0.25 , 10,10,10))
        ui =  model_gauss_noise(0.25 , 10,10,10)     # or use ut.model_blank(1,1,1)
        vi =  model_gauss_noise(0.25 , 10,10,10)
        m  = "sphire/tests/3d_volume.txt"
        falloff = 4
        myid =   1
        main_node = 0
        number_of_proc = 6

        return_new = fu.filterlocal(ui, vi, m, falloff, myid, main_node, number_of_proc)
        return_old = oldfu.filterlocal(ui, vi, m, falloff, myid, main_node, number_of_proc)

        self.assertTrue(return_new, return_old)




"""
import numpy

import EMAN2_cppwrap as e2cpp

from ..libpy_py3 import sphire_filter as fu
from .sparx_lib import sparx_filter as oldfu

from ..libpy import sparx_utilities as ut

import unittest


from test_module import get_data, get_data_3d
from EMAN2_cppwrap import EMData


@unittest.skip("original adnan")
class MyTestCase(unittest.TestCase):

    def test_filt_tophatl_true_should_return_equal_object(self):
        image, = get_data(1)
        freq = 0.25
        return_new = fu.filt_tophatl(image,freq)
        return_old = oldfu.filt_tophatl(image,freq)
        self.assertTrue(numpy.array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_filt_tophatb_true_should_return_equal_object(self):
        image, = get_data(1)
        freql = 0.25
        freqh = 0.35
        return_new = fu.filt_tophatb(image,freql, freqh)
        return_old = oldfu.filt_tophatb(image,freql, freqh)
        self.assertTrue(numpy.array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_filt_gaussl_true_should_return_equal_object(self):
        image, = get_data(1)
        sigma = 0.23
        return_new = fu.filt_gaussl(image,sigma)
        return_old = oldfu.filt_gaussl(image,sigma)
        self.assertTrue(numpy.array_equal(return_new.get_3dview(), return_old.get_3dview()))


    def test_filt_gaussinv_true_should_return_equal_object(self):
        image, = get_data(1)
        sigma = 0.23
        return_new = fu.filt_gaussinv(image,sigma)
        return_old = oldfu.filt_gaussinv(image,sigma)
        self.assertTrue(numpy.array_equal(return_new.get_3dview(), return_old.get_3dview()))

    def test_filt_gaussh_true_should_return_equal_object(self):
        image, = get_data(1)
        sigma = 0.23
        return_new = fu.filt_gaussh(image,sigma)
        return_old = oldfu.filt_gaussh(image,sigma)
        self.assertTrue(numpy.array_equal(return_new.get_3dview(), return_old.get_3dview()))


    def test_filt_btwl_true_should_return_equal_object(self):
        image, = get_data(1)
        freql = 0.25
        freqh = 0.35
        return_new = fu.filt_btwl(image,freql, freqh)
        return_old = oldfu.filt_btwl(image,freql, freqh)
        self.assertTrue(numpy.array_equal(return_new.get_3dview(), return_old.get_3dview()))


    def test_filt_tanl_true_should_return_equal_object(self):
        image, = get_data(1)
        freql = 0.25
        freqh = 0.35
        return_new = fu.filt_tanl(image,freql, freqh)
        return_old = oldfu.filt_tanl(image,freql, freqh)
        self.assertTrue(numpy.array_equal(return_new.get_3dview(), return_old.get_3dview()))


    def test_filt_table_true_should_return_equal_object(self):
        image, = get_data(1)
        table =[entry for entry in numpy.linspace(0, 0.5).tolist()]

        return_new = fu.filt_table(image,table)
        return_old = oldfu.filt_table(image,table)

        self.assertTrue(numpy.array_equal(return_new.get_3dview(), return_old.get_3dview()))


    def test_filt_ctf_true_should_return_equal_object(self):
        image, = get_data(1)
        defocus = 1
        cs =  2
        voltage = 300
        pixel_size = 1.5
        bfactor =  0
        amp_contrast = 0.1
        ctf = e2cpp.EMAN2Ctf()
        ctf.from_dict({"defocus": defocus, "cs": cs, "voltage": voltage, "apix": pixel_size, "bfactor": bfactor,
                       "ampcont": amp_contrast})

        return_new = fu.filt_ctf(image,ctf)
        return_old = oldfu.filt_ctf(image,ctf)

        self.assertTrue(numpy.array_equal(return_new.get_3dview(), return_old.get_3dview()))


    def test_fit_tanh_true_should_return_equal_object(self):
        dres = []
        dres.append((0.0,0.05,0,10,0.15,0.20))
        dres.append((0,0.2,0.4,0.6,0.8,1.0))
        dres.append((8,9,5,77,98,200))

        return_new = fu.fit_tanh(dres)
        return_old = oldfu.fit_tanh(dres)

        self.assertTrue(return_new , return_old)


    def test_fit_tanh1_true_should_return_equal_object(self):
        dres = []
        dres.append((0.0,0.05,0,10,0.15,0.20))
        dres.append((0,0.2,0.4,0.6,0.8,1.0))
        dres.append((8,9,5,77,98,200))

        return_new = fu.fit_tanh1(dres)
        return_old = oldfu.fit_tanh1(dres)

        self.assertTrue(return_new , return_old)

    def test_filt_vols_true_should_return_equal_object(self):
        vols = []
        vols.append( ut.model_gauss_noise(0.25 , 10,10,10) )
        vols.append(ut.model_gauss_noise(0.25 , 10,10,10))
        vols.append(ut.model_gauss_noise(0.25 , 10,10,10))

        dres = []
        dres.append([0.05, 0.05, 0.05, 0.10, 0.15, 0.20])
        dres.append([0.05, 0.02, 0.04, 0.06, 0.08, 0.09])
        dres.append([0.08, 0.09, 0.05, 0.07, 0.05, 0.01])
        fscs = []
        fscs.append(dres)
        fscs.append(dres)
        fscs.append(dres)

        mask3D, = get_data_3d(1)

        return_new = fu.filt_vols(vols, fscs, mask3D)
        return_old = oldfu.filt_vols(vols, fscs, mask3D)

        self.assertTrue(return_new, return_old)

    def test_filterlocal_true_should_return_equal_object(self):
        vols = []
        vols.append(ut.model_gauss_noise(0.25 , 10,10,10))
        vols.append(ut.model_gauss_noise(0.25 , 10,10,10))
        vols.append(ut.model_gauss_noise(0.25 , 10,10,10))
        ui =  ut.model_gauss_noise(0.25 , 10,10,10)     # or use ut.model_blank(1,1,1)
        vi =  ut.model_gauss_noise(0.25 , 10,10,10)
        m  = "sphire/tests/3d_volume.txt"
        falloff = 4
        myid =   1
        main_node = 0
        number_of_proc = 6

        return_new = fu.filterlocal(ui, vi, m, falloff, myid, main_node, number_of_proc)
        return_old = oldfu.filterlocal(ui, vi, m, falloff, myid, main_node, number_of_proc)

        self.assertTrue(return_new, return_old)


"""

if __name__ == '__main__':
    unittest.main()







